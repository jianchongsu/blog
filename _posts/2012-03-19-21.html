--- 
layout: post
name: "21"
title: "\xE5\xA6\x82\xE4\xBD\x95\xE7\x94\xA821\xE7\x82\xB9\xE6\x9D\xA5\xE5\x87\xBB\xE8\xB4\xA5\xE8\xB5\x8C\xE5\x9C\xBA\xEF\xBC\x9F"
date: 2012-03-19 12:47:00 +08:00
categories: 
- other
- "\xE6\xA8\xA1\xE6\x8B\x9F"
permalink: /2012/03/21.html
---
<div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/p67sbRAa.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><br /><img border="0" height="149" src="http://thumbsnap.com/i/p67sbRAa.jpg" width="200" /></a></div><a href="http://en.wikipedia.org/wiki/Blackjack"><b>21点</b></a>也许是世界上最受欢迎的扑克牌游戏之一。玩家要尽量使手中牌的点数和达到21点，或是接近21点，但不能超过，再和庄家比较点数和的大小以定输赢。熟悉概率的诸位都知道，在赌场的各类游戏中，庄家有着绝对的优势。但二十一点却是唯一有机会击败庄家的游戏，也是最需要冷静和计算的游戏。<b>其秘诀就在于记牌和算牌，</b>即玩家要记住所有打出去的牌，然后再决定如何打剩下的牌。<br /><br />为什么记牌能够有用，其原因在于条件概率。假设赌场使用一副牌来玩21点，庄家发出牌来，你拿到两个10（包括了J、Q、K），庄家亮牌也是10，翻出底牌来还是10，那么下一轮里10出现的概率已不再是4/13，而是12/48，即1/4，略低于4/13。所以在21点的各轮之间（在重新洗牌之前），出现10点的概率不再是独立的。前一轮出现过的牌，会影响到下一轮。因此，如果我们能记住前面出过什么牌，就能大致预测以后的赌局，从而占到一定的优势。<br /><a name='more'></a><br />那么前面出现什么样的牌会对玩家有优势呢？答案是小牌。如果在前面10以下的小牌出现很多，意味着在剩下的牌局中，10出现的概率增大。而10点这种大牌对庄家是不利的。因为赌场规定了，<b>庄家在16点及更低时必须要牌</b>，10越多，就越容易使庄家爆掉。而对玩家来说，只需要在12点及以下时要牌。因此，玩家的优势就在于可以选择是否加入牌局。若观察到某个牌桌上已经出现了大量的小牌，就可以加入赌局，等待庄家爆牌送钱。<br /><br />UCLA的数学教授爱德华·索普（Edward Thorp）在六十年代初发明了正式的21点<a href="http://en.wikipedia.org/wiki/Card_counting"><b>算牌法</b></a>。那时计算机也发明出来了，他找到IBM公司里的朋友，写了个程序来验证自己的算牌方法。那时的计算机足足运转了七天七夜，终于证明了这个方法是可行的。索普又自己到赌场里亲自实践，果然大赢特赢。1962年他出版了《打败庄家（Beat the Dealer）》一书，向公众介绍了自己的算牌法。《打败庄家》在刚出版时轰动一时，很快成为畅销书，激励了无数赌徒涌向赌场。赌场对此大为恐慌，有些甚至关闭了二十一点赌桌。但是，很快他们发现，只有极少数人真正掌握了算牌法，其他大多数人只不过是一知半解、道听途说。索普本人在60年代后期就淡出了赌博界，带着他在赌场赢来的大笔资金，进入股票市场，运用他的数学知识，现在已成为超级巨富。<br /><br />好了，前面铺垫了这么多，那么下面我们用R语言来验证一下21点的赚钱方法。首先编写了抽牌函数card.select和玩21点的函数game（代码写得有点糙，如果你有更好的想法请告诉我）。先考查一种情景，如果大牌比例较低而且我们采取和庄家一样的策略，即在16点以下继续要牌，经过一万次模拟后发现会大输特输。原因就在于：当玩家先爆牌时，庄家自然获胜。经计算这一规定的优势相当大。下图即此情景下的积累收益图，真是银河落九天啊。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/LKoLVKoP.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="266" src="http://thumbsnap.com/i/LKoLVKoP.jpg" width="400" /></a></div>再看第二次情景，当我们将card.select中的m参数默认值改为6，此时大牌与小牌的比例约为2.5：1。然后将玩家player的判断阀值设为12，再进行模拟一万次。从下图会发现玩家的累积收益在起初会有负值，之后较为稳定的增长。一万次游戏后大约赚取了150元（假设每次下注1元）。从二项检验的结果也可以看到，p值为0.06较小，而胜率的估计区间为0.499到0.525。由此可见，等待大牌的确可以增加玩家的胜算。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/fy0i31T8.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="266" src="http://thumbsnap.com/i/fy0i31T8.jpg" width="400" /></a></div><br />为了仔细考查大小牌之比和胜率之间的关系，我们再重复模拟多次，得到下图。横轴为大牌与小牌之间的比率，纵轴为玩家的胜负比率。可以观察到当大小牌之比达到1.5：1时，玩家的胜率即可超过50%。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/WrZXrUmM.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="266" src="http://thumbsnap.com/i/WrZXrUmM.jpg" width="400" /></a></div>你可能会为此而雀跃，恨不得马上飞到澳门去试一把。但是你要注意的是：如果一把牌玩一分钟，一万次游戏需要你不吃不喝不睡连续七天时间，而七天时间你才赚了150元。而且这种大牌比率极高的情况是少见的，你也许要侦查多个牌桌才会得到机会。而且我们的模拟也没有考虑到其它的情况：如多人桌、分牌、保险等因素。也没有考虑到玩家的资金使用策略。最重要的是：<b>赌场会洗牌！</b>重新洗牌之后，条件概率就不复存在，而在此基础上的算牌法所获得的胜率也不再有效。<br /><br /><b>R代码如下：</b><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># 从13张扑克牌中抽一张牌的函数，用n和m来控制大小牌的抽取概率</span><br />card.select &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>n=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>m=<span style="color: #cc66cc;">6</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br /> x &lt;- <a href="http://inside-r.org/r-doc/base/sample"><span style="color: #003399;">sample</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">13</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/prob">prob</a>=<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>n<span style="color: #339933;">,</span>m<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>/sum<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>n<span style="color: #339933;">,</span>m<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /> <span style="color: #666666; font-style: italic;"># J，Q，K都被转为10点</span><br /> x &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>x&gt;<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span>x<span style="color: #009900;">)</span><br /> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 完成一次二十一点游戏的函数，point为是否继续要牌的判断阀值</span><br />game &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>point<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <span style="color: #666666; font-style: italic;"># 最开始得到的两张牌</span><br />  select &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>card.select<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>card.select<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  <span style="color: #666666; font-style: italic;"># 将原始序列select中的1点转成11点，求牌的点数和</span><br />  Ato11 &lt;- select<br />  Ato11<span style="color: #009900;">[</span>Ato11==<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">11</span><br />  card.sum &lt;- <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>Ato11<span style="color: #009900;">)</span><br />  <span style="color: #666666; font-style: italic;"># 进入条件循环，以判断是否应该继续要牌</span><br />  <span style="color: #666666; font-style: italic;">#若牌点数和大于阀值，则不再要牌</span><br />  <span style="color: black;">while</span> <span style="color: #009900;">(</span>card.sum &lt;= point<span style="color: #009900;">)</span> <span style="color: #009900;">{</span> <br />    select &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>select<span style="color: #339933;">,</span> card.select<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    Ato11 &lt;- select<br />    Ato11<span style="color: #009900;">[</span>Ato11==<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">11</span><br />    card.sum &lt;- <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>Ato11<span style="color: #009900;">)</span><br /> <span style="color: #009900;">}</span>  <br />  <span style="color: #666666; font-style: italic;"># 若点数和大于21且其中有A，则A看作1点，用原始的序列求和</span><br />  <span style="color: black;">if</span> <span style="color: #009900;">(</span>card.sum &gt; <span style="color: #cc66cc;">21</span> &amp;&amp; <span style="color: #cc66cc;">1</span> %in% select<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  card.sum &lt;- <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>select<span style="color: #009900;">)</span><br />  <span style="color: #009900;">}</span><br />  <span style="color: #666666; font-style: italic;"># A转为1点后，再次条件循环，以判断是否应该继续拿牌</span><br />  <span style="color: black;">while</span> <span style="color: #009900;">(</span>card.sum &lt;= point<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    select &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>select<span style="color: #339933;">,</span> card.select<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    card.sum &lt;- <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>select<span style="color: #009900;">)</span><br /> <span style="color: #009900;">}</span><br />  <span style="color: #666666; font-style: italic;"># 若点数大于21点，则爆牌为0  </span><br />  y &lt;-<a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>card.sum&lt;=<span style="color: #cc66cc;">21</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>card.sum<span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><br /> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span>y<span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># cat('select=',select,'\n','return=',y,'\n')</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 与庄家博弈，赌场规定庄家以16为阀值，玩家应以12为阀值，等待庄家爆掉</span><br />player &lt;- <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100000</span><span style="color: #339933;">,</span>game<span style="color: #009900;">(</span><span style="color: #cc66cc;">12</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />dealer &lt;- <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100000</span><span style="color: #339933;">,</span>game<span style="color: #009900;">(</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;">#结果有赢输平三种情况</span><br />result &lt;-<a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>player &gt; dealer<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>player &lt; dealer<span style="color: #339933;">,</span>-<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 若二者均爆牌且平局，设玩家输</span><br />result<span style="color: #009900;">[</span>player==<span style="color: #cc66cc;">0</span> &amp; result==<span style="color: #cc66cc;">0</span><span style="color: #009900;">]</span> &lt;- -<span style="color: #cc66cc;">1</span><br /><span style="color: #666666; font-style: italic;"># 将平的情况略去以方便进行二项检验</span><br />result.no.tie &lt;- result<span style="color: #009900;">[</span>result!=<span style="color: #cc66cc;">0</span><span style="color: #009900;">]</span><br /><span style="color: #666666; font-style: italic;"># 二项检验</span><br /><a href="http://inside-r.org/r-doc/stats/binom.test"><span style="color: #003399;">binom.test</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399;">length</span></a><span style="color: #009900;">(</span>result.no.tie<span style="color: #009900;">[</span>result.no.tie==<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399;">length</span></a><span style="color: #009900;">(</span>result.no.tie<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 观察玩家连赢或连输的游程</span><br /><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399;">table</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rle"><span style="color: #003399;">rle</span></a><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 计算累积利润</span><br />profit &lt;- <a href="http://inside-r.org/r-doc/base/cumsum"><span style="color: #003399;">cumsum</span></a><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 绘图以观察利润变化</span><br /><a href="http://inside-r.org/r-doc/base/q"><span style="color: #003399;">q</span></a> &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>profit<span style="color: #339933;">,</span>index=<span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399;">length</span></a><span style="color: #009900;">(</span>profit<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>index<span style="color: #339933;">,</span>profit<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/q"><span style="color: #003399;">q</span></a> + geom_line<span style="color: #009900;">(</span>colour=<span style="color: blue;">'lightskyblue4'</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 考查在不同的大小牌比值的情况下，玩家获胜的概率</span><br />odd.10 &lt;-  win &lt;- <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><br /><span style="color: black;">for</span> <span style="color: #009900;">(</span>i <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    card.select &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>n=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>m=i<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        x &lt;- <a href="http://inside-r.org/r-doc/base/sample"><span style="color: #003399;">sample</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">13</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/prob">prob</a>=<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>n<span style="color: #339933;">,</span>m<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>/sum<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>n<span style="color: #339933;">,</span>m<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />        x &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>x&gt;<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span>x<span style="color: #009900;">)</span><br />        <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br />    odd.10<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">4</span>*i/<span style="color: #cc66cc;">9</span> <br />    player &lt;- <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100000</span><span style="color: #339933;">,</span>game<span style="color: #009900;">(</span><span style="color: #cc66cc;">12</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    dealer &lt;- <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100000</span><span style="color: #339933;">,</span>game<span style="color: #009900;">(</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    result &lt;-<a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>player &gt; dealer<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>player &lt; dealer<span style="color: #339933;">,</span>-<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    result<span style="color: #009900;">[</span>player==<span style="color: #cc66cc;">0</span> &amp; result==<span style="color: #cc66cc;">0</span><span style="color: #009900;">]</span> &lt;- -<span style="color: #cc66cc;">1</span><br />    result.no.tie &lt;- result<span style="color: #009900;">[</span>result!=<span style="color: #cc66cc;">0</span><span style="color: #009900;">]</span><br />    win<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399;">length</span></a><span style="color: #009900;">(</span>result.no.tie<span style="color: #009900;">[</span>result.no.tie==<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>/length<span style="color: #009900;">(</span>result.no.tie<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />d &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>odd.10<span style="color: #339933;">,</span>win<span style="color: #009900;">)</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>odd.10<span style="color: #339933;">,</span>win<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />d + geom_line<span style="color: #009900;">(</span>colour=<span style="color: blue;">'lightskyblue4'</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span> + <br />    geom_point<span style="color: #009900;">(</span>colour=<span style="color: blue;">'red4'</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">3.5</span><span style="color: #009900;">)</span> +<br />    geom_hline<span style="color: #009900;">(</span>y=<span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span>linetype=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span></span></pre></div></div>
