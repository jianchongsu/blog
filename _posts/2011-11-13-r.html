--- 
layout: post
name: r
title: "R\xE8\xAF\xAD\xE8\xA8\x80\xE5\x9F\xBA\xE7\xA1\x80\xE5\x85\xA5\xE9\x97\xA8\xE4\xB9\x8B\xE5\x9B\x9B\xEF\xBC\x9A\xE5\xB8\xB8\xE7\x94\xA8\xE7\x9A\x84\xE7\xBB\x9F\xE8\xAE\xA1\xE6\x8E\xA8\xE6\x96\xAD"
date: 2011-11-13 16:11:00 +08:00
categories: 
- "\xE5\x85\xA5\xE9\x97\xA8\xE6\x95\x99\xE7\xA8\x8B"
permalink: /2011/11/r.html
---
通常一个研究项目能够获得的数据是有限的，以有限的样本特征来推断总体特征就称为统计推断。推断又可细分为区间估计和假设检验，二者虽有区别，但却是一枚硬币的两面，之间有着紧密的关联。<br /><br /><b><span class="Apple-style-span" style="font-size: large;">1 对总体均值进行区间估计</span></b><br />假设我们从总体中抽得一个样本，希望根据样本均值判断总体均值的置信区间，如下例所示：<br /><blockquote class="tr_bq">x=rnorm(50,mean=10,sd=5) &nbsp;#随机生成50个均值为10，标准差为5的随机数为作为研究对象<br />mean(x)-qt(0.975,49)*sd(x)/sqrt(50) &nbsp;#根据统计学区间估计公式，得到95%置信度下的区间下界<br />mean(x)+qt(0.975,49)*sd(x)/sqrt(50) &nbsp;#95%置信度下的区间上界<br /><a name='more'></a></blockquote>也可以直接利用R语言内置函数<b>t.test</b><br /><blockquote class="tr_bq">t.test(x,conf.level=0.95)</blockquote>从如下结果可得95%置信区间为（9.56，12.36）<br /><blockquote class="tr_bq">One Sample t-test<br />data: &nbsp;x<br />t = 15.7301, df = 49, p-value &lt; 2.2e-16<br />alternative hypothesis: true mean is not equal to 0<br />95 percent confidence interval:<br />&nbsp; 9.563346 12.364729<br />sample estimates:<br />mean of x<br />&nbsp;10.96404&nbsp;</blockquote><b><span class="Apple-style-span" style="font-size: large;">2 对总体均值进行假设检验</span></b><br />还是以上面的X数据作为对象，来检验总体均值是否为10<br /><blockquote class="tr_bq">t.test(x,mu=10,alternative='two.sided') &nbsp;#这里的原假设是总体均值（mu）为10，使用双侧检验，得到P值为0.17，可见P值不够小，不能够拒绝原假设。</blockquote>T检验是极为常用的检验方法，除了单样本推断之外，t.test命令还可以实现两样本推断和配对样本推断。如果要对总体比率或总体方差进行推断，可以使用<b>prop.test</b>和<b>var.test</b>。<br /><br /><b><span class="Apple-style-span" style="font-size: large;">3 正态分布检验</span></b><br />T检验的前提条件是总体服从正态分布，因此我们有必要先检验正态性。而且在评价回归模型时，对残差也需要检验正态性。检验正态性的函数是<b>shapiro.test</b><br /><blockquote class="tr_bq">shapiro.test(x)</blockquote>结果所下：<br /><blockquote class="tr_bq">Shapiro-Wilk normality test<br />data: &nbsp;x<br />W = 0.9863, p-value = 0.8265</blockquote>该检验的原假设是服从正态分布，由P值为0.82可判断不能拒绝总体服从正态的假设<br /><br /><b><span class="Apple-style-span" style="font-size: large;">4 非参数检验</span></b><br />如果总体不服从正态分布，那么T检验就不再适用，此时我们可以利用非参数方法推断中位数。<b>wilcoxon.test</b>函数可实现符号秩检验。<br /><blockquote class="tr_bq">wilcox.test(x,conf.int=T) &nbsp; #指定conf.int让函数返回中位数的置信区间<br />wilcox.test(x,mu=1） &nbsp;#指定mu让函数返回中位数为10的检验结果</blockquote><b><span class="Apple-style-span" style="font-size: large;">5 独立性检验（联列表检验）</span></b><br />卡方分布有一个重要应用就是根据样本数据来检验两个分类变量的独立性，我们以CO2数据为例来说明<b>chisq.test</b>函数的使用，help(CO2)可以了解更多信息。<br /><blockquote class="tr_bq">data(CO2) &nbsp; #读入内置的数据包，其中Type和Treatmen是其中两个分类变量。<br />chisq.test(table(CO2$Type,CO2$Treatment)) &nbsp; #使用卡方检验函数来检验这两个因子之间是否独立</blockquote>结果显示P值为0.82，因此可以认为两因子之间独立。在样本较小的情况下，还可以使用fisher精确检验，对应的函数是<b>fisher.test</b>。
