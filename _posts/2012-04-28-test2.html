--- 
layout: post
name: test2
title: "\xE7\x94\xA8RGL\xE5\x8C\x85\xE7\xBB\x98\xE5\x88\xB6\xE4\xB8\x89\xE7\xBB\xB4\xE4\xBA\xA4\xE4\xBA\x92\xE5\xBC\x8F\xE5\x9B\xBE\xE5\xBD\xA2"
date: 2012-04-28 11:24:00 +08:00
categories: 
- "\xE7\xBB\x98\xE5\x9B\xBE"
- "\xE5\x8F\xAF\xE8\xA7\x86\xE5\x8C\x96"
permalink: /2012/04/test2.html
---
R语言中的<b>rgl包</b>是绘制三维图形的利器。在最新版本中，该包增加了一个writeWebGL函数，可以将三维图形转化为一个包含WebGL元素的网页文件。WebGL是一种3D绘图标准，这种绘图技术标准允许把JavaScript和OpenGL ES 2.0结合在一起，通过增加OpenGL ES 2.0的一个JavaScript绑定，WebGL可以为HTML5 Canvas提供硬件3D加速渲染，这样Web开发人员就可以借助系统显卡来在浏览器里更流畅地展示3D场景和模型了。<br /><br />下面的第一张图是静态图，是用一个二元函数绘制的心形图。第二张图是用来表现二元回归时散点与回归平面之间的关系，如果你的浏览器支持WebGL（如果可以打开<a href="http://www.google.com.hk/search?sourceid=chrome&amp;ie=UTF-8&amp;q=(-sqrt(1-x%5E2-(y-abs(x))%5E2))*cos(30*((1-x%5E2-(y-abs(x))%5E2)))">这个图形</a>，则表明支持），即可拖动鼠标以旋转图形。这种交互式图形相信在教学中会起到很好的辅助作用。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-6NlZQcCJcLI/T5tiit2SS9I/AAAAAAAAA0s/CeFe_WejQNU/s1600/%E6%8D%95%E8%8E%B7.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="381" src="http://2.bp.blogspot.com/-6NlZQcCJcLI/T5tiit2SS9I/AAAAAAAAA0s/CeFe_WejQNU/s400/%E6%8D%95%E8%8E%B7.JPG" width="400" /></a></div><br /><a name='more'></a>相关的R代码可以在<a href="http://dl.dropbox.com/u/6547489/rgl.R">这里</a>查看。  <html><head>  <TITLE>RGL model</TITLE>     </head>  <body onload="webGLStart();">             <div align="center">  <script src="http://dl.dropbox.com/u/6547489/CanvasMatrix.js" type="text/javascript"></script>  <canvas id="textureCanvas" style="display: none;" width="256" height="256">         <img src="http://dl.dropbox.com/u/6547489/snapshot.png" alt="snapshot" width=600/><br>  Your browser does not support the HTML5 canvas element.</canvas>    <!-- ****** spheres object 239 ****** -->  <script id="vshader239" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec3 aNorm;   uniform mat4 normMatrix;   varying vec3 vNormal;   const vec3 diffuse = vec3(1., 1., 1.); // light only   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = vec4(aCol.rgb * diffuse, aCol.a);     vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);   }   </script>    <script id="fshader239" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   const vec3 ambient_plus_emission = vec3(0., 0., 0.);   const vec3 specular = vec3(1., 1., 1.);// light*material   const float shininess = 50.;   const vec3 lightDir = vec3(0., 0., 1.);   const vec3 halfVec = vec3(0., 0., 1.);   const vec3 eye = vec3(0., 0., 1.);   varying vec3 vNormal;   void main(void) {     vec4 diffuse;     vec3 n = normalize(vNormal);     vec3 col = ambient_plus_emission;     n = -faceforward(n, n, eye);     float nDotL = dot(n, lightDir);     col = col + max(nDotL, 0.) * vDiffuse.rgb;     col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular;     diffuse = vec4(col, vDiffuse.a);     gl_FragColor = diffuse;   }   </script>      <!-- ****** text object 241 ****** -->  <script id="vshader241" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader241" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** text object 242 ****** -->  <script id="vshader242" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader242" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** text object 243 ****** -->  <script id="vshader243" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader243" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** planes object 244 ****** -->  <script id="vshader244" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec3 aNorm;   uniform mat4 normMatrix;   varying vec3 vNormal;   const vec3 diffuse = vec3(1., 1., 1.); // light only   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = vec4(aCol.rgb * diffuse, aCol.a);     vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);   }   </script>    <script id="fshader244" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   const vec3 ambient_plus_emission = vec3(0., 0., 0.);   const vec3 specular = vec3(1., 1., 1.);// light*material   const float shininess = 50.;   const vec3 lightDir = vec3(0., 0., 1.);   const vec3 halfVec = vec3(0., 0., 1.);   const vec3 eye = vec3(0., 0., 1.);   varying vec3 vNormal;   void main(void) {     vec4 diffuse;     vec3 n = normalize(vNormal);     vec3 col = ambient_plus_emission;     n = -faceforward(n, n, eye);     float nDotL = dot(n, lightDir);     col = col + max(nDotL, 0.) * vDiffuse.rgb;     col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular;     diffuse = vec4(col, vDiffuse.a);     gl_FragColor = diffuse;   }   </script>      <!-- ****** lines object 245 ****** -->  <script id="vshader245" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = aCol;   }   </script>    <script id="fshader245" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     gl_FragColor = diffuse;   }   </script>      <!-- ****** text object 246 ****** -->  <script id="vshader246" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader246" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** lines object 247 ****** -->  <script id="vshader247" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = aCol;   }   </script>    <script id="fshader247" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     gl_FragColor = diffuse;   }   </script>      <!-- ****** text object 248 ****** -->  <script id="vshader248" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader248" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** lines object 249 ****** -->  <script id="vshader249" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = aCol;   }   </script>    <script id="fshader249" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     gl_FragColor = diffuse;   }   </script>      <!-- ****** text object 250 ****** -->  <script id="vshader250" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   attribute vec2 aTexcoord;   varying vec2 vTexcoord;   attribute vec2 aOfs;   void main(void) {     vDiffuse = aCol;     vTexcoord = aTexcoord;     vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);     pos = pos/pos.w;     gl_Position = pos + vec4(aOfs, 0.,0.);   }   </script>    <script id="fshader250" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   varying vec2 vTexcoord;   uniform sampler2D uSampler;   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     vec4 textureColor = diffuse*texture2D(uSampler, vTexcoord);     if (textureColor.a < 0.1)       discard;     else       gl_FragColor = textureColor;   }   </script>      <!-- ****** lines object 251 ****** -->  <script id="vshader251" type="x-shader/x-vertex">  attribute vec3 aPos;   attribute vec4 aCol;   uniform mat4 mvMatrix;   uniform mat4 prMatrix;   varying vec4 vDiffuse;   void main(void) {     gl_Position = prMatrix * mvMatrix * vec4(aPos, 1.);     vDiffuse = aCol;   }   </script>    <script id="fshader251" type="x-shader/x-fragment">    #ifdef GL_ES   precision highp float;   #endif   varying vec4 vDiffuse; // carries alpha   void main(void) {     vec4 diffuse;     diffuse = vDiffuse;     gl_FragColor = diffuse;   }   </script>        <script type="text/javascript">      function getShader ( gl, id ){      var shaderScript = document.getElementById ( id );      var str = "";      var k = shaderScript.firstChild;      while ( k ){        if ( k.nodeType == 3 ) str += k.textContent;        k = k.nextSibling;      }      var shader;      if ( shaderScript.type == "x-shader/x-fragment" )               shader = gl.createShader ( gl.FRAGMENT_SHADER );      else if ( shaderScript.type == "x-shader/x-vertex" )               shader = gl.createShader(gl.VERTEX_SHADER);      else return null;      gl.shaderSource(shader, str);      gl.compileShader(shader);      if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) == 0)        alert(gl.getShaderInfoLog(shader));      return shader;   }     var min = Math.min;   var max = Math.max;   var sqrt = Math.sqrt;   var sin = Math.sin;   var acos = Math.acos;   var tan = Math.tan;   var SQRT2 = Math.SQRT2;   var PI = Math.PI;   var log = Math.log;   var exp = Math.exp;     function webGLStart() {      var debug = function(msg) {        document.getElementById("debug").innerHTML = msg;      }      debug("");        var canvas = document.getElementById("canvas");      if (!window.WebGLRenderingContext){        debug("<img src=\"snapshot.png\" alt=\"snapshot\" width=600/><br> Your browser does not support WebGL. See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");        return;      }      var gl;      try {        // Try to grab the standard context. If it fails, fallback to experimental.        gl = canvas.getContext("webgl")           || canvas.getContext("experimental-webgl");      }      catch(e) {}      if ( !gl ) {        debug("<img src=\"snapshot.png\" alt=\"snapshot\" width=600/><br> Your browser appears to support WebGL, but did not create a WebGL context.  See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");        return;      }      var width = 600;  var height = 600;      canvas.width = width;   canvas.height = height;      gl.viewport(0, 0, width, height);      var prMatrix = new CanvasMatrix4();      var mvMatrix = new CanvasMatrix4();      var normMatrix = new CanvasMatrix4();      var saveMat = new CanvasMatrix4();      saveMat.makeIdentity();      var distance;        var zoom = 1;      var fov = 30;      var userMatrix = new CanvasMatrix4();      userMatrix.load([       1, 0, 0, 0,       0, 0.3420201, -0.9396926, 0,       0, 0.9396926, 0.3420201, 0,       0, 0, 0, 1    ]);      function getPowerOfTwo(value) {        var pow = 1;        while(pow<value) {          pow *= 2;        }        return pow;      }        function handleLoadedTexture(texture, textureCanvas) {        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);          gl.bindTexture(gl.TEXTURE_2D, texture);        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);        gl.generateMipmap(gl.TEXTURE_2D);          gl.bindTexture(gl.TEXTURE_2D, null);      }            function loadImageToTexture(filename, texture) {           var canvas = document.getElementById("textureCanvas");        var ctx = canvas.getContext("2d");        var image = new Image();                image.onload = function() {          var w = image.width;          var h = image.height;          var canvasX = getPowerOfTwo(w);          var canvasY = getPowerOfTwo(h);          canvas.width = canvasX;          canvas.height = canvasY;          ctx.imageSmoothingEnabled = true;          ctx.drawImage(image, 0, 0, canvasX, canvasY);          handleLoadedTexture(texture, canvas);             drawScene();        }        image.src = filename;      }              function drawTextToCanvas(text, cex) {        var canvasX, canvasY;        var textX, textY;          var textHeight = 20 * cex;        var textColour = "white";        var fontFamily = "Arial";          var backgroundColour = "rgba(0,0,0,0)";          var canvas = document.getElementById("textureCanvas");        var ctx = canvas.getContext("2d");          ctx.font = textHeight+"px "+fontFamily;                 canvasX = 1;               var widths = [];        for (var i = 0; i < text.length; i++)  {          widths[i] = ctx.measureText(text[i]).width;          canvasX = (widths[i] > canvasX) ? widths[i] : canvasX;        }           canvasX = getPowerOfTwo(canvasX);          var offset = 2*textHeight; // offset to first baseline        var skip = 2*textHeight;   // skip between baselines           canvasY = getPowerOfTwo(offset + text.length*skip);                canvas.width = canvasX;        canvas.height = canvasY;          ctx.fillStyle = backgroundColour;        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);          ctx.fillStyle = textColour;        ctx.textAlign = "left";          ctx.textBaseline = "alphabetic";        ctx.font = textHeight+"px "+fontFamily;          for(var i = 0; i < text.length; i++) {          textY = i*skip + offset;          ctx.fillText(text[i], 0,  textY);        }        return {canvasX:canvasX, canvasY:canvasY,                widths:widths, textHeight:textHeight,                offset:offset, skip:skip};      }        // ****** sphere object ******      var v=new Float32Array([       -1, 0, 0,       1, 0, 0,       0, -1, 0,       0, 1, 0,       0, 0, -1,       0, 0, 1,       -0.7071068, 0, -0.7071068,       -0.7071068, -0.7071068, 0,       0, -0.7071068, -0.7071068,       -0.7071068, 0, 0.7071068,       0, -0.7071068, 0.7071068,       -0.7071068, 0.7071068, 0,       0, 0.7071068, -0.7071068,       0, 0.7071068, 0.7071068,       0.7071068, -0.7071068, 0,       0.7071068, 0, -0.7071068,       0.7071068, 0, 0.7071068,       0.7071068, 0.7071068, 0,       -0.9349975, 0, -0.3546542,       -0.9349975, -0.3546542, 0,       -0.77044, -0.4507894, -0.4507894,       0, -0.3546542, -0.9349975,       -0.3546542, 0, -0.9349975,       -0.4507894, -0.4507894, -0.77044,       -0.3546542, -0.9349975, 0,       0, -0.9349975, -0.3546542,       -0.4507894, -0.77044, -0.4507894,       -0.9349975, 0, 0.3546542,       -0.77044, -0.4507894, 0.4507894,       0, -0.9349975, 0.3546542,       -0.4507894, -0.77044, 0.4507894,       -0.3546542, 0, 0.9349975,       0, -0.3546542, 0.9349975,       -0.4507894, -0.4507894, 0.77044,       -0.9349975, 0.3546542, 0,       -0.77044, 0.4507894, -0.4507894,       0, 0.9349975, -0.3546542,       -0.3546542, 0.9349975, 0,       -0.4507894, 0.77044, -0.4507894,       0, 0.3546542, -0.9349975,       -0.4507894, 0.4507894, -0.77044,       -0.77044, 0.4507894, 0.4507894,       0, 0.3546542, 0.9349975,       -0.4507894, 0.4507894, 0.77044,       0, 0.9349975, 0.3546542,       -0.4507894, 0.77044, 0.4507894,       0.9349975, -0.3546542, 0,       0.9349975, 0, -0.3546542,       0.77044, -0.4507894, -0.4507894,       0.3546542, -0.9349975, 0,       0.4507894, -0.77044, -0.4507894,       0.3546542, 0, -0.9349975,       0.4507894, -0.4507894, -0.77044,       0.9349975, 0, 0.3546542,       0.77044, -0.4507894, 0.4507894,       0.3546542, 0, 0.9349975,       0.4507894, -0.4507894, 0.77044,       0.4507894, -0.77044, 0.4507894,       0.9349975, 0.3546542, 0,       0.77044, 0.4507894, -0.4507894,       0.4507894, 0.4507894, -0.77044,       0.3546542, 0.9349975, 0,       0.4507894, 0.77044, -0.4507894,       0.77044, 0.4507894, 0.4507894,       0.4507894, 0.77044, 0.4507894,       0.4507894, 0.4507894, 0.77044      ]);      var f=new Uint16Array([       0, 18, 19,       6, 20, 18,       7, 19, 20,       19, 18, 20,       4, 21, 22,       8, 23, 21,       6, 22, 23,       22, 21, 23,       2, 24, 25,       7, 26, 24,       8, 25, 26,       25, 24, 26,       7, 20, 26,       6, 23, 20,       8, 26, 23,       26, 20, 23,       0, 19, 27,       7, 28, 19,       9, 27, 28,       27, 19, 28,       2, 29, 24,       10, 30, 29,       7, 24, 30,       24, 29, 30,       5, 31, 32,       9, 33, 31,       10, 32, 33,       32, 31, 33,       9, 28, 33,       7, 30, 28,       10, 33, 30,       33, 28, 30,       0, 34, 18,       11, 35, 34,       6, 18, 35,       18, 34, 35,       3, 36, 37,       12, 38, 36,       11, 37, 38,       37, 36, 38,       4, 22, 39,       6, 40, 22,       12, 39, 40,       39, 22, 40,       6, 35, 40,       11, 38, 35,       12, 40, 38,       40, 35, 38,       0, 27, 34,       9, 41, 27,       11, 34, 41,       34, 27, 41,       5, 42, 31,       13, 43, 42,       9, 31, 43,       31, 42, 43,       3, 37, 44,       11, 45, 37,       13, 44, 45,       44, 37, 45,       11, 41, 45,       9, 43, 41,       13, 45, 43,       45, 41, 43,       1, 46, 47,       14, 48, 46,       15, 47, 48,       47, 46, 48,       2, 25, 49,       8, 50, 25,       14, 49, 50,       49, 25, 50,       4, 51, 21,       15, 52, 51,       8, 21, 52,       21, 51, 52,       15, 48, 52,       14, 50, 48,       8, 52, 50,       52, 48, 50,       1, 53, 46,       16, 54, 53,       14, 46, 54,       46, 53, 54,       5, 32, 55,       10, 56, 32,       16, 55, 56,       55, 32, 56,       2, 49, 29,       14, 57, 49,       10, 29, 57,       29, 49, 57,       14, 54, 57,       16, 56, 54,       10, 57, 56,       57, 54, 56,       1, 47, 58,       15, 59, 47,       17, 58, 59,       58, 47, 59,       4, 39, 51,       12, 60, 39,       15, 51, 60,       51, 39, 60,       3, 61, 36,       17, 62, 61,       12, 36, 62,       36, 61, 62,       17, 59, 62,       15, 60, 59,       12, 62, 60,       62, 59, 60,       1, 58, 53,       17, 63, 58,       16, 53, 63,       53, 58, 63,       3, 44, 61,       13, 64, 44,       17, 61, 64,       61, 44, 64,       5, 55, 42,       16, 65, 55,       13, 42, 65,       42, 55, 65,       16, 63, 65,       17, 64, 63,       13, 65, 64,       65, 63, 64      ]);      var sphereBuf = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var sphereIbuf = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);          // ****** spheres object 239 ******       var prog239  = gl.createProgram();      gl.attachShader(prog239, getShader( gl, "vshader239" ));      gl.attachShader(prog239, getShader( gl, "fshader239" ));      gl.linkProgram(prog239);      var v=new Float32Array([       -0.7360582, -0.8097717, -0.184769, 0.07251954,       -0.7090355, -0.3177036, -0.2254533, 0.07251954,       -0.3983411, -0.04592844, 0.01766646, 0.07251954,       0.2111181, 0.3618122, -0.1671288, 0.07251954,       -0.105393, -0.150015, 0.04935552, 0.07251954,       -0.2904764, 1.023577, -0.09017851, 0.07251954,       0.04970844, 1.022217, 0.08037175, 0.07251954,       -0.7182344, 1.629803, -0.2857811, 0.07251954,       -0.1608826, 0.7101135, -0.3064117, 0.07251954,       0.4554537, 2.149244, -0.8468165, 0.07251954,       0.1250244, 0.457413, -0.5773975, 0.07251954,       -1.296646, -1.042642, 0.3568214, 0.07251954,       -0.1432161, -2.144325, 0.6893726, 0.07251954,       0.4788847, 1.827464, -0.6226482, 0.07251954,       1.93307, 0.835873, -0.2185956, 0.07251954,       -0.9025634, 0.9428623, -0.727731, 0.07251954,       0.4630104, 0.7057953, -0.3223796, 0.07251954,       -0.8564801, -0.8002474, 0.07580626, 0.07251954,       -0.9793385, 1.25421, -0.7043687, 0.07251954,       -1.58403, -0.07509819, -0.4258776, 0.07251954,       1.525419, 0.122596, 0.3463933, 0.07251954,       -0.6979891, 0.2290093, 0.1074316, 0.07251954,       0.7650115, -0.8461767, -0.02393793, 0.07251954,       -0.8623808, 1.03183, -0.4127425, 0.07251954,       0.02365245, 0.5643005, 0.07247517, 0.07251954,       -2.868814, -0.4784647, -0.4672464, 0.07251954,       1.236103, 0.2431516, -0.04422293, 0.07251954,       0.442399, -2.148197, 0.6510106, 0.07251954,       0.4202794, 1.732579, -0.5720217, 0.07251954,       1.141971, -0.9644044, 0.9790122, 0.07251954,       -1.240136, 1.094013, -1.484329, 0.07251954,       -0.537174, -0.2139608, -0.1999433, 0.07251954,       -0.259307, -0.1341532, 0.09130681, 0.07251954,       1.267434, 1.309317, -0.1457968, 0.07251954,       -0.1228864, -1.549568, 0.1285024, 0.07251954,       -2.37523, 1.02363, -0.9546548, 0.07251954,       -0.663799, 0.3480093, -0.2904581, 0.07251954,       -0.1988356, -0.7531787, 0.4710256, 0.07251954,       -0.1778581, 1.368607, 0.2870684, 0.07251954,       -0.03814261, -1.712413, 0.796459, 0.07251954,       0.2514824, 1.939395, -0.1423318, 0.07251954,       0.1199793, -0.345493, 0.5651345, 0.07251954,       2.056365, 0.9429857, 0.4132785, 0.07251954,       -0.05963254, 1.329099, -0.7273115, 0.07251954,       0.4933315, 1.228903, 0.2179966, 0.07251954,       1.075629, -1.533805, 0.7139933, 0.07251954,       0.8984277, -0.0930111, 0.2031725, 0.07251954,       1.626615, -1.68457, 0.9514823, 0.07251954,       2.068547, 0.2299667, 0.7085923, 0.07251954,       0.4192415, 0.7138636, -0.1517258, 0.07251954,       -0.3291571, 0.9931673, -0.03473601, 0.07251954,       0.3760126, -1.972692, 0.3426828, 0.07251954,       0.1408257, 0.4112047, -0.01451151, 0.07251954,       -0.1722415, 0.07730468, 0.2246965, 0.07251954,       -0.004589869, 0.7394889, -0.5355464, 0.07251954,       0.6932299, -1.057765, 0.2043, 0.07251954,       -2.21236, -0.01060068, -0.3939556, 0.07251954,       2.101253, -0.5346986, 0.7867884, 0.07251954,       1.674502, -0.4125937, 0.3506719, 0.07251954,       0.7150607, -0.9395797, 0.7594901, 0.07251954,       -0.9316233, -0.9495837, 0.5164436, 0.07251954,       -1.04905, 0.563252, 0.3643607, 0.07251954,       -0.6744791, 0.4416391, -0.1317779, 0.07251954,       0.7436373, -0.2413827, 0.3893857, 0.07251954,       2.170507, 0.7749196, 0.1766532, 0.07251954,       0.7529872, -0.374545, 0.6647799, 0.07251954,       -0.2405993, -0.8841484, 0.3039195, 0.07251954,       1.324211, 0.5616076, 0.05791635, 0.07251954,       -0.9701296, 0.005045804, -0.1374829, 0.07251954,       -0.9234731, -0.8239884, -0.04358304, 0.07251954,       -0.5845629, -0.2585129, -0.09005689, 0.07251954,       0.06491626, -0.0393856, -0.07497638, 0.07251954,       -0.8870985, 0.1921452, -0.2851014, 0.07251954,       -0.2682969, -0.2092404, -0.03037218, 0.07251954,       -1.000231, -0.7095267, -0.09905201, 0.07251954,       0.3803551, -1.698704, 0.4646677, 0.07251954,       2.49845, 0.2175931, 0.1475495, 0.07251954,       0.6914608, -0.8071358, 0.4842937, 0.07251954,       0.08726744, 1.316983, -0.6415918, 0.07251954,       0.2607824, -0.8375669, 0.3444247, 0.07251954,       -0.1143137, 0.4791363, -0.3123364, 0.07251954,       0.09628915, -0.04360107, 0.003801726, 0.07251954,       0.72158, 0.782004, -0.2810178, 0.07251954,       1.018492, -0.9036565, 0.2524222, 0.07251954,       -0.9887653, -0.9949093, 0.08018254, 0.07251954,       1.089528, 2.533953, -0.5906966, 0.07251954,       0.8956026, -0.08786975, 0.2558134, 0.07251954,       -0.9244849, -0.02481855, -0.2631561, 0.07251954,       1.349253, 1.673971, -0.278616, 0.07251954,       0.8846292, 1.498446, -0.1739847, 0.07251954,       -0.6704076, -1.211575, 0.3309198, 0.07251954,       0.1253045, 0.07003474, -0.7228153, 0.07251954,       0.4239117, 1.062232, -0.3709097, 0.07251954,       -0.1338492, -0.124759, 0.4175456, 0.07251954,       -0.1669363, -0.1855016, -0.1456518, 0.07251954,       0.5502214, 0.7209047, -0.4895159, 0.07251954,       -1.122183, 0.5747423, -0.2502019, 0.07251954,       0.4242562, -0.9456573, 0.3889812, 0.07251954,       2.011295, -1.077935, 0.4461366, 0.07251954,       -0.3326764, -0.3050847, -0.01857337, 0.07251954      ]);      var values239 = v;      var posLoc239 = gl.getAttribLocation(prog239, "aPos");      var colLoc239 = gl.getAttribLocation(prog239, "aCol");      var normLoc239 = gl.getAttribLocation(prog239, "aNorm");      var mvMatLoc239 = gl.getUniformLocation(prog239,"mvMatrix");      var prMatLoc239 = gl.getUniformLocation(prog239,"prMatrix");      var normMatLoc239 = gl.getUniformLocation(prog239,"normMatrix");          // ****** text object 241 ******       var prog241  = gl.createProgram();      gl.attachShader(prog241, getShader( gl, "vshader241" ));      gl.attachShader(prog241, getShader( gl, "fshader241" ));      gl.linkProgram(prog241);      var texts = [       "x"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX241 = texinfo.canvasX;      var canvasY241 = texinfo.canvasY;      var ofsLoc241 = gl.getAttribLocation(prog241, "aOfs");      var texture241 = gl.createTexture();      var texLoc241 = gl.getAttribLocation(prog241, "aTexcoord");      var sampler241 = gl.getUniformLocation(prog241,"uSampler");          handleLoadedTexture(texture241, document.getElementById("textureCanvas"));      var v=new Float32Array([       -0.1851821, -3.046312, -1.956839, 0, -0.5, 0.5, 0.5,       -0.1851821, -3.046312, -1.956839, 1, -0.5, 0.5, 0.5,       -0.1851821, -3.046312, -1.956839, 1, 1.5, 0.5, 0.5,       -0.1851821, -3.046312, -1.956839, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<1; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc241 = gl.getAttribLocation(prog241, "aPos");      var colLoc241 = gl.getAttribLocation(prog241, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3      ]);      var buf241 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf241);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf241 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf241);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc241 = gl.getUniformLocation(prog241,"mvMatrix");      var prMatLoc241 = gl.getUniformLocation(prog241,"prMatrix");          // ****** text object 242 ******       var prog242  = gl.createProgram();      gl.attachShader(prog242, getShader( gl, "vshader242" ));      gl.attachShader(prog242, getShader( gl, "fshader242" ));      gl.linkProgram(prog242);      var texts = [       "y"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX242 = texinfo.canvasX;      var canvasY242 = texinfo.canvasY;      var ofsLoc242 = gl.getAttribLocation(prog242, "aOfs");      var texture242 = gl.createTexture();      var texLoc242 = gl.getAttribLocation(prog242, "aTexcoord");      var sampler242 = gl.getUniformLocation(prog242,"uSampler");          handleLoadedTexture(texture242, document.getElementById("textureCanvas"));      var v=new Float32Array([       -3.898345, 0.1928781, -1.956839, 0, -0.5, 0.5, 0.5,       -3.898345, 0.1928781, -1.956839, 1, -0.5, 0.5, 0.5,       -3.898345, 0.1928781, -1.956839, 1, 1.5, 0.5, 0.5,       -3.898345, 0.1928781, -1.956839, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<1; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc242 = gl.getAttribLocation(prog242, "aPos");      var colLoc242 = gl.getAttribLocation(prog242, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3      ]);      var buf242 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf242);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf242 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf242);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc242 = gl.getUniformLocation(prog242,"mvMatrix");      var prMatLoc242 = gl.getUniformLocation(prog242,"prMatrix");          // ****** text object 243 ******       var prog243  = gl.createProgram();      gl.attachShader(prog243, getShader( gl, "vshader243" ));      gl.attachShader(prog243, getShader( gl, "fshader243" ));      gl.linkProgram(prog243);      var texts = [       "z"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX243 = texinfo.canvasX;      var canvasY243 = texinfo.canvasY;      var ofsLoc243 = gl.getAttribLocation(prog243, "aOfs");      var texture243 = gl.createTexture();      var texLoc243 = gl.getAttribLocation(prog243, "aTexcoord");      var sampler243 = gl.getUniformLocation(prog243,"uSampler");          handleLoadedTexture(texture243, document.getElementById("textureCanvas"));      var v=new Float32Array([       -3.898345, -3.046312, -0.2526586, 0, -0.5, 0.5, 0.5,       -3.898345, -3.046312, -0.2526586, 1, -0.5, 0.5, 0.5,       -3.898345, -3.046312, -0.2526586, 1, 1.5, 0.5, 0.5,       -3.898345, -3.046312, -0.2526586, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<1; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc243 = gl.getAttribLocation(prog243, "aPos");      var colLoc243 = gl.getAttribLocation(prog243, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3      ]);      var buf243 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf243);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf243 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf243);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc243 = gl.getUniformLocation(prog243,"mvMatrix");      var prMatLoc243 = gl.getUniformLocation(prog243,"prMatrix");          // ****** planes object 244 ******       var prog244  = gl.createProgram();      gl.attachShader(prog244, getShader( gl, "vshader244" ));      gl.attachShader(prog244, getShader( gl, "fshader244" ));      gl.linkProgram(prog244);      var v=new Float32Array([       -2.958268, -2.226233, 0.1069721, 0.1942659, -0.3046993, -1,       -2.958268, 2.611989, -1.367231, 0.1942659, -0.3046993, -1,       2.587904, 2.611989, -0.2897987, 0.1942659, -0.3046993, -1,       -2.958268, -2.226233, 0.1069721, 0.1942659, -0.3046993, -1,       2.587904, 2.611989, -0.2897987, 0.1942659, -0.3046993, -1,       2.587904, -1.686894, 1.020068, 0.1942659, -0.3046993, -1,       -2.958268, -2.226233, 0.1069721, 0.1942659, -0.3046993, -1,       2.587904, -1.686894, 1.020068, 0.1942659, -0.3046993, -1,       1.741969, -2.226233, 1.020068, 0.1942659, -0.3046993, -1,       NaN, NaN, NaN, 0.1942659, -0.3046993, -1,       NaN, NaN, NaN, 0.1942659, -0.3046993, -1,       NaN, NaN, NaN, 0.1942659, -0.3046993, -1      ]);      var posLoc244 = gl.getAttribLocation(prog244, "aPos");      var colLoc244 = gl.getAttribLocation(prog244, "aCol");      var normLoc244 = gl.getAttribLocation(prog244, "aNorm");      var buf244 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf244);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var mvMatLoc244 = gl.getUniformLocation(prog244,"mvMatrix");      var prMatLoc244 = gl.getUniformLocation(prog244,"prMatrix");      var normMatLoc244 = gl.getUniformLocation(prog244,"normMatrix");          // ****** lines object 245 ******       var prog245  = gl.createProgram();      gl.attachShader(prog245, getShader( gl, "vshader245" ));      gl.attachShader(prog245, getShader( gl, "fshader245" ));      gl.linkProgram(prog245);      var v=new Float32Array([       -2, -2.298806, -1.563567,       2, -2.298806, -1.563567,       -2, -2.298806, -1.563567,       -2, -2.423391, -1.629112,       -1, -2.298806, -1.563567,       -1, -2.423391, -1.629112,       0, -2.298806, -1.563567,       0, -2.423391, -1.629112,       1, -2.298806, -1.563567,       1, -2.423391, -1.629112,       2, -2.298806, -1.563567,       2, -2.423391, -1.629112      ]);      var posLoc245 = gl.getAttribLocation(prog245, "aPos");      var colLoc245 = gl.getAttribLocation(prog245, "aCol");      var buf245 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf245);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var mvMatLoc245 = gl.getUniformLocation(prog245,"mvMatrix");      var prMatLoc245 = gl.getUniformLocation(prog245,"prMatrix");          // ****** text object 246 ******       var prog246  = gl.createProgram();      gl.attachShader(prog246, getShader( gl, "vshader246" ));      gl.attachShader(prog246, getShader( gl, "fshader246" ));      gl.linkProgram(prog246);      var texts = [       "-2",       "-1",       "0",       "1",       "2"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX246 = texinfo.canvasX;      var canvasY246 = texinfo.canvasY;      var ofsLoc246 = gl.getAttribLocation(prog246, "aOfs");      var texture246 = gl.createTexture();      var texLoc246 = gl.getAttribLocation(prog246, "aTexcoord");      var sampler246 = gl.getUniformLocation(prog246,"uSampler");          handleLoadedTexture(texture246, document.getElementById("textureCanvas"));      var v=new Float32Array([       -2, -2.672559, -1.760203, 0, -0.5, 0.5, 0.5,       -2, -2.672559, -1.760203, 1, -0.5, 0.5, 0.5,       -2, -2.672559, -1.760203, 1, 1.5, 0.5, 0.5,       -2, -2.672559, -1.760203, 0, 1.5, 0.5, 0.5,       -1, -2.672559, -1.760203, 0, -0.5, 0.5, 0.5,       -1, -2.672559, -1.760203, 1, -0.5, 0.5, 0.5,       -1, -2.672559, -1.760203, 1, 1.5, 0.5, 0.5,       -1, -2.672559, -1.760203, 0, 1.5, 0.5, 0.5,       0, -2.672559, -1.760203, 0, -0.5, 0.5, 0.5,       0, -2.672559, -1.760203, 1, -0.5, 0.5, 0.5,       0, -2.672559, -1.760203, 1, 1.5, 0.5, 0.5,       0, -2.672559, -1.760203, 0, 1.5, 0.5, 0.5,       1, -2.672559, -1.760203, 0, -0.5, 0.5, 0.5,       1, -2.672559, -1.760203, 1, -0.5, 0.5, 0.5,       1, -2.672559, -1.760203, 1, 1.5, 0.5, 0.5,       1, -2.672559, -1.760203, 0, 1.5, 0.5, 0.5,       2, -2.672559, -1.760203, 0, -0.5, 0.5, 0.5,       2, -2.672559, -1.760203, 1, -0.5, 0.5, 0.5,       2, -2.672559, -1.760203, 1, 1.5, 0.5, 0.5,       2, -2.672559, -1.760203, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<5; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc246 = gl.getAttribLocation(prog246, "aPos");      var colLoc246 = gl.getAttribLocation(prog246, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3,       4, 5, 6, 4, 6, 7,       8, 9, 10, 8, 10, 11,       12, 13, 14, 12, 14, 15,       16, 17, 18, 16, 18, 19      ]);      var buf246 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf246);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf246 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf246);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc246 = gl.getUniformLocation(prog246,"mvMatrix");      var prMatLoc246 = gl.getUniformLocation(prog246,"prMatrix");          // ****** lines object 247 ******       var prog247  = gl.createProgram();      gl.attachShader(prog247, getShader( gl, "vshader247" ));      gl.attachShader(prog247, getShader( gl, "fshader247" ));      gl.linkProgram(prog247);      var v=new Float32Array([       -3.041461, -2, -1.563567,       -3.041461, 2, -1.563567,       -3.041461, -2, -1.563567,       -3.184275, -2, -1.629112,       -3.041461, -1, -1.563567,       -3.184275, -1, -1.629112,       -3.041461, 0, -1.563567,       -3.184275, 0, -1.629112,       -3.041461, 1, -1.563567,       -3.184275, 1, -1.629112,       -3.041461, 2, -1.563567,       -3.184275, 2, -1.629112      ]);      var posLoc247 = gl.getAttribLocation(prog247, "aPos");      var colLoc247 = gl.getAttribLocation(prog247, "aCol");      var buf247 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf247);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var mvMatLoc247 = gl.getUniformLocation(prog247,"mvMatrix");      var prMatLoc247 = gl.getUniformLocation(prog247,"prMatrix");          // ****** text object 248 ******       var prog248  = gl.createProgram();      gl.attachShader(prog248, getShader( gl, "vshader248" ));      gl.attachShader(prog248, getShader( gl, "fshader248" ));      gl.linkProgram(prog248);      var texts = [       "-2",       "-1",       "0",       "1",       "2"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX248 = texinfo.canvasX;      var canvasY248 = texinfo.canvasY;      var ofsLoc248 = gl.getAttribLocation(prog248, "aOfs");      var texture248 = gl.createTexture();      var texLoc248 = gl.getAttribLocation(prog248, "aTexcoord");      var sampler248 = gl.getUniformLocation(prog248,"uSampler");          handleLoadedTexture(texture248, document.getElementById("textureCanvas"));      var v=new Float32Array([       -3.469903, -2, -1.760203, 0, -0.5, 0.5, 0.5,       -3.469903, -2, -1.760203, 1, -0.5, 0.5, 0.5,       -3.469903, -2, -1.760203, 1, 1.5, 0.5, 0.5,       -3.469903, -2, -1.760203, 0, 1.5, 0.5, 0.5,       -3.469903, -1, -1.760203, 0, -0.5, 0.5, 0.5,       -3.469903, -1, -1.760203, 1, -0.5, 0.5, 0.5,       -3.469903, -1, -1.760203, 1, 1.5, 0.5, 0.5,       -3.469903, -1, -1.760203, 0, 1.5, 0.5, 0.5,       -3.469903, 0, -1.760203, 0, -0.5, 0.5, 0.5,       -3.469903, 0, -1.760203, 1, -0.5, 0.5, 0.5,       -3.469903, 0, -1.760203, 1, 1.5, 0.5, 0.5,       -3.469903, 0, -1.760203, 0, 1.5, 0.5, 0.5,       -3.469903, 1, -1.760203, 0, -0.5, 0.5, 0.5,       -3.469903, 1, -1.760203, 1, -0.5, 0.5, 0.5,       -3.469903, 1, -1.760203, 1, 1.5, 0.5, 0.5,       -3.469903, 1, -1.760203, 0, 1.5, 0.5, 0.5,       -3.469903, 2, -1.760203, 0, -0.5, 0.5, 0.5,       -3.469903, 2, -1.760203, 1, -0.5, 0.5, 0.5,       -3.469903, 2, -1.760203, 1, 1.5, 0.5, 0.5,       -3.469903, 2, -1.760203, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<5; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc248 = gl.getAttribLocation(prog248, "aPos");      var colLoc248 = gl.getAttribLocation(prog248, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3,       4, 5, 6, 4, 6, 7,       8, 9, 10, 8, 10, 11,       12, 13, 14, 12, 14, 15,       16, 17, 18, 16, 18, 19      ]);      var buf248 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf248);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf248 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf248);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc248 = gl.getUniformLocation(prog248,"mvMatrix");      var prMatLoc248 = gl.getUniformLocation(prog248,"prMatrix");          // ****** lines object 249 ******       var prog249  = gl.createProgram();      gl.attachShader(prog249, getShader( gl, "vshader249" ));      gl.attachShader(prog249, getShader( gl, "fshader249" ));      gl.linkProgram(prog249);      var v=new Float32Array([       -3.041461, -2.298806, -1.5,       -3.041461, -2.298806, 1,       -3.041461, -2.298806, -1.5,       -3.184275, -2.423391, -1.5,       -3.041461, -2.298806, -1,       -3.184275, -2.423391, -1,       -3.041461, -2.298806, -0.5,       -3.184275, -2.423391, -0.5,       -3.041461, -2.298806, 0,       -3.184275, -2.423391, 0,       -3.041461, -2.298806, 0.5,       -3.184275, -2.423391, 0.5,       -3.041461, -2.298806, 1,       -3.184275, -2.423391, 1      ]);      var posLoc249 = gl.getAttribLocation(prog249, "aPos");      var colLoc249 = gl.getAttribLocation(prog249, "aCol");      var buf249 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf249);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var mvMatLoc249 = gl.getUniformLocation(prog249,"mvMatrix");      var prMatLoc249 = gl.getUniformLocation(prog249,"prMatrix");          // ****** text object 250 ******       var prog250  = gl.createProgram();      gl.attachShader(prog250, getShader( gl, "vshader250" ));      gl.attachShader(prog250, getShader( gl, "fshader250" ));      gl.linkProgram(prog250);      var texts = [       "-1.5",       "-1",       "-0.5",       "0",       "0.5",       "1"      ];      var texinfo = drawTextToCanvas(texts, 1);        var canvasX250 = texinfo.canvasX;      var canvasY250 = texinfo.canvasY;      var ofsLoc250 = gl.getAttribLocation(prog250, "aOfs");      var texture250 = gl.createTexture();      var texLoc250 = gl.getAttribLocation(prog250, "aTexcoord");      var sampler250 = gl.getUniformLocation(prog250,"uSampler");          handleLoadedTexture(texture250, document.getElementById("textureCanvas"));      var v=new Float32Array([       -3.469903, -2.672559, -1.5, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -1.5, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -1.5, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, -1.5, 0, 1.5, 0.5, 0.5,       -3.469903, -2.672559, -1, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -1, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -1, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, -1, 0, 1.5, 0.5, 0.5,       -3.469903, -2.672559, -0.5, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -0.5, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, -0.5, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, -0.5, 0, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 0, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 0, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 0, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 0, 0, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 0.5, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 0.5, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 0.5, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 0.5, 0, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 1, 0, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 1, 1, -0.5, 0.5, 0.5,       -3.469903, -2.672559, 1, 1, 1.5, 0.5, 0.5,       -3.469903, -2.672559, 1, 0, 1.5, 0.5, 0.5      ]);      for (var i=0; i<6; i++)         for (var j=0; j<4; j++) {            ind = 7*(4*i + j) + 3;            v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;            v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;            v[ind] *= texinfo.widths[i]/texinfo.canvasX;            v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip               - v[ind+1]*texinfo.textHeight)/texinfo.canvasY;        }      var posLoc250 = gl.getAttribLocation(prog250, "aPos");      var colLoc250 = gl.getAttribLocation(prog250, "aCol");      var f=new Uint16Array([       0, 1, 2, 0, 2, 3,       4, 5, 6, 4, 6, 7,       8, 9, 10, 8, 10, 11,       12, 13, 14, 12, 14, 15,       16, 17, 18, 16, 18, 19,       20, 21, 22, 20, 22, 23      ]);      var buf250 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf250);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var ibuf250 = gl.createBuffer();      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf250);      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);      var mvMatLoc250 = gl.getUniformLocation(prog250,"mvMatrix");      var prMatLoc250 = gl.getUniformLocation(prog250,"prMatrix");          // ****** lines object 251 ******       var prog251  = gl.createProgram();      gl.attachShader(prog251, getShader( gl, "vshader251" ));      gl.attachShader(prog251, getShader( gl, "fshader251" ));      gl.linkProgram(prog251);      var v=new Float32Array([       -3.041461, -2.298806, -1.563567,       -3.041461, 2.684563, -1.563567,       -3.041461, -2.298806, 1.05825,       -3.041461, 2.684563, 1.05825,       -3.041461, -2.298806, -1.563567,       -3.041461, -2.298806, 1.05825,       -3.041461, 2.684563, -1.563567,       -3.041461, 2.684563, 1.05825,       -3.041461, -2.298806, -1.563567,       2.671097, -2.298806, -1.563567,       -3.041461, -2.298806, 1.05825,       2.671097, -2.298806, 1.05825,       -3.041461, 2.684563, -1.563567,       2.671097, 2.684563, -1.563567,       -3.041461, 2.684563, 1.05825,       2.671097, 2.684563, 1.05825,       2.671097, -2.298806, -1.563567,       2.671097, 2.684563, -1.563567,       2.671097, -2.298806, 1.05825,       2.671097, 2.684563, 1.05825,       2.671097, -2.298806, -1.563567,       2.671097, -2.298806, 1.05825,       2.671097, 2.684563, -1.563567,       2.671097, 2.684563, 1.05825      ]);      var posLoc251 = gl.getAttribLocation(prog251, "aPos");      var colLoc251 = gl.getAttribLocation(prog251, "aCol");      var buf251 = gl.createBuffer();      gl.bindBuffer(gl.ARRAY_BUFFER, buf251);      gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);      var mvMatLoc251 = gl.getUniformLocation(prog251,"mvMatrix");      var prMatLoc251 = gl.getUniformLocation(prog251,"prMatrix");        gl.enable(gl.DEPTH_TEST);      gl.depthFunc(gl.LEQUAL);      gl.clearDepth(1.0);      gl.clearColor(1, 1, 1, 1);      var xOffs = yOffs = 0,  drag  = 0;      drawScene();        function drawScene(){        gl.depthMask(true);        gl.disable(gl.BLEND);        var radius = 4.283217;        var s = sin(fov*PI/360);        var t = tan(fov*PI/360);        var distance = radius/s;        var near = distance - radius;        var far = distance + radius;        var hlen = t*near;        var aspect = width/height;        prMatrix.makeIdentity();        if (aspect > 1)          prMatrix.frustum(-hlen*aspect*zoom, hlen*aspect*zoom,                            -hlen*zoom, hlen*zoom, near, far);        else            prMatrix.frustum(-hlen*zoom, hlen*zoom,                            -hlen*zoom/aspect, hlen*zoom/aspect,                            near, far);        mvMatrix.makeIdentity();        mvMatrix.translate( 0.1851821, -0.1928781, 0.2526586 );        mvMatrix.scale( 0.8106873, 0.9293107, 1.76637 );           mvMatrix.multRight( userMatrix );          mvMatrix.translate(0, 0, -distance);        normMatrix.makeIdentity();        normMatrix.scale( 1.233521, 1.076066, 0.5661329 );           normMatrix.multRight( userMatrix );        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);            // ****** spheres object 239 *******        gl.useProgram(prog239);        gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);        gl.uniformMatrix4fv( prMatLoc239, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc239, false, new Float32Array(mvMatrix.getAsArray()) );        gl.uniformMatrix4fv( normMatLoc239, false, new Float32Array(normMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc239 );        gl.vertexAttribPointer(posLoc239,  3, gl.FLOAT, false, 12,  0);        gl.enableVertexAttribArray(normLoc239 );        gl.vertexAttribPointer(normLoc239,  3, gl.FLOAT, false, 12,  0);        gl.disableVertexAttribArray( colLoc239 );        var sphereNorm = new CanvasMatrix4();        sphereNorm.scale(0.8106873, 0.9293107, 1.76637);        sphereNorm.multRight(normMatrix);        gl.uniformMatrix4fv( normMatLoc239, false, new Float32Array(sphereNorm.getAsArray()) );        gl.vertexAttrib4f( colLoc239, 1, 0, 0, 1);        for (var i = 0; i < 100; i++) {          var sphereMV = new CanvasMatrix4();          var baseofs = i*4          var ofs = baseofs + 3;                  var scale = values239[ofs];          sphereMV.scale(1.233521*scale, 1.076066*scale, 0.5661329*scale);          sphereMV.translate(values239[baseofs],                values239[baseofs+1],                values239[baseofs+2]);          sphereMV.multRight(mvMatrix);          gl.uniformMatrix4fv( mvMatLoc239, false, new Float32Array(sphereMV.getAsArray()) );          gl.drawElements(gl.TRIANGLES, 384, gl.UNSIGNED_SHORT, 0);        }          // ****** text object 241 *******        gl.useProgram(prog241);        gl.bindBuffer(gl.ARRAY_BUFFER, buf241);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf241);        gl.uniformMatrix4fv( prMatLoc241, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc241, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc241 );        gl.disableVertexAttribArray( colLoc241 );        gl.vertexAttrib4f( colLoc241, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc241 );        gl.vertexAttribPointer(texLoc241, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture241);        gl.uniform1i( sampler241, 0);        gl.enableVertexAttribArray( ofsLoc241 );        gl.vertexAttribPointer(ofsLoc241, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc241,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);          // ****** text object 242 *******        gl.useProgram(prog242);        gl.bindBuffer(gl.ARRAY_BUFFER, buf242);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf242);        gl.uniformMatrix4fv( prMatLoc242, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc242, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc242 );        gl.disableVertexAttribArray( colLoc242 );        gl.vertexAttrib4f( colLoc242, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc242 );        gl.vertexAttribPointer(texLoc242, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture242);        gl.uniform1i( sampler242, 0);        gl.enableVertexAttribArray( ofsLoc242 );        gl.vertexAttribPointer(ofsLoc242, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc242,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);          // ****** text object 243 *******        gl.useProgram(prog243);        gl.bindBuffer(gl.ARRAY_BUFFER, buf243);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf243);        gl.uniformMatrix4fv( prMatLoc243, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc243, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc243 );        gl.disableVertexAttribArray( colLoc243 );        gl.vertexAttrib4f( colLoc243, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc243 );        gl.vertexAttribPointer(texLoc243, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture243);        gl.uniform1i( sampler243, 0);        gl.enableVertexAttribArray( ofsLoc243 );        gl.vertexAttribPointer(ofsLoc243, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc243,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);          // ****** lines object 245 *******        gl.useProgram(prog245);        gl.bindBuffer(gl.ARRAY_BUFFER, buf245);        gl.uniformMatrix4fv( prMatLoc245, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc245, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc245 );        gl.disableVertexAttribArray( colLoc245 );        gl.vertexAttrib4f( colLoc245, 0, 0, 0, 1 );        gl.lineWidth( 1 );        gl.vertexAttribPointer(posLoc245,  3, gl.FLOAT, false, 12,  0);        gl.drawArrays(gl.LINES, 0, 12);          // ****** text object 246 *******        gl.useProgram(prog246);        gl.bindBuffer(gl.ARRAY_BUFFER, buf246);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf246);        gl.uniformMatrix4fv( prMatLoc246, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc246, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc246 );        gl.disableVertexAttribArray( colLoc246 );        gl.vertexAttrib4f( colLoc246, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc246 );        gl.vertexAttribPointer(texLoc246, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture246);        gl.uniform1i( sampler246, 0);        gl.enableVertexAttribArray( ofsLoc246 );        gl.vertexAttribPointer(ofsLoc246, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc246,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 30, gl.UNSIGNED_SHORT, 0);          // ****** lines object 247 *******        gl.useProgram(prog247);        gl.bindBuffer(gl.ARRAY_BUFFER, buf247);        gl.uniformMatrix4fv( prMatLoc247, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc247, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc247 );        gl.disableVertexAttribArray( colLoc247 );        gl.vertexAttrib4f( colLoc247, 0, 0, 0, 1 );        gl.lineWidth( 1 );        gl.vertexAttribPointer(posLoc247,  3, gl.FLOAT, false, 12,  0);        gl.drawArrays(gl.LINES, 0, 12);          // ****** text object 248 *******        gl.useProgram(prog248);        gl.bindBuffer(gl.ARRAY_BUFFER, buf248);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf248);        gl.uniformMatrix4fv( prMatLoc248, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc248, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc248 );        gl.disableVertexAttribArray( colLoc248 );        gl.vertexAttrib4f( colLoc248, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc248 );        gl.vertexAttribPointer(texLoc248, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture248);        gl.uniform1i( sampler248, 0);        gl.enableVertexAttribArray( ofsLoc248 );        gl.vertexAttribPointer(ofsLoc248, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc248,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 30, gl.UNSIGNED_SHORT, 0);          // ****** lines object 249 *******        gl.useProgram(prog249);        gl.bindBuffer(gl.ARRAY_BUFFER, buf249);        gl.uniformMatrix4fv( prMatLoc249, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc249, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc249 );        gl.disableVertexAttribArray( colLoc249 );        gl.vertexAttrib4f( colLoc249, 0, 0, 0, 1 );        gl.lineWidth( 1 );        gl.vertexAttribPointer(posLoc249,  3, gl.FLOAT, false, 12,  0);        gl.drawArrays(gl.LINES, 0, 14);          // ****** text object 250 *******        gl.useProgram(prog250);        gl.bindBuffer(gl.ARRAY_BUFFER, buf250);        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf250);        gl.uniformMatrix4fv( prMatLoc250, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc250, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc250 );        gl.disableVertexAttribArray( colLoc250 );        gl.vertexAttrib4f( colLoc250, 0, 0, 0, 1 );        gl.enableVertexAttribArray( texLoc250 );        gl.vertexAttribPointer(texLoc250, 2, gl.FLOAT, false, 28, 12);        gl.activeTexture(gl.TEXTURE0);        gl.bindTexture(gl.TEXTURE_2D, texture250);        gl.uniform1i( sampler250, 0);        gl.enableVertexAttribArray( ofsLoc250 );        gl.vertexAttribPointer(ofsLoc250, 2, gl.FLOAT, false, 28, 20);        gl.vertexAttribPointer(posLoc250,  3, gl.FLOAT, false, 28,  0);        gl.drawElements(gl.TRIANGLES, 36, gl.UNSIGNED_SHORT, 0);          // ****** lines object 251 *******        gl.useProgram(prog251);        gl.bindBuffer(gl.ARRAY_BUFFER, buf251);        gl.uniformMatrix4fv( prMatLoc251, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc251, false, new Float32Array(mvMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc251 );        gl.disableVertexAttribArray( colLoc251 );        gl.vertexAttrib4f( colLoc251, 0, 0, 0, 1 );        gl.lineWidth( 1 );        gl.vertexAttribPointer(posLoc251,  3, gl.FLOAT, false, 12,  0);        gl.drawArrays(gl.LINES, 0, 24);            // ***** Transparent objects next ****        gl.depthMask(false);        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,                             gl.ONE, gl.ONE);        gl.enable(gl.BLEND);            // ****** planes object 244 *******        gl.useProgram(prog244);        gl.bindBuffer(gl.ARRAY_BUFFER, buf244);        gl.uniformMatrix4fv( prMatLoc244, false, new Float32Array(prMatrix.getAsArray()) );        gl.uniformMatrix4fv( mvMatLoc244, false, new Float32Array(mvMatrix.getAsArray()) );        gl.uniformMatrix4fv( normMatLoc244, false, new Float32Array(normMatrix.getAsArray()) );        gl.enableVertexAttribArray( posLoc244 );        gl.disableVertexAttribArray( colLoc244 );        gl.vertexAttrib4f( colLoc244, 0, 0, 0, 0.4980392 );        gl.enableVertexAttribArray( normLoc244 );        gl.vertexAttribPointer(normLoc244, 3, gl.FLOAT, false, 24, 12);        gl.vertexAttribPointer(posLoc244,  3, gl.FLOAT, false, 24,  0);        gl.drawArrays(gl.TRIANGLES, 0, 12);          gl.flush ();      }        var vlen = function(v) {        return sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2])      }            var xprod = function(a, b) {        return [a[1]*b[2] - a[2]*b[1],                a[2]*b[0] - a[0]*b[2],                a[0]*b[1] - a[1]*b[0]];      }        var screenToVector = function(x, y) {        var radius = max(width, height)/2.0;        var cx = width/2.0;        var cy = height/2.0;        var px = (x-cx)/radius;        var py = (y-cy)/radius;        var plen = sqrt(px*px+py*py);        if (plen > 1.e-6) {           px = px/plen;          py = py/plen;        }          var angle = (SQRT2 - plen)/SQRT2*PI/2;        var z = sin(angle);        var zlen = sqrt(1.0 - z*z);        px = px * zlen;        py = py * zlen;        return [px, py, z];      }        var rotBase;        var trackballdown = function(x,y) {        rotBase = screenToVector(x, y);        saveMat.load(userMatrix);      }            var trackballmove = function(x,y) {        var rotCurrent = screenToVector(x,y);        var dot = rotBase[0]*rotCurrent[0] +               rotBase[1]*rotCurrent[1] +               rotBase[2]*rotCurrent[2];        var angle = acos( dot/vlen(rotBase)/vlen(rotCurrent) )*180./PI;        var axis = xprod(rotBase, rotCurrent);        userMatrix.load(saveMat);        userMatrix.rotate(angle, axis[0], axis[1], axis[2]);        drawScene();      }        var y0zoom = 0;      var zoom0 = 1;      var zoomdown = function(x, y) {        y0zoom = y;        zoom0 = log(zoom);      }        var zoommove = function(x, y) {        zoom = exp(zoom0 + (y-y0zoom)/height);        drawScene();      }        var y0fov = 0;      var fov0 = 1;      var fovdown = function(x, y) {        y0fov = y;        fov0 = fov;      }        var fovmove = function(x, y) {        fov = max(1, min(179, fov0 + 180*(y-y0fov)/height));        drawScene();      }        var mousedown = [trackballdown, zoomdown, fovdown];      var mousemove = [trackballmove, zoommove, fovmove];        function relMouseCoords(event){        var totalOffsetX = 0;        var totalOffsetY = 0;        var currentElement = canvas;              do{          totalOffsetX += currentElement.offsetLeft;          totalOffsetY += currentElement.offsetTop;        }        while(currentElement = currentElement.offsetParent)              var canvasX = event.pageX - totalOffsetX;        var canvasY = event.pageY - totalOffsetY;              return {x:canvasX, y:canvasY}      }        canvas.onmousedown = function ( ev ){        if (!ev.which) // Use w3c defns in preference to MS          switch (ev.button) {          case 0: ev.which = 1; break;          case 1:           case 4: ev.which = 2; break;          case 2: ev.which = 3;        }        drag = ev.which;        var f = mousedown[drag-1];        if (f) {          var coords = relMouseCoords(ev);          f(coords.x, height-coords.y);           ev.preventDefault();        }      }            canvas.onmouseup = function ( ev ){         drag = 0;      }            canvas.onmouseout = canvas.onmouseup;        canvas.onmousemove = function ( ev ){        if ( drag == 0 ) return;        var f = mousemove[drag-1];        if (f) {          var coords = relMouseCoords(ev);          f(coords.x, height-coords.y);        }      }        var wheelHandler = function(ev) {        var del = 1.1;        if (ev.shiftKey) del = 1.01;        var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);        zoom *= ds;        drawScene();        ev.preventDefault();      };      canvas.addEventListener("DOMMouseScroll", wheelHandler, false);      canvas.addEventListener("mousewheel", wheelHandler, false);     }   </script>    <canvas id="canvas" width="1" height="1"></canvas>           <p id="debug">  <img src="http://dl.dropbox.com/u/6547489/snapshot.png" alt="snapshot" width=600/><br>  You must enable Javascript to view this page properly.</p>     </div>        <br>Drag mouse to rotate model. Use mouse wheel or middle button   to zoom it.   <hr>  <br>  Object written from rgl by writeWebGL.     </body>  </html>
