--- 
layout: post
name: stringr
title: "\xE7\x94\xA8stringr\xE5\x8C\x85\xE5\xA4\x84\xE7\x90\x86\xE5\xAD\x97\xE7\xAC\xA6\xE4\xB8\xB2"
date: 2012-07-25 08:54:00 +08:00
categories: 
- "\xE6\x95\xB0\xE6\x8D\xAE\xE9\xA2\x84\xE5\xA4\x84\xE7\x90\x86"
permalink: /2012/07/stringr.html
---
<br />《Machine Learning for Hackers》一书的合著者John Myles White近日接受了一个<a href="http://john.myles.white.usesthis.com/">访谈</a>。在访谈中他提到了自己在R中常用的几个扩展包，其中包括用<b>ggplot2</b>包来绘图，用<b>glmnet</b>包做回归，用<b>tm</b>包进行文本挖掘，用<b>plyr、reshape、lubridate和stringr包</b>进行数据预处理。这些包本博客大部分都有所介绍，今天就来看看这个遗漏的stringr包。<br /><br />从名字就看得出，stringr包是用来处理字符串的。R语言本身的<a href="http://xccds1977.blogspot.com/2012/02/r_28.html">字符处理</a>能力已经不错了，但使用起来并不是很方便。stringr包将原本的字符处理函数进行了打包，统一了函数名和参数。在增强功能基础上，还能处理向量化数据并兼容非字符数据。stringr包号称能让处理字符的时间减少95%。下面将其中的一些主要函数罗列一下。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/stringr">stringr</a><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 合并字符串</span><br />fruit &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"apple"</span><span style="color: #339933;">,</span> <span style="color: blue;">"banana"</span><span style="color: #339933;">,</span> <span style="color: blue;">"pear"</span><span style="color: #339933;">,</span> <span style="color: blue;">"pinapple"</span><span style="color: #009900;">)</span><br />res &lt;- str_c<span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>fruit<span style="color: #339933;">,</span>sep=<span style="color: blue;">' '</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/nlme/collapse"><span style="color: #003399;">collapse</span></a>=<span style="color: blue;">' '</span><span style="color: #009900;">)</span><br />str_c<span style="color: #009900;">(</span><span style="color: blue;">'I want to buy '</span><span style="color: #339933;">,</span>res<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/nlme/collapse"><span style="color: #003399;">collapse</span></a>=<span style="color: blue;">' '</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 计算字符串长度</span><br />str_length<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"i"</span><span style="color: #339933;">,</span> <span style="color: blue;">"like"</span><span style="color: #339933;">,</span> <span style="color: blue;">"programming R"</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">123</span><span style="color: #339933;">,</span>res<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"><a name='more'></a># 按位置取子字符串</span><br />str_sub<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 子字符串重新赋值</span><br />capital &lt;-<a href="http://inside-r.org/r-doc/base/toupper"><span style="color: #003399;">toupper</span></a><span style="color: #009900;">(</span>str_sub<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />str_sub<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> &lt;- capital <br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 重复字符串</span><br />str_dup<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 加空白</span><br />str_pad<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> <span style="color: blue;">"both"</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 去除空白</span><br />str_trim<span style="color: #009900;">(</span>fruit<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#  根据正则表达式检验是否匹配</span><br />str_detect<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"a$"</span><span style="color: #009900;">)</span><br />str_detect<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"[aeiou]"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 找出匹配的字符串位置</span><br />str_locate<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"a"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 提取匹配的部分</span><br />str_extract<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"[a-z]+"</span><span style="color: #009900;">)</span><br />str_match<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"[a-z]+"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 替换匹配的部分</span><br />str_replace<span style="color: #009900;">(</span>fruit<span style="color: #339933;">,</span> <span style="color: blue;">"[aeiou]"</span><span style="color: #339933;">,</span> <span style="color: blue;">"-"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 分割</span><br />str_split<span style="color: #009900;">(</span>res<span style="color: #339933;">,</span> <span style="color: blue;">" "</span><span style="color: #009900;">)</span></span></pre></div></div><br />参考资料：<br /><a href="http://journal.r-project.org/archive/2010-2/RJournal_2010-2_Wickham.pdf">http://journal.r-project.org/archive/2010-2/RJournal_2010-2_Wickham.pdf</a>
