--- 
layout: post
name: r4
title: "\xE7\xAC\xA8\xE5\x8A\x9E\xE6\xB3\x95\xE5\xAD\xA6R\xE7\xBC\x96\xE7\xA8\x8B\xEF\xBC\x884\xEF\xBC\x89"
date: 2012-08-22 08:57:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
- "\xE5\x85\xA5\xE9\x97\xA8\xE6\x95\x99\xE7\xA8\x8B"
permalink: /2012/08/r4.html
---
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-PlYj_3ndqWs/UDQszSAM0RI/AAAAAAAABIw/m-y1rcSXYrc/s1600/1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="269" src="http://2.bp.blogspot.com/-PlYj_3ndqWs/UDQszSAM0RI/AAAAAAAABIw/m-y1rcSXYrc/s320/1.jpg" width="320" /></a></div>看到各位对“笨办法系列”的东西还比较感兴趣，我也很乐意继续写下去。今天的示例将会用到数据框（data.frame）这种数据类型，并学习如何组合计算两个向量，以及如何排序。我们将用所学的东西来解决Project Euler的<a href="http://projecteuler.net/problem=4">第四个问题</a>，就是找出一个集合中最大的回文数。回文数是指一个像1534351这样“对称”的数，如果将这个数的数字按相反的顺序重新排列后，所得到的数和原来的数一样。开始啦！<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># 预备练习</span><br />&nbsp;<br />x &lt;- y &lt;- <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">9</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">(</span>x=x<span style="color: #339933;">,</span>y=y<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">)</span><br />z &lt;- <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$x * <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$y<br /><span style="color: #666666; font-style: italic;"># 一个九九乘法表</span><br />z &lt;- <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">(</span>z<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/ncol"><span style="color: #003399; font-weight: bold;">ncol</span></a>=<span style="color: #cc66cc;">9</span><span style="color: #009900;">)</span><br />&nbsp;<br /><a href="http://inside-r.org/r-doc/base/set.seed"><span style="color: #003399; font-weight: bold;">set.seed</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />x &lt;- <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br />x<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/base/which.min"><span style="color: #003399; font-weight: bold;">which.min</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br />x<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/which.min"><span style="color: #003399; font-weight: bold;">which.min</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #009900;">]</span><br />x<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #009900;">]<a name='more'></a></span>&nbsp;<br />y &lt;- <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">10</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/head"><span style="color: #003399; font-weight: bold;">head</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$x<br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$x<span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Project Euler 4</span><br /><span style="color: #666666; font-style: italic;"># 在两个三位数字的乘积中，找出最大的回文数</span><br /><span style="color: #666666; font-style: italic;"># 先建立一个将数字顺序进行反转的函数</span><br />reverse &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    reversed &lt;- <span style="color: #cc66cc;">0</span><br />    <span style="color: black; font-weight: bold;">while</span> <span style="color: #009900;">(</span>n &gt; <span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        reversed &lt;- <span style="color: #cc66cc;">10</span> * reversed + n %% <span style="color: #cc66cc;">10</span><br />        n &lt;- n%/%10<br />    <span style="color: #009900;">}</span><br />    <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span>reversed<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 从大到小搜索回文数</span></pre><pre class="r geshifilter-R" style="font-family: monospace;"><pre class="r geshifilter-R">x &lt;- y &lt;- <span style="color: #cc66cc;">999</span>:<span style="color: #cc66cc;">100</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">(</span>x=x<span style="color: #339933;">,</span>y=y<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$prod &lt;- <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$x * <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$y<br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$prod<span style="color: #339933;">,</span>decreasing=T<span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/utils/head"><span style="color: #003399; font-weight: bold;">head</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">)</span></pre>value &lt;- <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>$prod <span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>i <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>value<span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>    isequal &lt;- <span style="color: #009900;">(</span>value<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> == reverse<span style="color: #009900;">(</span>value<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>isequal<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>        <a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a><span style="color: #009900;">[</span>i<span style="color: #339933;">,</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>        <span style="color: black; font-weight: bold;">break</span>    <span style="color: #009900;">}</span><span style="color: #009900;">}</span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre></div>得到的结果是906609，本例是先将乘积排序后再判断是否回文数，找到的第一个就是答案，所以速度会快一点。如果不用expand.grid函数的话，可以利用嵌套for来组合计算。另外还有一种作法是利用R本身的rev函数，先将数字转为字符，再切开成一串向量，用rev反转后判断。</div>
