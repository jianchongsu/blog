--- 
layout: post
name: blog-post
title: "\xE8\x81\x8A\xE8\x81\x8A\xE6\x95\xA3\xE7\x82\xB9\xE5\x9B\xBE"
date: 2011-12-02 16:17:00 +08:00
categories: 
- "\xE5\x8F\xAF\xE8\xA7\x86\xE5\x8C\x96"
permalink: /2011/12/blog-post.html
---
散点图很简单，但它无疑是探索数值数据之间关系的有力工具。它有直观简便的优点，通过观察散点图，不但可以得到定性的结论，而且可以通过观察并处理异常数据，提高用于估算相关程度的准确性。在R中实现散点图最简单的函数就是plot，我们首先随机生成两个数据，然后用作散点图<br /><blockquote class="tr_bq">y=rnorm(100)<br />x=rnorm(100)<br />plot(x,y)</blockquote>如果希望从简单的散点图中得到更多信息，我们可以使用car包中的scatterplot函数，散点图增加了单变量的箱线图，线性回归线和局部回归线。此外该函数也可以进行条件绘图。<br /><blockquote class="tr_bq">scatterplot(x,y,spread=F)</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-lkAdnqwXuJ0/TtiJ4ykrESI/AAAAAAAAAj0/Abm5BTtOaqo/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-lkAdnqwXuJ0/TtiJ4ykrESI/AAAAAAAAAj0/Abm5BTtOaqo/s400/Rplot.jpeg" width="400" /></a></div><a name='more'></a><br /><br />如果数据过多，例如10000个随机生成的数据来作散点图，你会发现由于数据过于密集，只产生一坨黑色的东东。<br /><blockquote class="tr_bq">a=rnorm(10000)<br />b=rnorm(10000)<br />plot(a,b)</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-MInkQW_-6mA/TtiKGHg0abI/AAAAAAAAAj8/duGUFNjh2zk/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-MInkQW_-6mA/TtiKGHg0abI/AAAAAAAAAj8/duGUFNjh2zk/s400/Rplot01.jpeg" width="400" /></a></div><br />这时需要改用smoothScatter函数，它会利用密度估计来生成平滑的图形来表示散点图的密集程度，看起来有点意思吧。<br /><blockquote class="tr_bq">smoothScatter(a,b)</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-v0wwe8pgLd8/TtiKPvkySsI/AAAAAAAAAkE/ljyYsp07gDs/s1600/Rplot02.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-v0wwe8pgLd8/TtiKPvkySsI/AAAAAAAAAkE/ljyYsp07gDs/s400/Rplot02.jpeg" width="400" /></a></div><br />如果你掌握了ggplot2扩展包，散点图就更容易了，在处理大量数据时可以利用alpha透明度设置或jitter参数来降低数据的重叠，还可以直接进行LOESS平滑。下面的图形就是mpg数据集的例子，分别对四种不同的汽缸的汽车绘制散点图并拟合。<br /><blockquote class="tr_bq">library(ggplot2)<br />p=ggplot(mpg,aes(displ,hwy))<br />p+geom_point(aes(colour=factor(cyl)),size=3)+geom_smooth(alpha=0.3,aes(fill=factor(cyl)))</blockquote><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-bMTfo8jSwB8/TuwkN5DZRuI/AAAAAAAAAmo/kO8KjTW3aVA/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-bMTfo8jSwB8/TuwkN5DZRuI/AAAAAAAAAmo/kO8KjTW3aVA/s1600/Rplot01.jpeg" /></a></div><br /><br />上述所谈的都是两个变量之间的散点图，如果涉及到多个变量，可能就需要用到散点矩阵图了，当然你可以用最基本的pairs函数生成，但笔者偏爱的是car包中的scatterplotMatrix函数，不仅有局部回归拟合，还有直方图信息。<br /><blockquote class="tr_bq">z=rnorm(100)<br />scatterplotMatrix(~x+y+z,spread=F,diagonal="histogram")</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-wbUC292kcic/TtiKoqUxCCI/AAAAAAAAAkM/v6SPxRTo-LM/s1600/Rplot03.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-wbUC292kcic/TtiKoqUxCCI/AAAAAAAAAkM/v6SPxRTo-LM/s400/Rplot03.jpeg" width="400" /></a></div><br />除此之外，如果还需要绘制三维散点图，可以使用scatterplot3d函数，你可以参看这个<a href="http://xccds1977.blogspot.com/2011/07/blog-post.html" target="_blank">博文</a>。气泡图的话则可以使用symbols函数。
