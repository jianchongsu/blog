--- 
layout: post
name: r
title: "\xE5\x9C\xA8R\xE8\xAF\xAD\xE8\xA8\x80\xE4\xB8\xAD\xE4\xBD\xBF\xE7\x94\xA8\xE8\x87\xAA\xE5\x8A\xA9\xE6\xB3\x95\xE5\x92\x8C\xE7\xBD\xAE\xE6\x8D\xA2\xE6\xA3\x80\xE9\xAA\x8C\xE6\xAF\x94\xE8\xBE\x83\xE4\xB8\xA4\xE6\x80\xBB\xE4\xBD\x93"
date: 2011-06-28 16:01:00 +08:00
categories: 
- "\xE8\x87\xAA\xE5\x8A\xA9\xE6\xB3\x95"
- "\xE7\xBD\xAE\xE6\x8D\xA2\xE6\xA3\x80\xE9\xAA\x8C"
permalink: /2011/06/r.html
---
通常可以使用T检验来比较两个总体均值是否相同，但其前提是总体分布为正态，或者是大样本。在小样本情况下可以使用自助法来判断统计量及其置信区间。<br /><br />下面的算例来自于《A Handbook of Statistical Analyses Using R》，数据中两组样本分别来自两组学生对某个物体尺寸的估计，一组使用公制，另一组使用英制，问题是这两组的估计值是否有明显差别。<br /><br /><b>1 自助法</b><br />自助法对单一的样本以有放回方式进行再抽样，得到自助分布，根据自助分布来推断样本统计量特征。<br /><a name='more'></a><br /><br />#首先读入数据<br />data("roomwidth", package = "HSAUR2")<br />#将单位转化以方便比较数值<br />convert &lt;- ifelse(roomwidth$unit == "feet", 1, 3.28)<br />feet &lt;- roomwidth$unit == "feet"<br />&nbsp;metre &lt;- !feet<br />y &lt;- roomwidth$width * convert<br />#构建两组样本<br />yfeet=y[feet]<br />ymetre=y[metre]<br />#计算两样本之间的差<br />T &lt;- mean(y[feet]) - mean(y[metre])<br />#以自助法估计统计量的样本分布<br />meandiffs &lt;- double(10000)<br />for (i in 1:length(meandiffs)) {<br />&nbsp;syfeet &lt;- sample(yfeet,replace=T)<br />&nbsp;symetre &lt;- sample(ymetre,replace=T)<br />&nbsp;meandiffs[i] &lt;- mean(syfeet) - mean(symetre)<br />}<br />hist(meandiffs)<br />c(mean(meandiffs)-2*sd(meandiffs),mean(meandiffs)+2*sd(meandiffs))<br /><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-5eDVUZ_5qIk/TgmKBFhI3wI/AAAAAAAAARA/X_cunaBqHX4/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="313" src="http://4.bp.blogspot.com/-5eDVUZ_5qIk/TgmKBFhI3wI/AAAAAAAAARA/X_cunaBqHX4/s400/Rplot.jpeg" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">自助分布</td></tr></tbody></table><br />可以看到样本均值差的真实值为-8.85，而自助法计算的样本均值差为-8.89，偏差很小，而且分布近似为正态。因此可以用T值区间来算出总体均值差的95%置信区间为（-16.474445 &nbsp;-1.312966）。其中0不包括在内，可见这两组的估计值有明显差别。<br /><br /><b>2 置换检验</b><br />置换检验的思路在于，以原假设为起点，假定二组没有差别，由此将二组样本合并，从中以无放回方式进行抽样，分别归入两个组再计算统计量，反复进行由此得到置换分布，在此基础上进行推断。<br /><br />meandiffs &lt;- double(1000)<br />for (i in 1:length(meandiffs)) {<br />sy &lt;- sample(y)<br />meandiffs[i] &lt;- mean(sy[feet]) - mean(sy[metre])<br />}<br />quantile(meandiffs,c(0.05,0.95))<br />可以得到检验临界值为-5.805735 &nbsp;5.560368 ，而样本均值差为-8.85，已经超出左侧临界值，所以拒绝原假设，这两组的估计值是否有明显差别。<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-EMoUnEq8k-w/TgmKBSeJfnI/AAAAAAAAARE/rLuaRg2QPXU/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="313" src="http://1.bp.blogspot.com/-EMoUnEq8k-w/TgmKBSeJfnI/AAAAAAAAARE/rLuaRg2QPXU/s400/Rplot01.jpeg" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">置换分布</td></tr></tbody></table><br /><div><br /></div>
