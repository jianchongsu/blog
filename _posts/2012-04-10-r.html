--- 
layout: post
name: r
title: "\xE5\x9C\xA8R\xE4\xB8\xAD\xE6\xA8\xA1\xE6\x8B\x9F\xE5\xAD\x98\xE5\x82\xA8\xE9\x97\xAE\xE9\xA2\x98"
date: 2012-04-10 08:50:00 +08:00
categories: 
- "\xE6\xA8\xA1\xE6\x8B\x9F"
permalink: /2012/04/r.html
---
<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/zQwgTfO8.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://thumbsnap.com/i/zQwgTfO8.jpg" /></a></div>本例来自于《统计模型及其R实现》的例题，但是书上的条件和代码都有些缺漏，所以仍值得在这里说道说道。存储模型是很经典的统计模拟问题，即考虑一个出售某种商品的商店，其销售单价为12元，单位成本为5元。顾客数服从参数为8的Poisson分布，且每个顾客的需求量是一个离散随机变量。店主必须储存一定的商品，当库存不足时，店主就会从发货商处得到补充。使用的订货策略即（s,S）策略，若当前库存x小于s时，则将存货补充到S，即购买S-x个单位商品。每次进货成本为10元，进货延迟时间为2天，单位时间内库存一个商品的成本是0.5元，若需求量大于当前存货，则发生损失。考虑30天之内的时间长度，店主能够决策的变量即是再订货点s和订货数量S。总成本包括了订货成本、存储成本和损失费用，要考虑如何决定这两个变量值，才能使平均收入（总收入除以30天）达到最大？<br /><a name='more'></a><br />解决问题的思路是先建立一个存货函数，输入参数为s和S，输出量为平均收入。然后生成多个输入参数的组合，对每个参数组合运行函数100次得到平均收入的均值。最后观察哪一组参数可以得到最大的平均收入均值。由于这实际上是一个二元函数，所以可以用lattice包中的三维绘图函数得到一个直观的图形，显示如下。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/25mET8jW.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://thumbsnap.com/i/25mET8jW.jpg" width="400" /></a></div>我们也可以使用二维热图来表示这个函数之间的关系，从下图看到显示的蓝色区域越深，即为平均收入较高的参数组合，大致位置在中部偏左下方。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/nI5tgCJ9.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://thumbsnap.com/i/nI5tgCJ9.jpg" width="400" /></a></div>最后我们来看看平均收入前十个的参数组合，以最高的组合为例，即当目前存货低于29时，我们需要将存货补充到57，也就是说订购28个存货。此时我们的平均收入的均值将为55.85元。<br /><br /><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; width: 216px;"> <colgroup><col span="3" style="width: 54pt;" width="72"></col> </colgroup><tbody><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt; width: 54pt;" width="72">再订货点</td>  <td class="xl63" style="width: 54pt;" width="72">订货数量</td>  <td class="xl63" style="width: 54pt;" width="72">平均收入</td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">29</td>  <td class="xl63">57</td>  <td class="xl64">55.85 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">32</td>  <td class="xl63">57</td>  <td class="xl64">55.74 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">29</td>  <td class="xl63">58</td>  <td class="xl64">55.71 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">27</td>  <td class="xl63">52</td>  <td class="xl64">55.41 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">31</td>  <td class="xl63">57</td>  <td class="xl64">55.33 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">30</td>  <td class="xl63">54</td>  <td class="xl64">55.29 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">32</td>  <td class="xl63">61</td>  <td class="xl64">55.29 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">30</td>  <td class="xl63">56</td>  <td class="xl64">55.22 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">35</td>  <td class="xl63">56</td>  <td class="xl64">54.99 </td> </tr><tr height="19" style="height: 14.25pt;">  <td class="xl63" height="19" style="height: 14.25pt;">36</td>  <td class="xl63">56</td>  <td class="xl64">54.97 </td> </tr></tbody></table><br />由于模型的随机性，所以55.85只是期望意义上的平均收入，如果遇到某些极端情况，平均收入会有波动。为了观察这种变异性，我们可以以（29，57）为输入参数，将函数运行1000次，得到1000个平均收入。最后绘制直方图进行观察。可以看到大部分情况下平均收入会在40元到65元左右。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/PL4u5bvl.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://thumbsnap.com/i/PL4u5bvl.jpg" /></a></div>R代码如下：<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/rm"><span style="color: #003399;">rm</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a>=<a href="http://inside-r.org/r-doc/base/ls"><span style="color: #003399;">ls</span></a><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />inventory = <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/mgcv/s"><span style="color: #003399;">s</span></a><span style="color: #339933;">,</span>S<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <span style="color: #666666; font-style: italic;">#x为存货，T为总时长，lambda为需求速率，（s,S）为存货策略</span><br />    <span style="color: #666666; font-style: italic;">#h为单位库存费用,L为订货周期，d为订货费用函数，lose为损失函数</span><br />    <span style="color: #666666; font-style: italic;">#a为需求量，b为相应的概率</span><br />    x=<span style="color: #cc66cc;">4</span><span style="color: #339933;">;</span> L=<span style="color: #cc66cc;">2</span><span style="color: #339933;">;</span> h =<span style="color: #cc66cc;">0.5</span><br />    r=<span style="color: #cc66cc;">12</span><span style="color: #339933;">;</span> a=<span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #339933;">;</span> b=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.7</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0.2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0.08</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0.02</span><span style="color: #009900;">)</span><br />    lambda=<span style="color: #cc66cc;">8</span><span style="color: #339933;">;</span> T=<span style="color: #cc66cc;">30</span><br />    d = <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span> <span style="color: #cc66cc;">10</span>+ <span style="color: #cc66cc;">5</span>*x<br />    lose = <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/D"><span style="color: #003399;">D</span></a><span style="color: #339933;">,</span>x<span style="color: #009900;">)</span> <span style="color: #009900;">(</span>D-x<span style="color: #009900;">)</span>*<span style="color: #cc66cc;">2</span><br />    <span style="color: #666666; font-style: italic;"># t0为下一个顾客到达时间，服从指数分布，t1为订货交付时间</span><br />    <span style="color: #666666; font-style: italic;">#若没有订货则设为Inf，H为累积库存费用，C为累积订货费用，R为收入</span><br />    <span style="color: #666666; font-style: italic;">#y为存货订货量，loss为损失金额，k为计数</span><br />    <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a>=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> t0=<a href="http://inside-r.org/r-doc/stats/rexp"><span style="color: #003399;">rexp</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>lambda<span style="color: #009900;">)</span><br />    t1=Inf<span style="color: #339933;">;</span> H=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> <a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399;">C</span></a>=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> R=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> y=<span style="color: #cc66cc;">0</span><br />    loss=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> k=<span style="color: #cc66cc;">1</span><br />    <span style="color: black;">while</span><span style="color: #009900;">(</span>t0<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span> &lt;= T<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br /><span style="color: #666666; font-style: italic;">#         browser()</span><br />        k = k+<span style="color: #cc66cc;">1</span><br />        <span style="color: black;">if</span> <span style="color: #009900;">(</span>t0<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt; t1<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />            <span style="color: #666666; font-style: italic;">#计算t时到下一个顾客到来时的库存费用</span><br />            H= H + <span style="color: #009900;">(</span>t0<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> - <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a><span style="color: #009900;">)</span> * h*x<br />            <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a> = t0<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />            <span style="color: #666666; font-style: italic;">#D为模拟的顾客需求量，w为购买量</span><br />            <a href="http://inside-r.org/r-doc/stats/D"><span style="color: #003399;">D</span></a> = <a href="http://inside-r.org/r-doc/base/sample"><span style="color: #003399;">sample</span></a><span style="color: #009900;">(</span>a<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/prob">prob</a>=b<span style="color: #009900;">)</span><br />            w = <a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399;">min</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/D"><span style="color: #003399;">D</span></a><span style="color: #339933;">,</span>x<span style="color: #009900;">)</span><br />            <span style="color: #666666; font-style: italic;">#需求大于存货，则发生损失</span><br />            <span style="color: black;">if</span> <span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/D"><span style="color: #003399;">D</span></a> &gt; x<span style="color: #009900;">)</span> <span style="color: #009900;">{</span> loss<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span>=lose<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/D"><span style="color: #003399;">D</span></a><span style="color: #339933;">,</span>x<span style="color: #009900;">)</span> <span style="color: #009900;">}</span><br />            <span style="color: black;">else</span> <span style="color: #009900;">{</span>loss<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> =<span style="color: #cc66cc;">0</span> <span style="color: #009900;">}</span><br />            <span style="color: #666666; font-style: italic;"># 计算收入并更新存货</span><br />            R = R + w*r<span style="color: #339933;">;</span> x=x-w<br />            <span style="color: #666666; font-style: italic;"># 若存货不足则进行订货补充，到货时间为t1。</span><br />            <span style="color: black;">if</span><span style="color: #009900;">(</span>x &lt;s &amp; y==<span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />                y = S-x<span style="color: #339933;">;</span> t1<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span> = <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a> +L<br />            <span style="color: #009900;">}</span> <span style="color: black;">else</span> <span style="color: #009900;">{</span> t1<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span>= t1<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">}</span><br />           <span style="color: #666666; font-style: italic;"># 模拟新的顾客需求</span><br />            t0<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span>=<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a>+<a href="http://inside-r.org/r-doc/stats/rexp"><span style="color: #003399;">rexp</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>lambda<span style="color: #009900;">)</span><br />            loss<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span> =<span style="color: #cc66cc;">0</span><br />            <span style="color: #666666; font-style: italic;"># 若新的存货比需求先到达，则计算订货成本并更新存货</span><br />        <span style="color: #009900;">}</span> <span style="color: black;">else</span> <span style="color: #009900;">{</span><br />            H= H + <span style="color: #009900;">(</span>t1<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span>-<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a><span style="color: #009900;">)</span>*h*x<br />            <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399;">t</span></a>=t1<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />            <a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399;">C</span></a>=<a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399;">C</span></a>+d<span style="color: #009900;">(</span>y<span style="color: #009900;">)</span><span style="color: #339933;">;</span> x=x+y<br />            y=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>t1<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span>= Inf<span style="color: #339933;">;</span> loss<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span>=<span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span> t0<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span>= t0<span style="color: #009900;">[</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />        <span style="color: #009900;">}</span><br />    <span style="color: #009900;">}</span><br />    <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>R-H-C-<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>loss<span style="color: #009900;">)</span><span style="color: #009900;">)</span>/T<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/lattice">lattice</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/mgcv/s"><span style="color: #003399;">s</span></a> &lt;- <span style="color: #cc66cc;">20</span>:<span style="color: #cc66cc;">50</span><br />S &lt;- <span style="color: #cc66cc;">40</span>:<span style="color: #cc66cc;">70</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399;">expand.grid</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/mgcv/s"><span style="color: #003399;">s</span></a><span style="color: #339933;">,</span>S<span style="color: #009900;">)</span><br /><span style="color: black;">for</span> <span style="color: #009900;">(</span>i <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">900</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$mean<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> &lt;- <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399;">mean</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span>inventory<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$Var1<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$Var2<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br /><a href="http://inside-r.org/r-doc/lattice/wireframe"><span style="color: #003399;">wireframe</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399;">mean</span></a> ~ Var1 * Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> = <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span><br />          scales = <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399;">arrows</span></a> = <span style="color: black;">FALSE</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>xlab = <span style="color: blue;">"再订货点"</span><span style="color: #339933;">,</span><br />          ylab = <span style="color: blue;">"订货数量"</span><span style="color: #339933;">,</span> zlab=<span style="color: blue;">'平均收入'</span><span style="color: #339933;">,</span><br />          drape = <span style="color: black;">TRUE</span><span style="color: #339933;">,</span> colorkey = <span style="color: black;">TRUE</span><span style="color: #339933;">,</span><br />          <a href="http://inside-r.org/r-doc/graphics/screen"><span style="color: #003399;">screen</span></a> = <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span>z = <span style="color: #cc66cc;">120</span><span style="color: #339933;">,</span> x = -<span style="color: #cc66cc;">60</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/lattice/levelplot"><span style="color: #003399;">levelplot</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399;">mean</span></a> ~ Var1 * Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> = <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>xlab = <span style="color: blue;">"再订货点"</span><span style="color: #339933;">,</span><br />          ylab = <span style="color: blue;">"订货数量"</span><span style="color: #009900;">)</span><br />&nbsp;<br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399;">order</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$mean<span style="color: #339933;">,</span>decreasing=T<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">10</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><br />&nbsp;<br />result &lt;- <a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399;">replicate</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span>inventory<span style="color: #009900;">(</span><span style="color: #cc66cc;">29</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">57</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x=result<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />p+geom_histogram<span style="color: #009900;">(</span>colour = <span style="color: blue;">"darkgreen"</span><span style="color: #339933;">,</span> fill = <span style="color: blue;">"white"</span><span style="color: #339933;">,</span><br />                    aes<span style="color: #009900;">(</span>y = ..density..<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br />                    stat_density<span style="color: #009900;">(</span>geom = <span style="color: blue;">'line'</span><span style="color: #339933;">,</span>colour=<span style="color: blue;">'red4'</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span></span></pre><pre class="r geshifilter-R"><span style="font-family: Simsun; white-space: normal;"><b><span style="color: #666666;">《统计模型及其R实现》一书可以下载了</span></b></span><br /></pre></div></div>
