--- 
layout: post
name: jeremy-lintwitter
title: "\xE5\x85\xB3\xE4\xBA\x8EJeremy Lin\xE7\x9A\x84twitter\xE8\xAF\x8D\xE4\xBA\x91"
date: 2012-02-19 13:53:00 +08:00
categories: 
- twitter
permalink: /2012/02/jeremy-lintwitter.html
---
<div class="separator" style="clear: both; text-align: center;"></div>标签云或词云<b>(word cloud)</b>是关键词的视觉化描述，用于汇总用户生成的标签或一个网站的文字内容。word cloud实际上是将文档包含的词汇频率表进行了可视化。这些词汇的重要程度主要通过改变字体大小或颜色来表现。这项技术常用于具体化、形象化一些热门话题或文本内容。好吧，闲话少说，趁着Jeremy Lin的热度尚在，我们来看看在推特上人们谈到他的时候会提到哪些关键的词汇。<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/6pt7E93u.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://thumbsnap.com/i/6pt7E93u.jpg" /></a></div><a name='more'></a><br />看看上面的词云图吧。恩...所属的knicks队名出现频率高是应该的，网络上流传的外号linsanity真得是很热啊，还有不少将他和kobe bryant相比较。剩下的各位慢慢研究吧。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><b>R代码：</b></pre><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;">#载入用到的包</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/twitteR">twitteR</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/tm">tm</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span>wordcloud<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#设定搜索标签，提取1000个推文并转化为数据框</span><br />searchTerm = <span style="color: blue;">'#Jeremy Lin'</span><br />raw.data &lt;- searchTwitter<span style="color: #009900;">(</span>searchTerm<span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">1000</span><span style="color: #009900;">)</span><br />tw.df &lt;- twListToDF<span style="color: #009900;">(</span>raw.data<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#为了回避一些推文中的网址，用文本函数gsub加以去除</span><br />Remove &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>tweet<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399;">gsub</span></a><span style="color: #009900;">(</span><span style="color: blue;">"http+"</span><span style="color: #339933;">,</span> <span style="color: blue;">""</span><span style="color: #339933;">,</span> tweet<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />tweets &lt;- <a href="http://inside-r.org/r-doc/base/as.vector"><span style="color: #003399;">as.vector</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399;">sapply</span></a><span style="color: #009900;">(</span>tw.df$text<span style="color: #339933;">,</span> Remove<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#用tm包中的Corpus读取文本并生成语料库对象，再对其进行预处理</span><br />tw.corpus &lt;- Corpus<span style="color: #009900;">(</span>VectorSource<span style="color: #009900;">(</span>tweets<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />tw.corpus &lt;- tm_map<span style="color: #009900;">(</span>tw.corpus<span style="color: #339933;">,</span> stripWhitespace<span style="color: #009900;">)</span><br />tw.corpus &lt;- tm_map<span style="color: #009900;">(</span>tw.corpus<span style="color: #339933;">,</span> removePunctuation<span style="color: #009900;">)</span><br />tw.corpus &lt;- tm_map<span style="color: #009900;">(</span>tw.corpus<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/tolower"><span style="color: #003399;">tolower</span></a><span style="color: #009900;">)</span><br />tw.corpus &lt;- tm_map<span style="color: #009900;">(</span>tw.corpus<span style="color: #339933;">,</span>removeWords<span style="color: #339933;">,</span>stopwords<span style="color: #009900;">(</span><span style="color: blue;">'english'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#生成词频矩阵</span><br />doc.matrix &lt;- TermDocumentMatrix<span style="color: #009900;">(</span>tw.corpus<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/boot/control"><span style="color: #003399;">control</span></a> = <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span>minWordLength = <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />dm &lt;- <a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399;">as.matrix</span></a><span style="color: #009900;">(</span>doc.matrix<span style="color: #009900;">)</span><br />v &lt;- <a href="http://inside-r.org/r-doc/base/sort"><span style="color: #003399;">sort</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rowSums"><span style="color: #003399;">rowSums</span></a><span style="color: #009900;">(</span>dm<span style="color: #009900;">)</span><span style="color: #339933;">,</span>decreasing=T<span style="color: #009900;">)</span><br />d &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>word=<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span>v<span style="color: #009900;">)</span><span style="color: #339933;">,</span>freq=v<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;">#去除Jeremy和Lin这两个词后，生成最后的词云</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- d<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>-<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>-<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><br />mycolors &lt;- <a href="http://inside-r.org/r-doc/grDevices/colorRampPalette"><span style="color: #003399;">colorRampPalette</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"white"</span><span style="color: #339933;">,</span><span style="color: blue;">"red"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">(</span><span style="color: #cc66cc;">200</span><span style="color: #009900;">)</span><br />wc &lt;-wordcloud<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$word<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>$freq<span style="color: #339933;">,</span>min.freq=<span style="color: #cc66cc;">15</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/grDevices/colors"><span style="color: #003399;">colors</span></a>=mycolors<span style="color: #009900;">[</span><span style="color: #cc66cc;">100</span>:<span style="color: #cc66cc;">200</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></span></pre></div></div><br />
