--- 
layout: post
name: logisticr
title: "\xE7\xB2\xBE\xE7\xA1\xAELogistic\xE5\x9B\x9E\xE5\xBD\x92\xE7\x9A\x84R\xE8\xAF\xAD\xE8\xA8\x80\xE5\xAE\x9E\xE7\x8E\xB0"
date: 2011-10-14 21:07:00 +08:00
categories: 
- "logistic\xE5\x9B\x9E\xE5\xBD\x92"
permalink: /2011/10/logisticr.html
---
Logistic回归（logistic regression）属于概率型非线性回归，是分析反应变量为独立分类资料的常用统计分析方法，由于对资料的正态性和方差齐性不做要求、对自变量类型也不做要求等，使得Logistic回归模型在医学研究各个领域被广泛用。Logistic回归的基本方法是极大似然方法，其前提是样本较大。但在样本量较小、数据结构较偏时，其结果会不可靠甚至无法求解。<br /><br />精确Logistic回归（Exact logistic regression）则可以用来解决这一问题，该方法通过建立条件似然函数，进一步求出参数的充分统计量的分布函数。随着计算方法的发展和优化，也出现了使用马尔可夫链蒙特卡罗算法来模拟精确Logistic回归。R语言中的elrm包就可以实现这种算法。<br /><a name='more'></a><br /><br />本例用到的数据来自elrm包的drugDat数据<br /><br />sex treatment recovered &nbsp;n<br />1 &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp;16 27<br />3 &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp;13 32<br />2 &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp; &nbsp; &nbsp; &nbsp;10 19<br />4 &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; 7 21<br /><br /><pre class="GD40030CLR" style="border-bottom-style: none; border-color: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; font-family: 'Lucida Console'; font-size: 10pt !important; line-height: 1.3; outline-color: initial; outline-style: none; outline-width: initial; white-space: pre-wrap !important;" tabindex="0"></pre>使用elrm命令建立精确Logistic回归模型<br /><blockquote>drug.elrm=elrm(formula=recovered/n~sex+treatment,interest=~sex+treatment,iter=100000,burnIn=1000,dataset=drugDat)</blockquote>结果显示如下：<br /><span class="Apple-style-span" style="-webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; border-collapse: separate; font-family: Arial;"><span class="Apple-style-span" style="font-family: 'Lucida Console'; font-size: 13px; line-height: 17px; text-align: -webkit-left; white-space: pre-wrap;"></span></span><br /><pre class="GD40030CLR" style="border-bottom-style: none; border-color: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; font-family: 'Lucida Console'; font-size: 10pt !important; line-height: 1.3; outline-color: initial; outline-style: none; outline-width: initial; white-space: pre-wrap !important;" tabindex="0">Results:<br />          estimate p-value p-value_se mc_size<br />joint           NA 0.13083    0.00183   99000<br />sex        0.25511 0.52727    0.00954    2860<br />treatment  0.84871 0.07439    0.00296   13389<br /><br />95% Confidence Intervals for Parameters<br /><br />               lower    upper<br />sex       -0.6382327 1.129768<br />treatment -0.1096254 2.129493</pre><br />
