--- 
layout: post
name: blog-post
title: "\xE7\x94\xA8\xE5\x9B\xBE\xE5\xBD\xA2\xE5\x92\x8C\xE9\xA2\x9C\xE8\x89\xB2\xE6\x9D\xA5\xE8\xA1\xA8\xE7\x8E\xB0\xE7\x9B\xB8\xE5\x85\xB3\xE5\x85\xB3\xE7\xB3\xBB"
date: 2012-02-10 13:18:00 +08:00
categories: 
- "\xE7\xBB\x98\xE5\x9B\xBE"
- "\xE5\x8F\xAF\xE8\xA7\x86\xE5\x8C\x96"
permalink: /2012/02/blog-post.html
---
进行数据分析建模首先要了解变量间的关系。对于连续数据来说，散点图可能是最为有效的一种工具。散点图通常对两组连续数据比较合适，如果是多元数据，那么可以使用散点图矩阵（ScatterMatrix）来两两展示数据相关关系。<br /><br />R语言中包含了各种不同版本的散点图函数，魏太云在<a href="http://cos.name/2009/03/scatterplot-matrix-visualization/">这篇文章</a>里就对这些函数进行了讲解举例，如果需要更完整的文档，可以参考R官方站的一份关于多元数据可视化的<a href="http://cran.r-project.org/web/views/Multivariate.html">资料</a>。还可参考笔者之前的<a href="http://xccds1977.blogspot.com/2011/12/blog-post.html">博文</a>。但我们在这里希望用图形和颜色来表现这种相关关系，而非散点图矩阵。用到的R语言包是corrgram包和ellipse包。<br /><a name='more'></a><br /><br />首先我们载入DMwR包以利用其中的algae数据集。抽取其中的一部分连续数据作为研究对象。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span>DMwR<span style="color: #009900;">)</span><br /><span style="color: #003399;"><a href="http://inside-r.org/r-doc/utils/data">data</a> &lt;- </span>algae<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span>:<span style="color: #cc66cc;">11</span><span style="color: #009900;">]</span><br /><span style="color: #003399;"><br /></span></span></pre></div></div>然后用corrgram函数来绘图，其中用order参数进行了相关系数排序，相关系数阵是对称的，下半部分用颜色的深浅表现相关程度，蓝色为正相关，红色为负相关，上半部分则是用饼图的扇形来表现这种关系。<br /><br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/corrgram">corrgram</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/packages/cran/corrgram">corrgram</a><span style="color: #009900;">(</span><span style="color: #003399;"><a href="http://inside-r.org/r-doc/base/order">order</a> </span>= T<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">, </span>lower.panel = panel.shade<span style="color: #339933;">, </span>upper.panel = panel.pie<span style="color: #009900;">)</span><span style="color: #003399;"><br /></span></span></pre><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-32IRGKpwpd0/TzSk-R6GAGI/AAAAAAAAAtU/Ph8urUmR9BQ/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-32IRGKpwpd0/TzSk-R6GAGI/AAAAAAAAAtU/Ph8urUmR9BQ/s1600/Rplot01.jpeg" /></a></div><br />另一种方法是用ellipse包绘制相关图，要略为复杂一点，它也是rattle包在进行数据挖掘时的默认图形。加载包之后要先生成相关系数矩阵，再进行排序生成一个新的相关系数阵。然后构建包括了13种颜色的色彩库。最后用plotcorr绘图，6*corr + 7实际上是将0-1的数值映射到1-13。将其作为索引从色彩库mycolors中调取颜色。<br /><br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ellipse">ellipse</a><span style="color: #009900;">)</span><br />corr.data &lt;- <a href="http://inside-r.org/r-doc/stats/cor"><span style="color: #003399;">cor</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>use = <span style="color: blue;">'complete.obs'</span><span style="color: #009900;">)</span><br />corr.ord &lt;- <a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399;">order</span></a><span style="color: #009900;">(</span>corr.data<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/boot/corr"><span style="color: #003399;">corr</span></a> &lt;- corr.data<span style="color: #009900;">[</span>corr.ord<span style="color: #339933;">,</span>corr.ord<span style="color: #009900;">]</span><br />mycolors &lt;- <a href="http://inside-r.org/r-doc/grDevices/colorRampPalette"><span style="color: #003399;">colorRampPalette</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"red"</span><span style="color: #339933;">,</span> <span style="color: blue;">"white"</span><span style="color: #339933;">,</span> <span style="color: blue;">"blue"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">(</span><span style="color: #cc66cc;">13</span><span style="color: #009900;">)</span><br />plotcorr<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/boot/corr"><span style="color: #003399;">corr</span></a><span style="color: #339933;">,</span><span style="color: #003399;"><a href="http://inside-r.org/r-doc/base/col">col</a> </span>= mycolors<span style="color: #009900;">[</span><span style="color: #cc66cc;">6</span>*<a href="http://inside-r.org/r-doc/boot/corr"><span style="color: #003399;">corr</span></a> + <span style="color: #cc66cc;">7</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></span><a href="http://4.bp.blogspot.com/-meI7s012wc8/TzSnbnMrX2I/AAAAAAAAAtc/djYxYq1OXB4/s1600/Rplot02.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-meI7s012wc8/TzSnbnMrX2I/AAAAAAAAAtc/djYxYq1OXB4/s1600/Rplot02.jpeg" /></a></pre><br /><br />
