--- 
layout: post
name: r_22
title: "R\xE8\xAF\xAD\xE8\xA8\x80\xE5\xA4\x9A\xE5\x85\x83\xE5\x88\x86\xE6\x9E\x90\xE7\xB3\xBB\xE5\x88\x97\xE4\xB9\x8B\xE4\xB8\x89\xEF\xBC\x9A\xE5\xA4\x9A\xE7\xBB\xB4\xE6\xA0\x87\xE5\xBA\xA6\xE5\x88\x86\xE6\x9E\x90"
date: 2011-12-22 21:10:00 +08:00
categories: 
- "\xE5\xA4\x9A\xE5\x85\x83\xE5\x88\x86\xE6\x9E\x90"
permalink: /2011/12/r_22.html
---
<b>多维标度分析(MDS)</b>是一种将多维空间的研究对象简化到低维空间进行定位、分析和归类，同时又保留对象间原始关系的数据分析方法。<br /><br />设想一下如果我们在欧氏空间中已知一些点的座标，由此可以求出欧氏距离。那么反过来，已知距离应该也能得到这些点之间的关系。这种距离可以是古典的欧氏距离，也可以是广义上的“距离”。MDS就是在尽量保持这种高维度“距离”的同时，将数据在低维度上展现出来。从这种意义上来讲，主成分分析也是多维标度分析的一个特例。<br /><a name='more'></a><br /><br /><b><span style="font-size: large;">一、距离的度量</span></b><br />多元分析中常用有以下几种距离，即绝对值距离、欧氏距离(euclidean)、马氏距离(manhattan)、 两项距离(binary)、明氏距离(minkowski)。在R中通常使用disk函数得到样本之间的距离。MDS就是对距离矩阵进行分析，以展现并解释数据的内在结构。<br /><br />在经典MDS中，距离是数值数据表示，将其看作是欧氏距离。在R中stats包的cmdscale函数实现了经典MDS。它是根据各点的欧氏距离，在低维空间中寻找各点座标，而尽量保持距离不变。<br /><br />非度量MDS方法中，“距离"不再看作数值数据，而只是顺序数据。例如在心理学实验中，受试者只能回答非常同意、同意、不同意、非常不同意这几种答案。在这种情况下，经典MDS不再有效。Kruskal在1964年提出了一种算法来解决这个问题。在R中MASS包的isoMDS函数可以实现这种算法，另一种流行的算法是由sammon函数实现的。<br /><b><span style="font-size: large;">二、经典MDS</span></b><br />下面我们以HSAUR2包中的watervoles数据来举例。该数据是一个相似矩阵，表示了不同地区水田鼠的相似程度。首先加载数据然后用cmdscales进行分析。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">(</span>watervoles<span style="color: #339933;">,</span> package = <span style="color: blue;">"HSAUR2"</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">(</span>watervoles<span style="color: #009900;">)</span><br />voles.mds=<a href="http://inside-r.org/r-doc/stats/cmdscale"><span style="color: #003399;">cmdscale</span></a><span style="color: #009900;">(</span>watervoles<span style="color: #339933;">,</span>k=<span style="color: #cc66cc;">13</span><span style="color: #339933;">,</span>eig=T<span style="color: #009900;">)</span></span></pre><pre class="r geshifilter-R" style="font-family: monospace;">下面计算前两个特征值在所有特征值中的比例，这是为了检测能否用两个维度的距离来表示高维空间中距离，如果达到了0.8左右则表示是合适的。<br /></pre></div></div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/abs"><span style="color: #003399;">abs</span></a><span style="color: #009900;">(</span>voles.mds$eig<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>/sum<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/abs"><span style="color: #003399;">abs</span></a><span style="color: #009900;">(</span>voles.mds$eig<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>voles.mds$eig<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span>/sum<span style="color: #009900;">(</span><span style="color: #009900;">(</span>voles.mds$eig<span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span></span></pre>然后从结果中提取前两个维度的座标，用ggplot包进行绘图。 <br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;">x = voles.mds$points<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />y = voles.mds$points<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br />p=<a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">)</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>label = <a href="http://inside-r.org/r-doc/base/colnames"><span style="color: #003399;">colnames</span></a><span style="color: #009900;">(</span>watervoles<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />p+geom_point<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/shape">shape</a>=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span>colour=<span style="color: blue;">'red'</span><span style="color: #009900;">)</span>+<br />  geom_text<span style="color: #009900;">(</span>hjust=-<span style="color: #cc66cc;">0.1</span><span style="color: #339933;">,</span>vjust=<span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span>alpha=<span style="color: #cc66cc;">0.5</span><span style="color: #009900;">)</span></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-wK4BdUYA6pI/TvMrUwuKxPI/AAAAAAAAAoQ/w7FA7wHagSs/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-wK4BdUYA6pI/TvMrUwuKxPI/AAAAAAAAAoQ/w7FA7wHagSs/s1600/Rplot01.jpeg" /></a></div><pre class="r geshifilter-R"><span style="color: #009900;"><br /></span></pre><br /><b><span style="font-size: large;">三、非度量MDS</span></b><br />第二例子中的数据是关于新泽西州议员投票行为的相似矩阵，这里我们用MASS包中的isoMDS函数进行分析<br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><span style="color: blue;">"MASS"</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">(</span>voting<span style="color: #339933;">,</span> package = <span style="color: blue;">"HSAUR2"</span><span style="color: #009900;">)</span><br />voting_mds = <a href="http://inside-r.org/r-doc/MASS/isoMDS"><span style="color: #003399;">isoMDS</span></a><span style="color: #009900;">(</span>voting<span style="color: #009900;">)</span><br />x = voting_mds$points<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />y = voting_mds$points<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><br />g=<a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">)</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>label = <a href="http://inside-r.org/r-doc/base/colnames"><span style="color: #003399;">colnames</span></a><span style="color: #009900;">(</span>voting<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />g+geom_point<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/shape">shape</a>=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span>colour=<span style="color: blue;">'red'</span><span style="color: #009900;">)</span>+<br />  geom_text<span style="color: #009900;">(</span>hjust=-<span style="color: #cc66cc;">0.1</span><span style="color: #339933;">,</span>vjust=<span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span>alpha=<span style="color: #cc66cc;">0.5</span><span style="color: #009900;">)</span></span></pre><br /><span style="color: #999999;">参考资料：</span><br /><span style="color: #999999;">A Handbook of Statistical Analyses Using R</span><br /><span style="color: #999999;">多元统计分析及R语言建模</span>
