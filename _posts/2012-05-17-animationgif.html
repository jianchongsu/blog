--- 
layout: post
name: animationgif
title: "\xE5\xB0\x9D\xE8\xAF\x95\xE7\x94\xA8animation\xE5\x8C\x85\xE6\x9D\xA5\xE7\x8E\xA9GIF\xE5\x8A\xA8\xE7\x94\xBB"
date: 2012-05-17 08:59:00 +08:00
categories: 
- "\xE7\xBB\x98\xE5\x9B\xBE"
- "\xE5\x8A\xA8\xE7\x94\xBB"
permalink: /2012/05/animationgif.html
---
<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-7BThbwYSYyY/T7RLnoxP67I/AAAAAAAAA6A/0oi4ykmp4Rw/s1600/animation3.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-7BThbwYSYyY/T7RLnoxP67I/AAAAAAAAA6A/0oi4ykmp4Rw/s1600/animation3.gif" /></a></div>谢益辉创建的这个<b>animation包</b>实在是很好玩，上面这个GIF动画就是用lattic包绘制的静态图形构建的。要在R里面玩动画除了要安装animation包之外，还需要安装配套软件。例如安装ImageMagick，以方便生成GIF文件。动画生成原理很简单，基本上就是在saveGIF里面嵌套一些循环绘图的代码，但要注意的是：对于lattice或是ggplot2绘图命令，最后一定要使用print，不然出不了图。另外要在设置参数里面写清楚ImageMagick的安装路径。<br /><a name='more'></a><br /><a href="http://inside-r.org/r-doc/base/library" style="font-family: 'Courier New', Courier, monospace;"><span style="color: #003399;">library</span></a><span style="color: #009900; font-family: 'Courier New', Courier, monospace;">(</span><a href="http://inside-r.org/packages/cran/animation" style="font-family: 'Courier New', Courier, monospace;">animation</a><span style="color: #009900; font-family: 'Courier New', Courier, monospace;">)</span><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/lattice">lattice</a><span style="color: #009900;">)</span><br />&nbsp;saveGIF<span style="color: #009900;">(</span><span style="color: #009900;">{</span><br />    ani.options<span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/interval">interval</a>=<span style="color: #cc66cc;">.1</span><span style="color: #339933;">,</span><br />                convert = <a href="http://inside-r.org/r-doc/base/shQuote"><span style="color: #003399;">shQuote</span></a><span style="color: #009900;">(</span><span style="color: blue;">'d:/program files/ImageMagick-6.7.6-Q16/convert.exe'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br />    <span style="color: black;">for</span> <span style="color: #009900;">(</span>i <span style="color: black;">in</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399;">seq</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">360</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399;">by</span></a>=<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        p &lt;- <a href="http://inside-r.org/r-doc/lattice/wireframe"><span style="color: #003399;">wireframe</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/volcano"><span style="color: #003399;">volcano</span></a><span style="color: #339933;">,</span> shade = <span style="color: black;">TRUE</span><span style="color: #339933;">,</span><br />                  <a href="http://inside-r.org/packages/cran/aspect">aspect</a> = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">61</span>/<span style="color: #cc66cc;">87</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.4</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />                  light.source = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />                  <a href="http://inside-r.org/r-doc/graphics/screen"><span style="color: #003399;">screen</span></a> = <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span>z = i<span style="color: #339933;">,</span> x = -<span style="color: #cc66cc;">60</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <br />    <a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399;">print</span></a><span style="color: #009900;">(</span>p<span style="color: #009900;">)</span><br />        <span style="color: #009900;">}</span><br /><span style="color: #009900;">}</span><span style="color: #009900;">)</span></span></pre></div></div>下面一张动画是模拟森林火灾。首先在森林中心点燃一棵树，然后周围的树会以一定的概率被影响到，最后烧过的树以灰色表示。挺好玩的模型。该模型的原始代码可以从《Introduction to Scientific Programming and Simulation Using R》一书中找到。我只不过修改了一下颜色并生成了动画。最后的代码可以<a href="https://gist.github.com/2715287">看这里</a>。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-JWCbqRcKA6Q/T7RLIf2spGI/AAAAAAAAA54/qp9IYxnkrwQ/s1600/animation.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-JWCbqRcKA6Q/T7RLIf2spGI/AAAAAAAAA54/qp9IYxnkrwQ/s1600/animation.gif" /></a></div><br />最多好玩的动画可以从作者的<a href="http://animation.yihui.name/">官方网站</a>找到。
