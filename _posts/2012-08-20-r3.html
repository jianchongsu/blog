--- 
layout: post
name: r3
title: "\xE7\xAC\xA8\xE5\x8A\x9E\xE6\xB3\x95\xE5\xAD\xA6R\xE7\xBC\x96\xE7\xA8\x8B\xEF\xBC\x883\xEF\xBC\x89"
date: 2012-08-20 09:48:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
- "\xE5\x85\xA5\xE9\x97\xA8\xE6\x95\x99\xE7\xA8\x8B"
permalink: /2012/08/r3.html
---
<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-3l2B39_wLrg/UDGVgn4M3DI/AAAAAAAABIU/GI3xhPQPOBU/s1600/Prime_Numbers.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="266" src="http://4.bp.blogspot.com/-3l2B39_wLrg/UDGVgn4M3DI/AAAAAAAABIU/GI3xhPQPOBU/s320/Prime_Numbers.jpg" width="320" /></a></div>经历了前面两个小挑战，你应该对R有点理解了。我们继续推进，今天的问题有点点复杂，复杂的不是R，而是一个数学概念：质数和质因子。任何一个合数都可以被几个质数所分解，这个<a href="http://en.wikipedia.org/wiki/Prime_factor">性质</a>很重要，我们将用它来解决Project Euler的<a href="http://projecteuler.net/problem=3">第三个问题</a>。还是和之前一样的，你需要自己在R控制台中敲打下面这些命令，根据结果自行揣摩其用处。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># 预备练习，学习for循环、建立自定义函数和其它一些函数</span><br />&nbsp;<br /><span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>n <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">(</span>n<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />x &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">'hello'</span><span style="color: #339933;">,</span><span style="color: blue;">'world'</span><span style="color: #339933;">,</span><span style="color: blue;">'I'</span><span style="color: #339933;">,</span><span style="color: blue;">'love'</span><span style="color: #339933;">,</span><span style="color: blue;">'R'</span><span style="color: #009900;">)</span><br /><span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>n <span style="color: black; font-weight: bold;">in</span> x<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>n<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br /><a name='more'></a><br />x &lt;- <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span>from=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>to=<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br />x &lt;- <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span>from=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>to=<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br />x &lt;- <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span>from=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>to=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>length.out=<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span> <br />x &gt; <span style="color: #cc66cc;">1.5</span><br /><a href="http://inside-r.org/r-doc/base/all"><span style="color: #003399; font-weight: bold;">all</span></a><span style="color: #009900;">(</span>x&gt;<span style="color: #cc66cc;">1.5</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/any"><span style="color: #003399; font-weight: bold;">any</span></a><span style="color: #009900;">(</span>x&gt;<span style="color: #cc66cc;">1.5</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 如何自定义一个求圆面积的函数</span><br />myfunc &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>r<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/MASS/area"><span style="color: #003399; font-weight: bold;">area</span></a> &lt;- <span style="color: black; font-weight: bold;">pi</span>*r^<span style="color: #cc66cc;">2</span><br />    <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/MASS/area"><span style="color: #003399; font-weight: bold;">area</span></a><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>myfunc<span style="color: #009900;">(</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 同时求四个不同半径圆的面积</span><br />r &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">(</span>X=r<span style="color: #339933;">,</span>FUN=myfunc<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Project Euler 3</span><br /><span style="color: #666666; font-style: italic;"># 找到600851475143这个数的最大质因子</span><br /><span style="color: #666666; font-style: italic;"># 先建立一个函数以判断某个数是否为质数</span><br />&nbsp;<br />findprime  &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>x %in% <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">7</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><span style="color: black; font-weight: bold;">TRUE</span><span style="color: #009900;">)</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>x%%2 == <span style="color: #cc66cc;">0</span> | x==<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span><br />    xsqrt &lt;- <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    xseq &lt;- <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span>from=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span>to=xsqrt<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/all"><span style="color: #003399; font-weight: bold;">all</span></a><span style="color: #009900;">(</span>x %% xseq !=<span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><span style="color: black; font-weight: bold;">TRUE</span><span style="color: #009900;">)</span><br />    <span style="color: black; font-weight: bold;">else</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><span style="color: black; font-weight: bold;">FALSE</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br /><span style="color: #666666; font-style: italic;"># 列出1到100的质数，看函数对不对</span><br />x = <span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">100</span><br />x<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>findprime<span style="color: #009900;">)</span><span style="color: #009900;">]</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 寻找最大的质因子</span><br />n &lt;- <span style="color: #cc66cc;">600851475143</span><br /><span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>i <span style="color: black; font-weight: bold;">in</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">(</span>from=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> to=<a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">(</span>n<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/by"><span style="color: #003399; font-weight: bold;">by</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>findprime<span style="color: #009900;">(</span>i<span style="color: #009900;">)</span> &amp; n %% i == <span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />      n &lt;- n / i<br />      prime.factor &lt;- i       <br />      <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>i &gt;= n<span style="color: #009900;">)</span><br />        <span style="color: black; font-weight: bold;">break</span><br />    <span style="color: #009900;">}</span><br /><span style="color: #009900;">}</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>prime.factor<span style="color: #009900;">)</span></pre></div></div><br />最后的结果是6857。本例中除了使用for循环外，还见到了sapply函数，这是R语言中非常重要的一类向量化计算函数。求质数的方法可以参考<a href="http://blog.csdn.net/program_think/article/details/7032600">这个文章</a>，本例使用的是其中的境界4。实际上根据质因子的性质，本例不一定非要建立判断质数的函数，不过这个函数我们在后面会用到的。另外如果你想用其它软件找这个数字的质因子，也可以看看<a href="http://www.wolframalpha.com/input/?i=FactorInteger%28600851475143%29&amp;dataset=&amp;equal=Submit">这里</a>。
