--- 
layout: post
name: r_27
title: "R\xE8\xAF\xAD\xE8\xA8\x80\xE5\xA4\x9A\xE5\x85\x83\xE5\x88\x86\xE6\x9E\x90\xE7\xB3\xBB\xE5\x88\x97\xE4\xB9\x8B\xE5\x9B\x9B\xEF\xBC\x9A\xE5\x88\xA4\xE5\x88\xAB\xE5\x88\x86\xE6\x9E\x90"
date: 2011-12-27 21:34:00 +08:00
categories: 
- "\xE5\xA4\x9A\xE5\x85\x83\xE5\x88\x86\xE6\x9E\x90"
permalink: /2011/12/r_27.html
---
<div><b>判别分析（discriminant analysis）</b>是一种分类技术。它通过一个已知类别的“训练样本”来建立判别准则，并通过预测变量来为未知类别的数据进行分类。</div><div><br /></div><div>判别分析的方法大体上有三类，即Fisher判别、Bayes判别和距离判别。Fisher判别思想是投影降维，使多维问题简化为一维问题来处理。选择一个适当的投影轴,使所有的样品点都投影到这个轴上得到一个投影值。对这个投影轴的方向的要求是：使每一组内的投影值所形成的组内离差尽可能小，而不同组间的投影值所形成的类间离差尽可能大。Bayes判别思想是根据先验概率求出后验概率，并依据后验概率分布作出统计推断。距离判别思想是根据已知分类的数据计算各类别的重心，对未知分类的数据，计算它与各类重心的距离，与某个重心距离最近则归于该类。<br /><a name='more'></a></div><div><br /></div><div><b><span style="font-size: large;">1.线性判别</span></b></div><div>当不同类样本的协方差矩阵相同时，我们可以在R中使用MASS包的lda函数实现线性判别。lda函数以Bayes判别思想为基础。当分类只有两种且总体服从多元正态分布条件下，Bayes判别与Fisher判别、距离判别是等价的。本例使用iris数据集来对花的品种进行分类。首先载入MASS包，建立判别模型，其中的prior参数表示先验概率。然后利用table函数建立混淆矩阵，比对真实类别和预测类别。</div><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/MASS">MASS</a><span style="color: #009900;">)</span><br />model1=<a href="http://inside-r.org/r-doc/MASS/lda"><span style="color: #003399;">lda</span></a><span style="color: #009900;">(</span>Species~.<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>=<a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399;">iris</span></a><span style="color: #339933;">,</span>prior=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399;">table</span></a><span style="color: #009900;">(</span>Species<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399;">predict</span></a><span style="color: #009900;">(</span>model1<span style="color: #009900;">)</span>$class<span style="color: #009900;">)</span></span></pre><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><br />Species      setosa versicolor virginica<br />setosa         50          0         0<br />versicolor      0         48         2<br />virginica       0          1        49</span></pre><pre class="r geshifilter-R"><span style="font-family: inherit;">从以上结果可观察到判断错误的样本只有三个。在判别函数建立后，还可以类似主成分分析那样对判别得分进行绘图</span><span style="font-family: 'Courier New', Courier, monospace;"><br />ld=<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399;">predict</span></a><span style="color: #009900;">(</span>model1<span style="color: #009900;">)</span>$x<br />p=<a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/cbind"><span style="color: #003399;">cbind</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399;">iris</span></a><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/as.data.frame"><span style="color: #003399;">as.data.frame</span></a><span style="color: #009900;">(</span>ld<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x=LD1<span style="color: #339933;">,</span>y=LD2<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />p+geom_point<span style="color: #009900;">(</span>aes<span style="color: #009900;">(</span>colour=Species<span style="color: #009900;">)</span><span style="color: #339933;">,</span>alpha=<span style="color: #cc66cc;">0.8</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br /></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-TES69nzokt0/TvnImdQz1EI/AAAAAAAAAoc/znsSFx7x1Hs/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-TES69nzokt0/TvnImdQz1EI/AAAAAAAAAoc/znsSFx7x1Hs/s1600/Rplot01.jpeg" /></a></div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #009900;"><br /></span></span></pre></div></div><div><b><span style="font-size: large;">2.二次判别</span></b></div><div>当不同类样本的协方差矩阵不同时，则应该使用二次判别。</div><div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;">model2=<a href="http://inside-r.org/r-doc/MASS/qda"><span style="color: #003399;">qda</span></a><span style="color: #009900;">(</span>Species~.<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a>=<span style="color: #003399;"><a href="http://inside-r.org/r-doc/datasets/iris">iris</a>,cv</span>=<span style="color: #003399;">T</span><span style="color: #009900;">)</span></span></pre><pre class="r geshifilter-R">这里将CV参数设置为T，是使用留一交叉检验（leave-one-out cross-validation），并自动生成预测值。这种条件下生成的混淆矩阵较为可靠。此外还可以使用predict(model)$posterior提取后验概率。</pre><pre class="r geshifilter-R"></pre><pre class="r geshifilter-R">在使用lda和qda函数时注意：其假设是总体服从多元正态分布，若不满足的话则谨慎使用。</pre><pre class="r geshifilter-R"></pre><pre class="r geshifilter-R"><span style="color: #999999;">参考资料：</span></pre><pre class="r geshifilter-R"><span style="color: #999999;">Modern Applied Statistics With S</span></pre><pre class="r geshifilter-R"><span style="color: #999999;">Data_Analysis_and_Graphics_Using_R__An_Example_Based_Approach</span></pre></div>
