--- 
layout: post
name: xml
title: "\xE5\x88\xA9\xE7\x94\xA8XML\xE5\x8C\x85\xE8\x8E\xB7\xE5\x8F\x96\xE7\xBD\x91\xE7\xAB\x99\xE6\x95\xB0\xE6\x8D\xAE"
date: 2011-09-27 12:08:00 +08:00
categories: []

permalink: /2011/09/xml.html
---
很多时候我们需要从某个网站上获取原始数据，本例试图利用XML包来获取google top1000的表格数据。<br /><br />首先读入必要的工具包<br /><blockquote>library(XML)<br />library(RColorBrewer)</blockquote>利用readHTMLTable函数获取top1000的表格数据，并存入到raw变量中。<br /><blockquote>u = "http://www.google.com/adplanner/static/top1000/"<br />tables = readHTMLTable(u)<br />raw = tables[[2]]<br />colnames(raw)=c('Rank','Site','Category','Users','Reach','Views','Advertising?')<br /><a name='more'></a></blockquote>按网站所属行业进行数据汇集<br /><blockquote>attach(raw)<br />hangye = aggregate(Category,list(Category),FUN=length)<br />然后按行业进行排序<br />hangye1 = hangye[order(hangye$x,decreasing = T),]<br />hangye1[1:8,]</blockquote><div style="text-align: center;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Group.1 &nbsp;x</div><div style="text-align: center;">223 &nbsp; &nbsp; Web Portals 67</div><div style="text-align: center;">2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39</div><div style="text-align: center;">144 &nbsp; &nbsp;Online Games 30</div><div style="text-align: center;">140 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;News 28</div><div style="text-align: center;">181 Social Networks 27</div><div style="text-align: center;">141 &nbsp; &nbsp; &nbsp;Newspapers 23</div><div style="text-align: center;">173 &nbsp;Search Engines 22</div><div style="text-align: center;">149 &nbsp; &nbsp;Online Video 21</div><br />最后绘制条形图，看到网站数量最多的行业是门户网站，其次是未标明的其它类，第三是在线游戏，<br /><blockquote>barplot(hangye1[1:8,]$x,names.arg=hangye1[1:8,]$Group.1,&nbsp; &nbsp;col=brewer.pal(8,"Set1"),border="white",ylim=c(0,70),ylab="本行业的网站数目",<br />main="谷歌Top1000网站前八大行业") &nbsp; </blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-PAr12_nskhg/ToFMM9V17QI/AAAAAAAAAcM/w644xY7FhIM/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-PAr12_nskhg/ToFMM9V17QI/AAAAAAAAAcM/w644xY7FhIM/s400/Rplot.jpeg" width="400" /></a></div>
