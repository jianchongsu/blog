--- 
layout: post
name: rgame-of-life
title: "\xE7\x94\xA8R\xE5\xAE\x9E\xE7\x8E\xB0\xE7\x94\x9F\xE5\x91\xBD\xE6\xB8\xB8\xE6\x88\x8F(Game of Life)"
date: 2012-02-24 18:56:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
permalink: /2012/02/rgame-of-life.html
---
<div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/Vj8uXA73.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><br /><img border="0" height="149" src="http://thumbsnap.com/i/Vj8uXA73.jpg" width="200" /></a></div><b><a href="http://en.wikipedia.org/wiki/Conway's_Game_of_Life">生命游戏</a></b>是英国数学家John Horton Conway在1970年发明的细胞自动机（cellular automaton）。它最初于1970年10月在《科学美国人》杂志中出现。生命游戏是在一个二维矩形世界中，这个世界中的每个方格居住着一个细胞。细胞的生命状态只有活着或死亡两种。细胞在下一个时刻的生死取决于相邻八个方格中活着细胞的数量。如果相邻方格活着的细胞数量过多，这个细胞会因为资源匮乏而在下一个时刻死去；相反，如果周围活细胞过少，这个细胞会因太孤单而死去。<br /><br />其中一种较为丰富的设定有如下四条：<br /><ul><li>若相邻的存活细胞数少于2，则细胞死于寂寞</li><li>若相邻的存活细胞数多于3，则细胞死于拥挤</li><li>若相邻的存活细胞数为2或3，则细胞继续存活</li><li>若相邻的存活细胞数正好为3，死亡的细胞得到复活<a name='more'></a></li></ul>根据这些资料，笔者在R中运行了相应的代码，首先运行1000次的演变过程，记录每个时间点上细胞的总数，根据这些变化的数字可以得到如下的图形。可以看到一开始细胞过多而出现大量死亡，在接近灭绝的时候又由于资源的空闲而大量繁殖，但繁殖存在一个上限，之后存活数目呈上下振荡趋势。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/70atpQ2u.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://thumbsnap.com/i/70atpQ2u.jpg" /></a></div>另一种玩法是不限定演变的次数，而是反复绘图，以上帝的视角观察这个二维世界中“人们”的变化。看它们生生死死、潮起潮落。在游戏的进行中，杂乱无序的细胞会逐渐演化出各种精致、有形的结构；有时，一些已经成形的结构会因为一些无序细胞的“入侵”而被破坏。但是形状和秩序经常能从杂乱中产生出来。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/1q3kCGse.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://thumbsnap.com/i/1q3kCGse.jpg" width="400" /></a></div><i>注：本文参考了wiki，以及《Introduction to Scientific Programming and Simulation Using R》第五章的习题。</i><br /><br />R代码：<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/rm"><span style="color: #003399;">rm</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a>=<a href="http://inside-r.org/r-doc/base/ls"><span style="color: #003399;">ls</span></a><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;">#建立一个计算邻近存活细胞数目的函数，并使边缘的细胞仍有八个邻居</span><br />neighbours &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>A<span style="color: #339933;">,</span>i<span style="color: #339933;">,</span>j<span style="color: #339933;">,</span>n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    left &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>j ==  <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>n<span style="color: #339933;">,</span>j-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />    right &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>j == n<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> j+<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />    up &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>i == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> n<span style="color: #339933;">,</span> i-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />    down &lt;- <a href="http://inside-r.org/r-doc/base/ifelse"><span style="color: #003399;">ifelse</span></a><span style="color: #009900;">(</span>i == n<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> i+<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />        nbrs &lt;- <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399;">sum</span></a><span style="color: #009900;">(</span>A<span style="color: #009900;">[</span>up<span style="color: #339933;">,</span>left<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>up<span style="color: #339933;">,</span>right<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>up<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>left<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> A<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>right<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>down<span style="color: #339933;">,</span>left<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>down<span style="color: #339933;">,</span>right<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>A<span style="color: #009900;">[</span>down<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> == <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span>nbrs<span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br />n &lt;- <span style="color: #cc66cc;">50</span>  <span style="color: #666666; font-style: italic;">#方阵的行数</span><br />A &lt;- <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399;">runif</span></a><span style="color: #009900;">(</span>n^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>n<span style="color: #339933;">,</span>n<span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;">#初始化二维世界方阵</span><br />finished &lt;- <span style="color: black;">FALSE</span><br /><span style="color: black;">while</span> <span style="color: #009900;">(</span>!finished<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>  <span style="color: #666666; font-style: italic;">#重复进行演化，你需要用ESC退出</span><br />    <a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>n<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>n<span style="color: #009900;">)</span><span style="color: #339933;">,</span>type=<span style="color: blue;">'n'</span><span style="color: #339933;">,</span>xlab=<span style="color: blue;">''</span><span style="color: #339933;">,</span>ylab=<span style="color: blue;">''</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;">#绘图</span><br />    <span style="color: black;">for</span><span style="color: #009900;">(</span>i <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        <span style="color: black;">for</span> <span style="color: #009900;">(</span>j <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />            <span style="color: black;">if</span> <span style="color: #009900;">(</span>A<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span>==<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />                <a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399;">points</span></a><span style="color: #009900;">(</span>i<span style="color: #339933;">,</span>j<span style="color: #339933;">,</span>pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399;">col</span></a>=<span style="color: blue;">'red'</span><span style="color: #009900;">)</span><br />            <span style="color: #009900;">}</span><br />        <span style="color: #009900;">}</span><br />    <span style="color: #009900;">}</span><br />    B &lt;- A <span style="color: #666666; font-style: italic;">#将上期的信息存入本期矩阵B，并按照条件修改B</span><br />    <span style="color: black;">for</span> <span style="color: #009900;">(</span>i <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        <span style="color: black;">for</span> <span style="color: #009900;">(</span>j <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:n<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />            nbrs &lt;- neighbours<span style="color: #009900;">(</span>A<span style="color: #339933;">,</span>i<span style="color: #339933;">,</span>j<span style="color: #339933;">,</span>n<span style="color: #009900;">)</span><br />            <span style="color: black;">if</span> <span style="color: #009900;">(</span>A<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span>==<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />                <span style="color: black;">if</span> <span style="color: #009900;">(</span><span style="color: #009900;">(</span>nbrs ==<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span> | <span style="color: #009900;">(</span>nbrs==<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">{</span><br />                    B<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">1</span><br />                <span style="color: #009900;">}</span> <span style="color: black;">else</span> <span style="color: #009900;">{</span><br />                    B<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">0</span><br />                <span style="color: #009900;">}</span><br />            <span style="color: #009900;">}</span> <span style="color: black;">else</span> <span style="color: #009900;">{</span><br />                <span style="color: black;">if</span> <span style="color: #009900;">(</span>nbrs ==<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />                B<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">1</span><br />                <span style="color: #009900;">}</span> <span style="color: black;">else</span> <span style="color: #009900;">{</span><br />                    B<span style="color: #009900;">[</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">0</span><br />                <span style="color: #009900;">}</span><br />            <span style="color: #009900;">}</span><br />        <span style="color: #009900;">}</span><br /><span style="color: #009900;">}</span><br />A &lt;- B <span style="color: #666666; font-style: italic;">#将变化后的B矩阵存回到A中</span><br /><span style="color: #009900;">}</span> </span></pre></div></div>
