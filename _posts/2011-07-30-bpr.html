--- 
layout: post
name: bpr
title: "BP\xE7\xA5\x9E\xE7\xBB\x8F\xE7\xBD\x91\xE7\xBB\x9C\xE5\x92\x8C\xE6\x94\xAF\xE6\x8C\x81\xE5\x90\x91\xE9\x87\x8F\xE6\x9C\xBA\xE5\x9C\xA8R\xE8\xAF\xAD\xE8\xA8\x80\xE4\xB8\xAD\xE7\x9A\x84\xE5\xAE\x9E\xE7\x8E\xB0"
date: 2011-07-30 11:03:00 +08:00
categories: 
- "\xE7\xA5\x9E\xE7\xBB\x8F\xE7\xBD\x91\xE7\xBB\x9C"
- "\xE5\xA4\x9A\xE5\x85\x83\xE8\x87\xAA\xE9\x80\x82\xE5\xBA\x94\xE5\x9B\x9E\xE5\xBD\x92\xE6\xA0\xB7\xE6\x9D\xA1"
- "\xE6\x94\xAF\xE6\x8C\x81\xE5\x90\x91\xE9\x87\x8F\xE6\x9C\xBA"
permalink: /2011/07/bpr.html
---
<b>BP（Back Propagation）神经网络</b>是1986年由Rumelhart和McCelland为首的科学家小组提出，是一种按误差逆传播算法训练的多层前馈网络，是目前应用最广泛的神经网络模型之一。BP网络能学习和存贮大量的输入-输出模式映射关系，而无需事前揭示描述这种映射关系的数学方程。它的学习规则是使用最速下降法，通过反向传播来不断调整网络的权值和阈值，使网络的误差平方和最小。BP神经网络模型拓扑结构包括输入层（input）、隐层(hide layer)和输出层(output layer)。<br /><br />下面用R语言中的nnet程序包进行分类算例和回归算例，第一个例子是对河流的化学属性对其中的藻类进行回归预测，第二个例子是著名的鸢尾花算例。<br /><a name='more'></a><br /><br />#首先读入程序包并对数据进行清理<br />library(DMwR)<br />library(nnet)<br />data(algae)<br />algae &lt;- algae[-manyNAs(algae), ]<br />clean.algae &lt;- knnImputation(algae[,1:12],k=10)<br /><br />#神经网络还需要对数据进行标准化<br />norm.data &lt;- scale(clean.algae[,4:12])<br />#使用nnet命令，参数规定隐层单元个数为10，权重调整速度为0.1，最大迭代次数为1000次，线性输入。<br />nn &lt;- nnet(a1~., norm.data, size = 10, decay = 0.01,<br />&nbsp;maxit = 1000, linout = T, trace = F)<br />#利用模型进行预测<br />norm.preds &lt;- predict(nn, norm.data)<br />#绘制预测值与真实值之间的散点图<br />plot(norm.preds~ scale(clean.algae$a1))<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qF0wFKQUQFg/TjN0g-mVF_I/AAAAAAAAAWY/9NoxYT8M7og/s1600/Rplot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="325" src="http://1.bp.blogspot.com/-qF0wFKQUQFg/TjN0g-mVF_I/AAAAAAAAAWY/9NoxYT8M7og/s400/Rplot.png" width="400" /></a></div><br />#计算相对误差<br />(nmse2 &lt;- mean((norm.preds-scale(clean.algae$a1))^2)/<br />mean((mean( scale(clean.algae$a1))- scale(clean.algae$a1))^2))<br /><br /><br />再来看看处理分类数据的表现，利用iris数据来判断花的种类<br /><br />model.nnet &lt;-nnet(Species ~ ., linout = F,size = 10, decay = 0.01,<br />&nbsp;maxit = 1000,trace = F,data = iris)<br />#对分类数据预测需要加上type参数<br />pre.forest=predict(model.nnet, iris,type='class')<br />table(pre.forest,iris$Species)<br /><br /><span class="Apple-style-span" style="font-family: 'Lucida Console'; font-size: 13px; line-height: 17px; white-space: pre-wrap;"></span><br /><pre class="GD40030CKR" style="border-bottom-style: none; border-color: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; font-family: 'Lucida Console'; font-size: 10pt !important; line-height: 1.3; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; outline-color: initial; outline-style: none; outline-width: initial; white-space: pre-wrap !important;" tabindex="0">pre.forest   setosa versicolor virginica<br />  setosa         50          0         0<br />  versicolor      0         49         0<br />  virginica       0          1        50</pre><pre class="GD40030CKR" style="border-bottom-style: none; border-color: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; font-family: 'Lucida Console'; font-size: 10pt !important; line-height: 1.3; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; outline-color: initial; outline-style: none; outline-width: initial; white-space: pre-wrap !important;" tabindex="0"></pre><br />其预测只有一个错误，效果不错<br /><br />支持向量机SVM是九十年代中期发展起来的新的机器学习技术,与传统的神经网络NN技术不同,SVM是以统计学习理论SLT为基础,NN是以传统统计学理论为基础。传统统计学的前提条件是要有足够多的样本,而统计学习理论是着重研究小样本条件下的统计规律和学习方法的,它为机器学习问题建立了一个很好的理论框架。<br /><br />实践表明,建立在SLT之上支持向量机不仅结构简单,而且技术性能尤其是推广能力明显提高,能够解决好大量现实中的小样本学习问题,它是一个全新的神经网络技术。<br /><br />library(e1071)<br /><br />model.svm &lt;- svm(a1~., norm.data)<br />preds &lt;- predict(model.svm, norm.data)<br />plot(preds~ scale(clean.algae$a1))<br /><br />model.svm &lt;-svm(Species ~ .,data = iris)<br />pre=predict(model.svm, iris,type='class')<br />table(pre,iris$Species)<br /><br />多元自适应回归样条（MARS）<br /><br />library(earth)<br />model.mars &lt;- earth(a1~., clean.algae)<br />preds &lt;- predict(model.mars, clean.algae)<br />plot(preds~ clean.algae$a1)<br />(nmse2 &lt;- mean((preds-clean.algae$a1)^2)/<br />mean((mean( clean.algae$a1)- clean.algae$a1)^2))<br /><br />model.mars&nbsp;&lt;-earth(Species ~ .,data = iris)<br />pre=predict(model.mars, iris,type='class')<br />table(pre,iris$Species)
