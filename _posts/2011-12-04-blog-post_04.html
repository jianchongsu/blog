--- 
layout: post
name: blog-post_04
title: "\xE5\x8F\x82\xE6\x95\xB0\xE6\xA3\x80\xE9\xAA\x8C\xE3\x80\x81\xE9\x9D\x9E\xE5\x8F\x82\xE6\x95\xB0\xE6\xA3\x80\xE9\xAA\x8C\xE4\xB8\x8E\xE7\xBD\xAE\xE6\x8D\xA2\xE6\xA3\x80\xE9\xAA\x8C\xE7\x9A\x84\xE6\xAF\x94\xE8\xBE\x83"
date: 2011-12-04 10:34:00 +08:00
categories: 
- "\xE9\x9D\x9E\xE5\x8F\x82\xE6\x95\xB0\xE6\x96\xB9\xE6\xB3\x95"
- "\xE7\xBD\xAE\xE6\x8D\xA2\xE6\xA3\x80\xE9\xAA\x8C"
- "\xE6\xA8\xA1\xE5\x9E\x8B\xE6\xA3\x80\xE9\xAA\x8C"
permalink: /2011/12/blog-post_04.html
---
当我们研究的样本处于良好情况下（近似正态、无离群点、数据量大等），传统的参数检验是很有效的。但是当这些前提条件不再满足时，参数检验就不再有效。此时人们往往求助于非参数检验，非参数检验不再关注数据的值，而只关注数据的秩，这样就抛弃了大量可用的信息。而置换检验采取重复随机抽样的方法，通过对样本再抽样构造经验分布，然后在此基础上生成P值进行推断，达到很好的效果。但要注意的是，如果样本不能很好的代表总体，任何检验方法都是无效的。<br /><a name='more'></a><br /><br />以往进行置换检验可能需要编程，但在R语言中利用coin包和lmPerm可方便的进行这项工作。我们来构造两组数据来说明T检验、wilcox检验和置换检验的区别。<br /><blockquote class="tr_bq">score=c(40,57,45,55,58,57,64,55,62,65)<br />treatment=factor(c(rep("A",5),rep("B",5)))<br />mydata=data.frame(treatment,score)<br />library(lattice)<br />stripplot(treatment~score,data=mydata)</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-RyZ8TWKjuuw/TtrcYb2VoJI/AAAAAAAAAkU/HLklDf3d7Aw/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-RyZ8TWKjuuw/TtrcYb2VoJI/AAAAAAAAAkU/HLklDf3d7Aw/s400/Rplot01.jpeg" width="400" /></a></div><br />从上面的图形可以看到两组数据有差别，但这种差别是否显著呢，用三种方法分别来看一下P值，注意本例的置换检验函数是coin包中的oneway_test<br /><blockquote class="tr_bq"><blockquote class="tr_bq">library(coin)<br />t.test(score~treatment,data=mydata,var.equal=T)<br />wilcox.test(score~treatment,data=mydata)<br />oneway_test(score~treatment,data=mydata,distribution='exact')</blockquote></blockquote>可见T检验的P值为0.047，wilcox检验P值为0.09，而置换检验P值为0.07，由于样本数量只有十个，所以更倾向于相信置换检验。<br /><br />我们也可以对多组数据进行比较，还是利用multcomp包中的cholesterol数据集，首先绘图进行观察，然后分别用传统的方差分析函数aov，非参数的kruskal检验和lmPerm包中的置换检验函数aovp获得P值。<br /><blockquote class="tr_bq">library(multcomp)<br />stripplot(trt~response,data=cholesterol)<br />summary(aov(response~trt,data=cholesterol))<br />kruskal.test(trt~response,data=cholesterol)<br />library(lmPerm)<br />summary(aovp(response~trt,data=cholesterol))</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-3_vS50Qu30E/TtrckGpIdxI/AAAAAAAAAkc/clxttk0Tg0s/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/-3_vS50Qu30E/TtrckGpIdxI/AAAAAAAAAkc/clxttk0Tg0s/s400/Rplot.jpeg" width="400" /></a></div><br />在这个例子中，因为样本数据表现良好，所以参数检验和置换检验所得结论相近，P值都非常小而拒绝原假设。但非参数检验的信息利用不足，导致检验效能降低，无法检验出这种差别的存在。<br /><br /><br />
