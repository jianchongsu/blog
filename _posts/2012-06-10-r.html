--- 
layout: post
name: r
title: "\xE5\x9F\xBA\xE4\xBA\x8E\xE5\xAF\x86\xE5\xBA\xA6\xE7\x9A\x84\xE8\x81\x9A\xE7\xB1\xBB\xE5\x88\x86\xE6\x9E\x90"
date: 2012-06-10 17:17:00 +08:00
categories: 
- "\xE8\x81\x9A\xE7\xB1\xBB\xE5\x88\x86\xE6\x9E\x90"
permalink: /2012/06/r.html
---
<b>聚类分析</b>是一种无监督学习方法，目的是捕获数据的自然结构，从而将数据划分为有意义的组。聚类分析还可以用来对大数据进行预处理，为进一步的数据挖掘工作起到压缩和降维的作用。在<a href="http://xccds1977.blogspot.com/2012/01/r.html">前面的文章中</a>我们已经谈到了K均值聚类和凝聚层次聚类。K均值聚类使用非常广泛，作为最为古老的聚类方法，它的算法非常简单，而且速度很快。但是其缺点在于它不能识别非球形的簇。我们可以用一个简单的例子来观察K均值聚类的弱点。<br /><br />我们先构造一些人为数据，它是基于sin函数和cos函数构成的两组点。如果我们用传统的K均值聚类，结果如下图所示。其聚类结果是不理想的，因为它不能识别非球形的簇。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-8gqIR5kAdY8/T9Ri_F8dl1I/AAAAAAAAA9U/BXa0_dVl8T8/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-8gqIR5kAdY8/T9Ri_F8dl1I/AAAAAAAAA9U/BXa0_dVl8T8/s1600/Rplot01.jpeg" /></a></div><br /><a name='more'></a><br />为了解决这个问题，我们可以使用<a href="http://en.wikipedia.org/wiki/DBSCAN">DBSCAN方法</a>，它是一种基于密度的聚类方法。即寻找那些被低密度区域所分离的高密度区域。DBSCAN方法的重要概念如下：<br /><ul><li>核心点：如果某个点的邻域内的点的个数超过某个阀值，则它是一个核心点，即表示它位于簇的内部。邻域的大小由半径参数eps决定。阀值由MiniPts参数决定。</li><li>边界点：如果某个点不是核心点，但它落在核心点的邻域内，则它是边界点。</li><li>噪声点：即非核心点也非边界点。</li></ul><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-3cu_g7_HsZ0/T9Rljc9bquI/AAAAAAAAA9k/haorEG9TU8Q/s1600/1.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-3cu_g7_HsZ0/T9Rljc9bquI/AAAAAAAAA9k/haorEG9TU8Q/s1600/1.JPG" /></a></div><br />在上图中，红色的点均为核心点，黄色的为边界点，而蓝色的则为噪声点。简单来讲，DBSCAN的算法是将所有点标记为核心点、边界点或噪声点，将任意两个距离小于eps的核心点归为同一个簇。任何与核心点足够近的边界点也放到与之相同的簇中。下面我们来使用R语言中的<b>fpc包</b>来对上面的例子实施密度聚类。其中eps参数设为0.6，即两个点之间距离小于0.6则归为一个簇，而阀值MinPts设为4。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-G4s_4CVxoMQ/T9Rj5RipR1I/AAAAAAAAA9c/f6s0YwFjuKo/s1600/Rplot2.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-G4s_4CVxoMQ/T9Rj5RipR1I/AAAAAAAAA9c/f6s0YwFjuKo/s1600/Rplot2.jpeg" /></a></div>从上图可以看到，DBSCAN方法很好的划分了两个簇。其中要注意参数eps的设置，如果eps设置过大，则所有的点都会归为一个簇，如果设置过小，那么簇的数目会过多。如果MinPts设置过大的话，很多点将被视为噪声点。<br /><br />从这个例子中，我们可以看到基于密度聚类的优良特性，它可以对抗噪声，能处理任意形状和大小的簇，这样可以发现K均值不能发现的簇。但是对于高维数据，点之间极为稀疏，密度就很难定义了。<br /><br />参考资料：<br />数据挖掘导论<br /><a href="http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Clustering/Density-Based_Clustering">http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Clustering/Density-Based_Clustering</a><br /><br /><b>R代码如下</b>：<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># 生成数据</span><br />x1 &lt;- <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399;">seq</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: black;">pi</span><span style="color: #339933;">,</span>length.out=<span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />y1 &lt;- <a href="http://inside-r.org/r-doc/base/sin"><span style="color: #003399;">sin</span></a><span style="color: #009900;">(</span>x1<span style="color: #009900;">)</span> + <span style="color: #cc66cc;">0.1</span>*<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399;">rnorm</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />x2 &lt;- <span style="color: #cc66cc;">1.5</span>+ <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399;">seq</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: black;">pi</span><span style="color: #339933;">,</span>length.out=<span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br />y2 &lt;- <a href="http://inside-r.org/r-doc/base/cos"><span style="color: #003399;">cos</span></a><span style="color: #009900;">(</span>x2<span style="color: #009900;">)</span> + <span style="color: #cc66cc;">0.1</span>*<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399;">rnorm</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>x1<span style="color: #339933;">,</span>x2<span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>y1<span style="color: #339933;">,</span>y2<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">)</span> &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">'x'</span><span style="color: #339933;">,</span><span style="color: blue;">'y'</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 用K均值聚类</span><br />model1 &lt;- <a href="http://inside-r.org/r-doc/stats/kmeans"><span style="color: #003399;">kmeans</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>centers=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>nstart=<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />p + geom_point<span style="color: #009900;">(</span>size=<span style="color: #cc66cc;">2.5</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>colour=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399;">factor</span></a><span style="color: #009900;">(</span>model1$cluster<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>+<br />               opts<span style="color: #009900;">(</span>legend.position=<span style="color: blue;">'top'</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 用fpc包中的dbscan函数进行密度聚类</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><span style="color: blue;">'fpc'</span><span style="color: #009900;">)</span><br />model2 &lt;- dbscan<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>eps=<span style="color: #cc66cc;">0.6</span><span style="color: #339933;">,</span>MinPts=<span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><br />p + geom_point<span style="color: #009900;">(</span>size=<span style="color: #cc66cc;">2.5</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>colour=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399;">factor</span></a><span style="color: #009900;">(</span>model2$cluster<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>+<br />               opts<span style="color: #009900;">(</span>legend.position=<span style="color: blue;">'top'</span><span style="color: #009900;">)</span></span></pre></div></div>
