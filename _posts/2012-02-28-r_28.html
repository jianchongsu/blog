--- 
layout: post
name: r_28
title: "R\xE8\xAF\xAD\xE8\xA8\x80\xE7\xBC\x96\xE7\xA8\x8B\xE5\x85\xA5\xE9\x97\xA8\xE4\xB9\x8B\xE5\x9B\x9B\xEF\xBC\x9A\xE5\xAD\x97\xE7\xAC\xA6\xE4\xB8\xB2\xE5\xA4\x84\xE7\x90\x86"
date: 2012-02-28 09:43:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
- "\xE5\x85\xA5\xE9\x97\xA8\xE6\x95\x99\xE7\xA8\x8B"
permalink: /2012/02/r_28.html
---
<a href="http://thumbsnap.com/i/M3O3MVCD.jpg" imageanchor="1" style="clear: left; display: inline !important; float: left; margin-bottom: 1em; margin-right: 1em; text-align: center;"><img border="0" height="195" src="http://thumbsnap.com/i/M3O3MVCD.jpg" width="200" /></a><br />尽管R语言的主要处理对象是数字，而字符串有时候也会在数据分析中占到相当大的份量。特别是在文本数据挖掘日趋重要的背景下，在数据预处理阶段你需要熟练的操作字符串对象。当然如果你擅长其它的处理软件，比如Python，可以让它来负责前期的脏活。<br /><br /><b>获取字符串长度：nchar()</b>能够获取字符串的长度，它也支持字符串向量操作。注意它和length()的结果是有区别的。<br /><br /><b>字符串粘合：paste()</b>负责将若干个字符串相连结，返回成单独的字符串。其优点在于，就算有的处理对象不是字符型也能自动转为字符型。<br /><a name='more'></a><br /><b>字符串分割：strsplit()</b>负责将字符串按照某种分割形式将其进行划分，它正是paste()的逆操作。<br /><br /><b>字符串截取：substr()</b>能对给定的字符串对象取出子集，其参数是子集所处的起始和终止位置。<br /><br /><b>字符串替代：gsub()</b>负责搜索字符串的特定表达式，并用新的内容加以替代。<b>sub()</b>函数是类似的，但只替代第一个发现结果。<br /><br /><b>字符串匹配：grep()</b>负责搜索给定字符串对象中特定表达式&nbsp;，并返回其位置索引。<b>grepl()</b>函数与之类似，但其后面的"l"则意味着返回的将是逻辑值。<br /><br /><b>一个例子：</b><br />我们来看一个处理邮件的例子，目的是从该文本中抽取发件人的地址。该文本<a href="http://www.box.com/s/g8udktb6q59o88oagehi">在此</a>可以下载到。邮件的全文如下所示：<br />----------------------------<br />Return-Path: skip@pobox.com<br />Delivery-Date: Sat Sep &nbsp;7 05:46:01 2002<br />From: skip@pobox.com (Skip Montanaro)<br />Date: Fri, 6 Sep 2002 23:46:01 -0500<br />Subject: [Spambayes] speed<br />Message-ID: &lt;15737.33929.716821.779152@12-248-11-90.client.attbi.com&gt;<br /><br />If the frequency of my laptop's disk chirps are any indication, I'd say<br />hammie is about 3-5x faster than SpamAssassin.<br /><br />Skip<br />----------------------------<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># 用readLines函数从本地文件中读取邮件全文。</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/readLines"><span style="color: #003399;">readLines</span></a><span style="color: #009900;">(</span><span style="color: blue;">'data'</span><span style="color: #009900;">)</span>  <br /><span style="color: #666666; font-style: italic;"># 判断对象的类，确定是一个文本型向量，每行文本是向量的一个元素。</span><br /><a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399;">class</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">)</span>  <br /><span style="color: #666666; font-style: italic;"># 从这个文本向量中找到包括有"From:"字符串的那一行</span><br />email &lt;- <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/grepl"><span style="color: #003399;">grepl</span></a><span style="color: #009900;">(</span><span style="color: blue;">'From:'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">)</span><span style="color: #009900;">]</span> <br /><span style="color: #666666; font-style: italic;">#将其按照空格进行分割，分成一个包括四个元素的字符串向量。</span><br />from &lt;- <a href="http://inside-r.org/r-doc/base/strsplit"><span style="color: #003399;">strsplit</span></a><span style="color: #009900;">(</span>email<span style="color: #339933;">,</span><span style="color: blue;">' '</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 上面的结果是一个list格式，转成向量格式。</span><br />from &lt;- <a href="http://inside-r.org/r-doc/base/unlist"><span style="color: #003399;">unlist</span></a><span style="color: #009900;">(</span>from<span style="color: #009900;">)</span> <br /><span style="color: #666666; font-style: italic;"># 最后搜索包含'@'的元素，即为发件人邮件地址。</span><br />from &lt;- from<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/grepl"><span style="color: #003399;">grepl</span></a><span style="color: #009900;">(</span><span style="color: blue;">'@'</span><span style="color: #339933;">,</span>from<span style="color: #009900;">)</span><span style="color: #009900;">]</span> </span></pre></div></div>在字符串的复杂操作中通常会包括<b>正则表达式（Regular Expressions）</b>，关于这方面内容可以参考?regex
