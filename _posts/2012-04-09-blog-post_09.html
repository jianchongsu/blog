--- 
layout: post
name: blog-post_09
title: "\xE4\xB8\x80\xE4\xB8\xAA\xE7\xAE\x80\xE5\x8D\x95\xE7\x9A\x84\xE7\x8B\xBC\xE5\x85\x94\xE8\xBF\xBD\xE9\x80\x90\xE9\x97\xAE\xE9\xA2\x98"
date: 2012-04-09 18:09:00 +08:00
categories: 
- other
permalink: /2012/04/blog-post_09.html
---
<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/w1fP64s3.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://thumbsnap.com/i/w1fP64s3.jpg" /></a></div>四月八日，也就是春分月圆之后的首个星期日即是复活节(Easter)。而复活节兔是复活节象征之一。作为多产动物的兔子，象征了春天的复苏和新生命的诞生。此外，兔子是爱神阿弗洛狄特的宠物，也是日耳曼土地女神霍尔塔的持烛引路者。今天我们就来谈一个关于兔子的问题。狼兔追逐问题是欧洲文艺复兴时代达芬奇提出的一个数学问题。题目描述如下：一只兔子在O点外，其洞穴在正北20米的B处，一只狼位于兔子正东33米的A处。当两只动物同时发现对方以后，兔子奔向自己的洞穴，狼以快于兔子一倍的速度紧追兔子不放。狼在追赶过程中所形成的轨迹就是追击曲线。狼是否会在兔子跑回洞穴之前追赶上兔子？<br /><br />这个问题也是《统计模拟及其R实现》一书后面的一个习题。我们先建立一个函数，参数为二者运动速度之比v，一个微小的位移delta_T，以及狼可以捕获兔子的最短距离eps。基本思路是先画出初始位置，然后用两个矩阵来存放二者的坐标。然后利用一个for循环来不断更新坐标数据。d为二者之间的距离，如果在循环结束时，d小于eps则意味着狼抓住了兔子，否则就是失败。函数会画出追击曲线，并根据情况返回逻辑值。如果抓住返回真值，并获得抓住点坐标。如果失败返回假值，并获得二者最后的距离。实际从结果来看，狼未能在兔子跑回洞穴之前追赶上兔子。但你可以试着将v值设置的大一些，大约在2.3左右，狼就可以成功追上兔子了。<br /><a name='more'></a><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/wsiX8xtC.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><br /><img border="0" src="http://thumbsnap.com/i/wsiX8xtC.jpg" /></a></div><br />R代码如下：<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># V为狼与兔子的运动速度之比，delta_T为瞬间移动</span><br /><span style="color: #666666; font-style: italic;"># eps为可以抓到的距离</span><br /><a href="http://inside-r.org/r-doc/base/trace"><span style="color: #003399;">trace</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>v=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>delta_T=<span style="color: #cc66cc;">0.001</span><span style="color: #339933;">,</span>eps=<span style="color: #cc66cc;">0.01</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />  <a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">33</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">35</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">35</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">20</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>xlab=<span style="color: blue;">''</span><span style="color: #339933;">,</span>ylab=<span style="color: blue;">''</span><span style="color: #009900;">)</span><br />  <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399;">text</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399;">labels</span></a>=<span style="color: blue;">'B'</span><span style="color: #339933;">,</span>adj=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.3</span><span style="color: #339933;">,</span>-<span style="color: #cc66cc;">0.8</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399;">text</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">33</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399;">labels</span></a>=<span style="color: blue;">'A'</span><span style="color: #339933;">,</span>adj=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.3</span><span style="color: #339933;">,</span>-<span style="color: #cc66cc;">0.8</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399;">text</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399;">labels</span></a>=<span style="color: blue;">'O'</span><span style="color: #339933;">,</span>adj=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span>-<span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0.1</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  <span style="color: #666666; font-style: italic;"># x为兔子的坐标矩阵，y为狼的坐标矩阵</span><br />  x &lt;- <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399;">nrow</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />  y &lt;- <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399;">matrix</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">33</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399;">nrow</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />  a &lt;- <span style="color: #cc66cc;">0</span><br />  b &lt;- <span style="color: #cc66cc;">0</span><br />  <a href="http://inside-r.org/r-doc/stats/time"><span style="color: #003399;">time</span></a> &lt;- <span style="color: #cc66cc;">20</span>/delta_T<br />  <span style="color: black;">for</span> <span style="color: #009900;">(</span>j <span style="color: black;">in</span> <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/stats/time"><span style="color: #003399;">time</span></a><span style="color: #009900;">)</span> <span style="color: #009900;">{</span> <br />    <span style="color: #666666; font-style: italic;"># d为二者之间的距离，a为兔子的新位置，b为狼的新位置</span><br />    d &lt;- <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399;">sqrt</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>x<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span>-y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span>+<span style="color: #009900;">(</span>x<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span>-y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br />    a<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt;- <span style="color: #cc66cc;">0</span><br />    a<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span> &lt;- x<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span> + delta_T<br />    b<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt;- y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> + v*delta_T*<span style="color: #009900;">(</span>x<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> - y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>/d<br />    b<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span> &lt;- y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span> + v*delta_T*<span style="color: #009900;">(</span>x<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span> - y<span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>/d<br />    <span style="color: #666666; font-style: italic;"># 若距离小于抓捕距离则离开循环</span><br />    <span style="color: black;">if</span><span style="color: #009900;">(</span>d &lt; eps<span style="color: #009900;">)</span> <span style="color: black;">break</span><br />    <span style="color: #666666; font-style: italic;"># 将新位置加入到坐标矩阵中</span><br />    x &lt;- <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399;">rbind</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>a<span style="color: #009900;">)</span><br />    y &lt;- <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399;">rbind</span></a><span style="color: #009900;">(</span>y<span style="color: #339933;">,</span>b<span style="color: #009900;">)</span><br />  <span style="color: #009900;">}</span><br />  <span style="color: #666666; font-style: italic;"># 绘制二者的追逐路线</span><br />  <a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399;">lines</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span>x<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399;">col</span></a>=<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span><br />  <a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399;">lines</span></a><span style="color: #009900;">(</span>y<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span>y<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br />  <span style="color: black;">if</span> <span style="color: #009900;">(</span> d &lt; eps &amp; j &lt;= <a href="http://inside-r.org/r-doc/stats/time"><span style="color: #003399;">time</span></a><span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span>result=<span style="color: blue;">'TRUE'</span><span style="color: #339933;">,</span>x=x<span style="color: #009900;">[</span><span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span>y=x<span style="color: #009900;">[</span><span style="color: #009900;">[</span>j<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />  <span style="color: black;">else</span> <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399;">return</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399;">list</span></a><span style="color: #009900;">(</span>result=<span style="color: blue;">'FALSE'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/dist"><span style="color: #003399;">dist</span></a>=<a href="http://inside-r.org/r-doc/base/as.vector"><span style="color: #003399;">as.vector</span></a><span style="color: #009900;">(</span>d<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br /><a href="http://inside-r.org/r-doc/base/trace"><span style="color: #003399;">trace</span></a><span style="color: #009900;">(</span><span style="color: #009900;">)</span></span></pre></div></div>
