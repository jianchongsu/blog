--- 
layout: post
name: r_27
title: "R\xE8\xAF\xAD\xE8\xA8\x80\xE7\xBC\x96\xE7\xA8\x8B\xE5\x85\xA5\xE9\x97\xA8\xE4\xB9\x8B\xE4\xB8\x89\xEF\xBC\x9A\xE8\xBE\x93\xE5\x85\xA5\xE4\xB8\x8E\xE8\xBE\x93\xE5\x87\xBA"
date: 2012-02-27 20:13:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
- "\xE5\x85\xA5\xE9\x97\xA8\xE6\x95\x99\xE7\xA8\x8B"
permalink: /2012/02/r_27.html
---
<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://thumbsnap.com/i/Carg8vMm.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="149" src="http://thumbsnap.com/i/Carg8vMm.jpg" width="200" /></a></div>如同ATM机一样，你首先得输入银行卡，才能输出得到钞票。数据分析也是如此，输入输出数据在分析工作中有重要的地位。下面对R语言中一些重要的<b>输入输出函数</b>进行小结，而其它的函数请参考<a href="http://cran.r-project.org/doc/manuals/R-data.pdf">官方指南</a>。<br /><br /><b><span style="font-size: large;">1 读取键盘输入</span></b><br />如果只有很少的数据量，你可以直接用变量赋值输入数据。若要用交互方式则可以使用<b>readline()</b>函数输入单个数据，但要注意其默认输入格为字符型。<b>scan()</b>函数中如果不加参数则也可以用来手动输入数据。如果加上文件名则是从文件中读取数据。<br /><br /><b><span style="font-size: large;">2 读取表格文件</span></b><br />读取本地表格文件的主要函数是<b>read.table()</b>，其中的file参数设定了文件路径，注意路径中斜杠的正确用法（如"C:/data/sample.txt"），header参数设定是否带有表头。sep参数设定了列之间的间隔方式。该函数读取数据后将存为data.frame格式，而且所有的字符将被转为因子格式，如果你不想这么做需要记得将参数stringsAsFactors设为FALSE。与之类似的函数是<b>read.csv()</b>专门用来读取csv格式。<br /><a name='more'></a><br />如果是想抓去网页上的某个表格，那么可以使用XML包中的<b>readHTMLTable()</b>函数。例如我们想获得google统计的访问最多的1000名网站数据，则可以象下面这样做。关于这个函数可以参考这篇<a href="http://xccds1977.blogspot.com/2011/09/xml.html">博文</a>。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/url"><span style="color: #003399;">url</span></a> &lt;- <span style="color: blue;">'http://www.google.com/adplanner/static/top1000/'</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- readHTMLTable<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/url"><span style="color: #003399;">url</span></a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/head"><span style="color: #003399;">head</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">[</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></span></pre></div></div><b style="font-size: large;">3 读取文本文件</b><br />有时候需要读取的数据存放在非结构化的文本文件中，例如电子邮件数据或微博数据。这种情况下只能依靠<b>readLines()</b>函数，将文档转为以行为单位存放的list格式。例如我们希望读取wikipedia的主页html文件的前十行。<br /><br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/readLines"><span style="color: #003399;">readLines</span></a><span style="color: #009900;">(</span><span style="color: blue;">'http://en.wikipedia.org/wiki/Main_Page'</span><span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span></span></pre><pre class="r geshifilter-R">另外，<b>scan()</b>也有丰富的参数用来读取非结构化文档。</pre><br /><span style="font-size:   large;"><b>4 批量读取本地文件</b></span><br />在批量读取文档时一般先将其存放在某一个目录下。先用<b>dir()</b>函数获取目录中的文件名，然后用<b>paste()</b>将路径合成，最后用循环或向量化方法处理文档。例如：<br /><br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;">doc.names &lt;- <a href="http://inside-r.org/r-doc/base/dir"><span style="color: #003399;">dir</span></a><span style="color: #009900;">(</span><span style="color: blue;">"path"</span><span style="color: #009900;">)</span><br />doc.path &lt;- <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399;">sapply</span></a><span style="color: #009900;">(</span>doc.names<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399;">paste</span></a><span style="color: #009900;">(</span>path<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #339933;">,</span>sep=<span style="color: blue;">'/'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />doc &lt;- <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399;">sapply</span></a><span style="color: #009900;">(</span>doc.path<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399;">function</span></a><span style="color: #009900;">(</span>doc<span style="color: #009900;">)</span> <a href="http://inside-r.org/r-doc/base/readLines"><span style="color: #003399;">readLines</span></a><span style="color: #009900;">(</span>doc<span style="color: #009900;">)</span><span style="color: #009900;">)</span></span></pre><br /><b><span style="font-size: large;">5 写入文件</span></b><br /><b>write.table()</b>与<b>write.csv()</b>函数可以很方便的写入表格型数据文档，而<b>cat()</b>函数除了可以在屏幕上输出之外，也能够输出成文件。<br /><br />另外若要与MySQL数据库交换数据，则可以使用<b>RMySLQ</b>包。
