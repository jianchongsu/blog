--- 
layout: post
name: twitter
title: "Twitter\xE6\x96\x87\xE6\x9C\xAC\xE6\x8C\x96\xE6\x8E\x98\xE5\x88\x9D\xE6\xAD\xA5"
date: 2012-01-11 12:37:00 +08:00
categories: 
- "\xE6\x96\x87\xE6\x9C\xAC\xE6\x8C\x96\xE6\x8E\x98"
- "\xE6\x95\xB0\xE6\x8D\xAE\xE6\x8C\x96\xE6\x8E\x98"
- twitter
permalink: /2012/01/twitter.html
---
Twitter已经成为社交媒体领域重要的信息来源，也是数据挖掘和可视化的重点研究对象。据说华尔街的多家对冲基金公司已经在利用twitter数据挖掘来衡量人们的情绪，从而预测资本市场的运动方向。可见在未来数年，对twitter信息的挖掘必将成为一个热点。<br /><br />在R语言中提取twitter信息的扩展包是twitterR，它可以提取公共信息流，也可以针对某个用户提取其信息流，或者是以某个标签搜索推文。下面我们以“wukan”（乌坎）为关键词搜索推文标签，观察推友的发推数量。<br /><br />首先载入软件包，以#wukan为关键词提取1000条推文，然后将其转化为数据框格式。df数据中存储的中文推文内容在R中似乎无法正常浏览，不过推文的用户名仍然是英文的可加以利用。<br /><a name='more'></a><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/twitteR">twitteR</a><span style="color: #009900;">)</span><br />rdmTweets &lt;- searchTwitter<span style="color: #009900;">(</span><span style="color: blue;">'#wukan'</span><span style="color: #339933;">,</span> n = <span style="color: #cc66cc;">1000</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/stats/df"><span style="color: #003399;">df</span></a> &lt;- twListToDF<span style="color: #009900;">(</span>rdmTweets<span style="color: #009900;">)</span><span style="color: #003399;"><br /></span></span></pre></div></div>下一步提取推文用户名并制成频数表，然后将发推数小于10的数据删除。为了绘图方便起见，将用户名进行按照发推数重新排序，而非原来的字母顺序。最终数据存在data变量中。  <br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;">counts &lt;- <a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399;">table</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/df"><span style="color: #003399;">df</span></a>$screenName<span style="color: #009900;">)</span><br />cc &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/subset"><span style="color: #003399;">subset</span></a><span style="color: #009900;">(</span>counts<span style="color: #339933;">,</span> counts&gt;<span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span>cc<span style="color: #009900;">)</span> &lt;- <span style="color: blue;">'value'</span><br />cc &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>value = cc$value<span style="color: #339933;">,</span>name = <a href="http://inside-r.org/r-doc/base/rownames"><span style="color: #003399;">rownames</span></a><span style="color: #009900;">(</span>cc<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />newname &lt;- <a href="http://inside-r.org/r-doc/base/with"><span style="color: #003399;">with</span></a><span style="color: #009900;">(</span>cc<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/reorder"><span style="color: #003399;">reorder</span></a><span style="color: #009900;">(</span>name<span style="color: #339933;">,</span> value<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399;">data.frame</span></a><span style="color: #009900;">(</span>cc<span style="color: #339933;">,</span> newname<span style="color: #009900;">)</span></span></pre>载入ggplot2包，绘制条形图。从图中可观察到，在所有关于#wukan的推文中，revhus这位用户发推数最多。<br /><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>y=value<span style="color: #339933;">,</span>x=newname<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />p+geom_bar<span style="color: #009900;">(</span>stat=<span style="color: blue;">'identity'</span><span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>fill=value<span style="color: #009900;">)</span><span style="color: #009900;">)</span>+coord_flip<span style="color: #009900;">(</span><span style="color: #009900;">)</span></span></pre><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-Q71pQQvv4ew/Tw0R7cigahI/AAAAAAAAApk/B34JNQ97mxs/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-Q71pQQvv4ew/Tw0R7cigahI/AAAAAAAAApk/B34JNQ97mxs/s1600/Rplot01.jpeg" /></a></div><br />参考资料：<br /><a href="http://cran.r-project.org/web/packages/twitteR/vignettes/twitteR.pdf">http://cran.r-project.org/web/packages/twitteR/vignettes/twitteR.pdf</a><br /><a href="http://rdatamining.wordpress.com/2011/11/09/using-text-mining-to-find-out-what-rdatamining-tweets-are-about/">http://rdatamining.wordpress.com/2011/11/09/using-text-mining-to-find-out-what-rdatamining-tweets-are-about/</a><br /><a href="http://blog.ouseful.info/2011/11/09/getting-started-with-twitter-analysis-in-r/">http://blog.ouseful.info/2011/11/09/getting-started-with-twitter-analysis-in-r/</a><br /><a href="http://simplystatistics.tumblr.com/post/13897994725/plotting-beijingair-data">http://simplystatistics.tumblr.com/post/13897994725/plotting-beijingair-data</a>
