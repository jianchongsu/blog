--- 
layout: post
name: blog-post_05
title: "\xE9\x99\x8D\xE7\xBB\xB4\xE4\xB8\xAD\xE7\x9A\x84\xE7\x89\xB9\xE5\xBE\x81\xE9\x80\x89\xE6\x8B\xA9"
date: 2012-06-05 08:37:00 +08:00
categories: 
- "\xE6\x95\xB0\xE6\x8D\xAE\xE9\xA2\x84\xE5\xA4\x84\xE7\x90\x86"
- "\xE9\x9A\x8F\xE6\x9C\xBA\xE6\xA3\xAE\xE6\x9E\x97"
- "\xE7\x89\xB9\xE5\xBE\x81\xE9\x80\x89\xE6\x8B\xA9"
permalink: /2012/06/blog-post_05.html
---
<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-MEEo9kEDgNI/T81TD_1mS0I/AAAAAAAAA8c/EP7IFRLhX40/s1600/tenthdimension.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="181" src="http://4.bp.blogspot.com/-MEEo9kEDgNI/T81TD_1mS0I/AAAAAAAAA8c/EP7IFRLhX40/s200/tenthdimension.jpg" width="200" /></a></div>在数据挖掘过程中，高维数据是非常棘手的研究对象。特别是在文本挖掘、图像处理和基因数据分析中，维度过高使很多学习器无法工作或效率降低，所以降维也是数据预处理过程的一项必要任务。降维大致有两大类别，一类是从原始维度中提取新的维度，例如主成分分析或因子分析，再或者是奇异值分解或是多维标度分析。另一类是从原始维度中选择一些子集，即称为特征选择（Feature Selection），或者叫作最佳子集选择。特征选择本质上继承了Occam's razor的思想，从一组特征中选出一些最有效的特征，使构造出来的模型更好。<br /><br />进行特征选择的好处在于：<br /><ul><li>避免过度拟合，改进预测性能</li><li>使学习器运行更快，效能更高</li><li>剔除不相关的特征使模型更为简单，容易解释</li></ul><a name='more'></a><br />特征选择有三种基本的方法：<br /><b>嵌入（embed）</b>：学习算法中本来就包含有特征选择的过程，例如决策树一类的分类器，它们在决定分枝点时就会选择最有效的特征来对数据进行划分。但这种方法是在局部空间中进行优选，效果相对有限。<br /><b>封装(Wrapper)：</b>&nbsp;特征选择过程与训练过程整合在一起，以模型的预测能力作为衡量特征子集的选择标准，例如分类精度，有时也可加入复杂度惩罚因子。多元线性回归中的前向搜索和后向搜索可以说是封装方法的一种简单实现。不同的学习算法要搭配不同的封装方法，如果是线性分类器，可以采用之前博文谈到的<a href="http://xccds1977.blogspot.com/2012/05/glmnetlasso.html">LASSO方法</a>（glmnet包）。如果是非线性分类器，如树模型则可以采用随机森林封装（RRF包）。封装法可以选择出高质量的子集，但速度会比较慢。<br /><b>过滤(Filter)：&nbsp;</b>特征选择过程独立于训练过程，以分析特征子集内部特点来预先筛选，与学习器的选择无关。过滤器的评价函数通常包括了相关性、距离、信息增益等。在数据预处理过程中删除那些取值为常数的特征就是过滤方法的一种。过滤法速度快但有可能删除有用的特征。<br />在实务中进行特征选择可以先借由专家知识来初步筛选，再用过滤法快速筛选无关变量，最后采用封装法得到最优子集和模型结果。R语言中的caret包就提供了过滤和封装两种方法来进行特征选择。下面则是一个简单的示范：<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># 加载扩展包和数据集mdrr，得到自变量集合mdrrDescr和因变量mdrrClass</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/caret">caret</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399;">data</span></a><span style="color: #009900;">(</span>mdrr<span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 先删去近似于常量的变量</span><br />zerovar &lt;- nearZeroVar<span style="color: #009900;">(</span>mdrrDescr<span style="color: #009900;">)</span><br />newdata1 &lt;- mdrrDescr<span style="color: #009900;">[</span><span style="color: #339933;">,</span>-zerovar<span style="color: #009900;">]</span><br /><span style="color: #666666; font-style: italic;"># 再删去相关度过高的自变量</span><br />descrCorr &lt;- <a href="http://inside-r.org/r-doc/stats/cor"><span style="color: #003399;">cor</span></a><span style="color: #009900;">(</span>newdata1<span style="color: #009900;">)</span><br />highCorr &lt;- findCorrelation<span style="color: #009900;">(</span>descrCorr<span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.90</span><span style="color: #009900;">)</span><br />newdata2 &lt;- newdata1<span style="color: #009900;">[</span><span style="color: #339933;">,</span> -highCorr<span style="color: #009900;">]</span><br /><span style="color: #666666; font-style: italic;"># 数据预处理步骤（标准化，缺失值处理）</span><br />Process &lt;- preProcess<span style="color: #009900;">(</span>newdata2<span style="color: #009900;">)</span><br />newdata3 &lt;- <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399;">predict</span></a><span style="color: #009900;">(</span>Process<span style="color: #339933;">,</span> newdata2<span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 用sbf函数实施过滤方法，这里是用随机森林来评价变量的重要性</span><br />data.filter &lt;- <a href="http://inside-r.org/packages/cran/sBF">sbf</a><span style="color: #009900;">(</span>newdata3<span style="color: #339933;">,</span>mdrrClass<span style="color: #339933;">,</span><br />              sbfControl = sbfControl<span style="color: #009900;">(</span>functions=rfSBF<span style="color: #339933;">,</span><br />                                      verbose=F<span style="color: #339933;">,</span><br />                                      method=<span style="color: blue;">'cv'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 根据上面的过滤器筛选出67个变量</span><br />x &lt;- newdata3<span style="color: #009900;">[</span>data.filter$optVariables<span style="color: #009900;">]</span><br /><span style="color: #666666; font-style: italic;"># 再用rfe函数实施封装方法，建立的模型仍是随机森林</span><br /><a href="http://inside-r.org/r-doc/stats/profile"><span style="color: #003399;">profile</span></a> &lt;- rfe<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>mdrrClass<span style="color: #339933;">,</span><br />               sizes = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">50</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">60</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />               rfeControl = rfeControl<span style="color: #009900;">(</span>functions=rfFuncs<br />               <span style="color: #339933;">,</span>method=<span style="color: blue;">'cv'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><span style="color: #666666; font-style: italic;"># 将结果绘图，发现20-30个变量的模型精度最高</span><br /><a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/profile"><span style="color: #003399;">profile</span></a><span style="color: #339933;">,</span>type=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">'o'</span><span style="color: #339933;">,</span><span style="color: blue;">'g'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span></span></pre></div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-hyNdzjbryBA/T81UdZpqmkI/AAAAAAAAA8k/zhw3xCJwhXU/s1600/Rplot02.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-hyNdzjbryBA/T81UdZpqmkI/AAAAAAAAA8k/zhw3xCJwhXU/s1600/Rplot02.jpeg" /></a></div>sbf和rfe函数都允许用户使用自定义的学习器进行特征选择，灵活度很高。另外在Rweka包中也有大量的特征选择方法可以使用。
