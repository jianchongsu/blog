--- 
layout: post
name: rloess
title: "\xE5\x9C\xA8R\xE8\xAF\xAD\xE8\xA8\x80\xE4\xB8\xAD\xE8\xBF\x9B\xE8\xA1\x8C\xE5\xB1\x80\xE9\x83\xA8\xE5\xA4\x9A\xE9\xA1\xB9\xE5\xBC\x8F\xE5\x9B\x9E\xE5\xBD\x92\xE6\x8B\x9F\xE5\x90\x88\xEF\xBC\x88LOESS\xEF\xBC\x89"
date: 2011-12-05 10:33:00 +08:00
categories: 
- "\xE9\x9D\x9E\xE5\x8F\x82\xE6\x95\xB0\xE6\x96\xB9\xE6\xB3\x95"
- "\xE6\x9B\xB2\xE7\xBA\xBF\xE6\x8B\x9F\xE5\x90\x88"
permalink: /2011/12/rloess.html
---
局部多项式回归拟合是对两维散点图进行平滑的常用方法，它结合了传统线性回归的简洁性和非线性回归的灵活性。当要估计某个响应变量值时，先从其预测变量附近取一个数据子集，然后对该子集进行线性回归或二次回归，回归时采用加权最小二乘法，即越靠近估计点的值其权重越大，最后利用得到的局部回归模型来估计响应变量的值。用这种方法进行逐点运算得到整条拟合曲线。<br /><br />在R语言中进行局部多项式回归拟合是利用loess函数，我们以cars数据集做为例子来看下使用方法。该数据中speed表示行驶速度，dist表示刹车距离。用loess来建立模型时重要的两个参数是span和degree，span表示数据子集的获取范围，取值越大则数据子集越多，曲线越为平滑。degree表示局部回归中的阶数，1表示线性回归，2表示二次回归，也可以取0，此时曲线退化为简单移动平均线。这里我们设span取0.4和0.8，从下图可见取值0.8的蓝色线条较为平滑。<br /><a name='more'></a><br /><div>------------------------</div><div>plot(cars,pch=19)</div><div>model1=loess(dist~speed,data=cars,span=0.4)</div><div>lines(cars$speed,model1$fit,col='red',lty=2,lwd=2)</div><div>model2=loess(dist~speed,data=cars,span=0.8)</div><div>lines(cars$speed,model2$fit,col='blue',lty=2,lwd=2)</div><div>------------------------</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-FSsOEUq85A4/Ttwu4F8NcyI/AAAAAAAAAks/hcFFW23Vcao/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-FSsOEUq85A4/Ttwu4F8NcyI/AAAAAAAAAks/hcFFW23Vcao/s400/Rplot.jpeg" width="400" /></a></div><br />当模型建立后，也可以类似线性回归那样进行预测和残差分析<br /><div>------------------------</div><div>x=5:25</div><div>predict(model2,data.frame(speed=x))</div><div>plot(model2$resid~model2$fit)</div><div>------------------------</div>R语言中另一个类似的函数是lowess，它在绘图上比较方便，但在功能上不如loess强大和灵活。<br /><br />------------------------<br />plot(cars,pch=19)<br />lines(lowess(cars),lty=2,lwd=2)<br />------------------------<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-_2kGHpD-mtI/TtwvMOpkNkI/AAAAAAAAAk0/xqLrnkZVtpY/s1600/Rplot01.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-_2kGHpD-mtI/TtwvMOpkNkI/AAAAAAAAAk0/xqLrnkZVtpY/s400/Rplot01.jpeg" width="400" /></a></div><br />LOESS的优势是并不需要确定具体的函数形式，而是让数据自己来说话，其缺点在于需要大量的数据和运算能力。LOESS作为一种平滑技术，其目的是为了探寻响应变量和预测变量之间的关系，所以LOESS更被看作一种数据探索方法，而不是作为最终的结论。
