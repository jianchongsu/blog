--- 
layout: post
name: igraph
title: "\xE5\x88\x9D\xE6\xAC\xA1\xE5\xB0\x9D\xE8\xAF\x95igraph\xE5\x8C\x85"
date: 2012-06-17 12:21:00 +08:00
categories: 
- "\xE5\x8F\xAF\xE8\xA7\x86\xE5\x8C\x96"
- SNA
- "\xE6\x96\x87\xE6\x9C\xAC\xE6\x8C\x96\xE6\x8E\x98"
permalink: /2012/06/igraph.html
---
<br /><b>igraph</b>是为了进行社会网络分析而创建的一个包。与R语言中同类包相比，它的速度更快，而且函数命令与图形展现更为丰富。它可以处理有向网络和无向网络，但无法处理混合网络。igraph中的函数非常多，本文只是初步的介绍如何创建图形，并提供一些简单的例子。<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="color: #666666; font-family: monospace; font-style: italic;"># 可以使用最基本的graph函数，用向量作为参数来创建图形，之后用plot绘制出结果</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/igraph">igraph</a><span style="color: #009900;">)</span><br />g1 &lt;- <a href="http://inside-r.org/packages/cran/graph">graph</a><span style="color: #009900;">(</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span>g1<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399;">layout</span></a>=layout.circle<span style="color: #009900;">(</span>g1<span style="color: #009900;">)</span><span style="color: #009900;">)</span></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-CkhHZ3Lx1LQ/T91Ud_7Rg0I/AAAAAAAAA98/3jCfMuxcX5g/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-CkhHZ3Lx1LQ/T91Ud_7Rg0I/AAAAAAAAA98/3jCfMuxcX5g/s400/Rplot.jpeg" width="400" /></a></div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><br /><span style="color: #666666; font-style: italic;"># 也可以画出一些特殊结构的图形，例如下面的星形图</span><br />g2 &lt;- graph.star<span style="color: #009900;">(</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/mode"><span style="color: #003399;">mode</span></a> = <span style="color: blue;">"in"</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span>g2<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399;">layout</span></a>=layout.fruchterman.reingold<span style="color: #009900;">(</span>g2<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br /></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-oylQ8qa06NQ/T91U9Gei3tI/AAAAAAAAA-E/IbSTC0HqW0M/s1600/Rplot03.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-oylQ8qa06NQ/T91U9Gei3tI/AAAAAAAAA-E/IbSTC0HqW0M/s400/Rplot03.jpeg" width="400" /></a></div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><a name='more'></a><br /><span style="color: #666666; font-style: italic;"># 当然也能从文件创建图形</span><br /><span style="color: #666666; font-style: italic;"># 首先读入数据，整理后用graph.data.frame函数创建图形对象</span><br />traits &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">'http://igraph.sourceforge.net/igraphbook/traits.csv'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/head"><span style="color: #003399;">head</span></a>=<span style="color: black;">FALSE</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span>traits<span style="color: #009900;">)</span> &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">'name'</span><span style="color: #339933;">,</span><span style="color: blue;">'age'</span><span style="color: #339933;">,</span><span style="color: blue;">'gender'</span><span style="color: #009900;">)</span><br />traits<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> &lt;- <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399;">sapply</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/strsplit"><span style="color: #003399;">strsplit</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399;">as.character</span></a><span style="color: #009900;">(</span>traits<span style="color: #009900;">[</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: blue;">' '</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><span style="color: blue;">'['</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br />relation &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">'http://igraph.sourceforge.net/igraphbook/relations.csv'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/head"><span style="color: #003399;">head</span></a>=<span style="color: black;">FALSE</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399;">names</span></a><span style="color: #009900;">(</span>relation<span style="color: #009900;">)</span> &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">'from'</span><span style="color: #339933;">,</span><span style="color: blue;">'to'</span><span style="color: #339933;">,</span><span style="color: blue;">'sameroom'</span><span style="color: #339933;">,</span><span style="color: blue;">'friendship'</span><span style="color: #339933;">,</span><span style="color: blue;">'advice'</span><span style="color: #009900;">)</span><br />g4 &lt;- graph.data.frame<span style="color: #009900;">(</span>relation<span style="color: #339933;">,</span>vertices=traits<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399;">plot</span></a><span style="color: #009900;">(</span>g4<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399;">layout</span></a>=layout.kamada.kawai<span style="color: #339933;">,</span>vertex.shape=<span style="color: blue;">'rectangle'</span><span style="color: #339933;">,</span>vertex.label=V<span style="color: #009900;">(</span>g4<span style="color: #009900;">)</span>$name<span style="color: #339933;">,</span>vertex.size=<span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>asp=F<span style="color: #009900;">)</span></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-XSOE2zV-J60/T91Vat1pnoI/AAAAAAAAA-M/lF6l-HuNCNo/s1600/Rplot04.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-XSOE2zV-J60/T91Vat1pnoI/AAAAAAAAA-M/lF6l-HuNCNo/s400/Rplot04.jpeg" width="400" /></a></div><pre class="r geshifilter-R"><span style="font-family: 'Courier New', Courier, monospace;"><span style="color: #666666; font-style: italic;"># 可以通过summary函数观察内部结构，看到了10个顶点，34条边</span><br /><a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399;">summary</span></a><span style="color: #009900;">(</span>g4<span style="color: #009900;">)</span></span></pre></div></div><br />Vertices: 10<br />Edges: 34<br />Directed: TRUE<br />No graph attributes.<br />Vertex attributes: name, age, gender.<br />Edge attributes: sameroom, friendship, advice.<br /><br /><br /><div>进一步我们用igraph包探索红楼梦中的一些主要人物之间社交关系，本文对关系的定义比较粗浅，即如果有两个人的名字出现在同一段落中，可以认为之间存在联系。红楼梦中共有3192个段落，我们分成两个部分来考虑，一部分是前八十回，另一部分是后四十回。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-X_YbWgPwQ7U/T91WkuF5eGI/AAAAAAAAA-U/9RPggZMk3a8/s1600/Rplot1.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-X_YbWgPwQ7U/T91WkuF5eGI/AAAAAAAAA-U/9RPggZMk3a8/s640/Rplot1.jpeg" width="640" /></a></div>上图中姓名的大小表示了网络中人物的degree，也就是与其它人联系的多寡，线条的颜色深浅表示了联系的权重。可以看到几个主要人物之间关系非常紧密，相对弱点的是妙玉和巧姐，而且这两人之间也没什么联系。再来看后四十回的图。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-2M253MNEr-k/T91XvpOfgjI/AAAAAAAAA-c/Zrou_cgFkE4/s1600/Rplot02.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-2M253MNEr-k/T91XvpOfgjI/AAAAAAAAA-c/Zrou_cgFkE4/s640/Rplot02.jpeg" width="640" /></a></div>后四十回的故事和人物都发生了重大转折，比较显著的是元春的联系越发的微弱，因为她的死去使得与各人物的联系大减，而且妙玉被劫，她和湘云之间也不再有联系。本例没有考虑其它的人物关系因素，也没有考虑人物的别名，权作娱乐之用。因为这段代码写得比较ugly，就不好意思拿出来献丑了。<br /><br /><br /><b>igraph参考资料：</b><br /><br />官方教学站<a href="http://igraph.sourceforge.net/igraphbook/">http://igraph.sourceforge.net/igraphbook/</a><br />官方wiki <a href="http://igraph.wikidot.com/">http://igraph.wikidot.com/</a><br /><a href="http://www.stanford.edu/~messing/RforSNA.html">http://www.stanford.edu/~messing/RforSNA.html</a><br /><br /><a href="http://rdatamining.wordpress.com/2012/05/17/an-example-of-social-network-analysis-with-r-using-package-igraph/">http://rdatamining.wordpress.com/2012/05/17/an-example-of-social-network-analysis-with-r-using-package-igraph/</a><br /><a href="http://librestats.com/2012/05/17/visualizing-the-cran-graphing-package-dependencies/">http://librestats.com/2012/05/17/visualizing-the-cran-graphing-package-dependencies/</a><br /><a href="http://www.surefoss.org/visualisation/when-venn-diagrams-are-not-enough-visualizing-overlapping-data-with-social-network-analysis-in-r/">http://www.surefoss.org/visualisation/when-venn-diagrams-are-not-enough-visualizing-overlapping-data-with-social-network-analysis-in-r/</a><br /><a href="http://www.r-chart.com/2012/05/github-follower-graph-with-r.html">http://www.r-chart.com/2012/05/github-follower-graph-with-r.html</a><br /><a href="http://www.statistik.uni-dortmund.de/useR-2008/slides/Csardi.pdf">http://www.statistik.uni-dortmund.de/useR-2008/slides/Csardi.pdf</a><br /><br /><b>推荐图书：</b><br /><a href="http://www.faculty.ucr.edu/~hanneman/nettext/" target="_blank">introduction to social network methods</a><br /><a href="https://www.box.com/s/4af87a015fdea267b9fd" target="_blank">社会网络分析法</a><br /><a href="https://www.box.com/s/860baacea1868f391f54" target="_blank">社交网络数据挖掘</a><br /></div>
